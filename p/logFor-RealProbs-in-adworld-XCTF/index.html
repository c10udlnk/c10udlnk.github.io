<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="历年真题刷题小记"><meta name="keywords" content="CTF,Reverse,wp"><meta name="author" content="c10udlnk"><meta name="copyright" content="c10udlnk"><title>历年真题刷题小记 | c10udlnk' Blog</title><link rel="shortcut icon" href="/icon.jpg"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到你搜索的这个呀>^<（FOR ${query}）"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.2.0'
} </script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="c10udlnk' Blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经阅读 -&gt;</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2019-CTF-fanoGo"><span class="toc-number">1.</span> <span class="toc-text">[2019 *CTF] fanoGo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wp"><span class="toc-number">1.2.</span> <span class="toc-text">wp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag"><span class="toc-number">1.3.</span> <span class="toc-text">flag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2019-RCTF-babyre1"><span class="toc-number">2.</span> <span class="toc-text">[2019 RCTF] babyre1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">2.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wp-1"><span class="toc-number">2.2.</span> <span class="toc-text">wp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-1"><span class="toc-number">2.3.</span> <span class="toc-text">flag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2019-RCTF-babyre2"><span class="toc-number">3.</span> <span class="toc-text">[2019 RCTF] babyre2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">3.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wp-2"><span class="toc-number">3.2.</span> <span class="toc-text">wp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-2"><span class="toc-number">3.3.</span> <span class="toc-text">flag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2020-GACTF-EasyRe"><span class="toc-number">4.</span> <span class="toc-text">[2020 GACTF] EasyRe</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">4.1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wp-3"><span class="toc-number">4.2.</span> <span class="toc-text">wp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-3"><span class="toc-number">4.3.</span> <span class="toc-text">flag</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/c10udlnk_loong.jpg"></div><div class="author-info__name text-center">c10udlnk</div><div class="author-info__description text-center">A RE CTFer, a s0Ity f1sh... &lt;。)#)))≦</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/c10udlnk">do not Follow Me</a></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/ToverPomelo">just Follow my \Tover/</a></div><hr><div class="author-info-articles"><a class="author-info-articles__linkbf article-meta" target="_blank" rel="noopener" href="https://tover.xyz"><span class="pull-left">\Tover/ \Tover/ \Tover/</span><span class="pull-right">jmp → </span></a><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">41</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">12</span></a><a class="author-info-articles__links article-meta" href="/links"><span class="pull-left">友链</span><span class="pull-right">∞</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/lijiang-tower.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">c10udlnk' Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/archives">po5ts</a><a class="site-page" href="/tags">t4gs</a><a class="site-page" href="/categories">categ0ries</a><a class="site-page" href="/slides">slid3s</a><a class="site-page" href="/links">l1nks</a><a class="site-page" href="/p/blogsFor-AboutMe-Pinned">Who Am I</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">历年真题刷题小记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-12-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%88%B7%E9%A2%98log/">刷题log</a><div class="post-meta-wordcount"><span>Words cnt: </span><span class="word-count">6.2k</span><span class="post-meta__separator">|</span><span>Need time: 30 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>是收录在攻防世界真题区的刷题记录，在网上找到的wp大多是各战队比赛时的简单思路，没有很具体的做法，所以想着写个刷题小记当伪wp，顺便也想趁机给自己总结和记录一下。</p>
<a id="more"></a>

<p>题目指路：<a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/competition">https://adworld.xctf.org.cn/competition</a></p>
<p>刷题范围：2019年以来的比赛中&gt;&#x3D;20解的逆向题，循序渐进吧。</p>
<p>P.S. 起步tcl，会有参考其他wp的思路，什么时候没有参考wp了就说明我终于能单刷了（yep！</p>
<h1 id="2019-CTF-fanoGo"><a href="#2019-CTF-fanoGo" class="headerlink" title="[2019 *CTF] fanoGo"></a>[2019 *CTF] fanoGo</h1><blockquote>
<ul>
<li>2019 *CTF &#x2F; Reverse &#x2F; 28 solved</li>
<li>Completed：2020.12.08</li>
<li>参考wp：<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/sixstars/starctf2019/tree/master/re-fanoGo">starctf2019&#x2F;re-fanoGo at master · sixstars&#x2F;starctf2019</a></li>
<li><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/177490">*CTF 2019国际赛安胜ISEC WriteUp - 安全客，安全资讯平台</a></li>
<li><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5006">ROIS *CTF2019 Writeup - 先知社区</a></li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>Do you kown go &amp; fano encode?</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nc 34.92.37.22 10001</span></span><br></pre></td></tr></table></figure>

<h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><blockquote>
<p>相关工具&#x2F;插件：<a target="_blank" rel="noopener" href="https://github.com/sibears/IDAGolangHelper">[IDA] IDAGolangHelper</a></p>
</blockquote>
<p>用了插件以后，主函数一般是main_main，所以找到主函数。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209095047799.png"></p>
<p>然后看到一行<code>fano___Fano__Decode()</code></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209095144599.png"></p>
<p>于是猜测是让我们输入数据，经过fanoDecode解码后等于该字符串（就是说输入数据&#x3D;该字符串的fano编码）。</p>
<p>（我摊牌，Go实在看不懂，这里参考wp的思路了。不过如果实在做不出来我可能也会这么猜（？</p>
<p>然后在函数栏搜索能看到，打包的时候把fanoEncode函数也装进来了，所以想到patch call直接复用。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209095753661.png"></p>
<p>然后patch。</p>
<blockquote>
<p> 这里整理一下x86的call机器码格式（x64向下兼容：</p>
<ul>
<li><p>E8 xxxxxxxx</p>
<p>xxxxxxxx是偏移地址</p>
<p>偏移地址&#x3D;目标地址-当前地址-5（取完当前指令之后，pc先自增，程序再跳转；E8 xxxxxxxx有5字节</p>
</li>
<li><p>FF 15 [xxxxxxxx]</p>
<p>xxxxxxxx是绝对地址，FF15会对当前的这个绝对地址解*号，也就是绝对地址[目标地址]</p>
</li>
</ul>
</blockquote>
<p>原来的：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209101939711.png"></p>
<p>先找到fanoEncode的地址：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209102205135.png"></p>
<p>可以看到fanoEncode的地址为0x45C970。</p>
<p>然后计算偏移地址：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209102347927.png"></p>
<p>patch（别忘了小端序）：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209102138760.png"></p>
<p>patch完以后愉快地开始动态调试，配置完Debugger以后，为了看加密结果在fanoEncode函数的这里下断点。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209102735769.png"></p>
<p>然后动态调试</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209104605432.png"></p>
<p>断点处打开Locals窗口（Debugger-&gt;Debugger windows-&gt;Locals）查看编码结果：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209105058643.png"></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209105119105.png"></p>
<p>v3这里是结果的地址，我们复制下来并在IDA view里按G跳转</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209105154151.png"></p>
<p>把这个数组dump下来就是要输入的数据。</p>
<p>最后的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># ------ Python2 ------</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">r=process(<span class="string">&quot;./fanoGo_ori&quot;</span>)</span><br><span class="line"></span><br><span class="line">arr=[<span class="number">0x2B</span>, <span class="number">0x60</span>, <span class="number">0xC3</span>, <span class="number">0xBE</span>, <span class="number">0xC2</span>, <span class="number">0xB7</span>, <span class="number">0xC2</span>, <span class="number">0x82</span>, <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0xC3</span>, <span class="number">0x95</span>, <span class="number">0x5B</span>, <span class="number">0xC2</span>, <span class="number">0x87</span>, <span class="number">0x2A</span>, <span class="number">0x69</span>, <span class="number">0x13</span>, <span class="number">0xC2</span>, <span class="number">0x96</span>, <span class="number">0x51</span>, <span class="number">0xC3</span>, <span class="number">0xBD</span>, <span class="number">0x6F</span>, <span class="number">0x32</span>, <span class="number">0x28</span>, <span class="number">0x5A</span>, <span class="number">0xC3</span>, <span class="number">0x92</span>, <span class="number">0x74</span>, <span class="number">0xC2</span>, <span class="number">0x94</span>, <span class="number">0xC2</span>, <span class="number">0x94</span>, <span class="number">0xC2</span>, <span class="number">0x95</span>, <span class="number">0xC2</span>, <span class="number">0x96</span>, <span class="number">0xC2</span>, <span class="number">0xA4</span>, <span class="number">0xC3</span>, <span class="number">0x8A</span>, <span class="number">0xC2</span>, <span class="number">0xA3</span>, <span class="number">0xC3</span>, <span class="number">0x8E</span>, <span class="number">0xC2</span>, <span class="number">0xB3</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0xC2</span>, <span class="number">0xBA</span>, <span class="number">0xC2</span>, <span class="number">0xAE</span>, <span class="number">0x46</span>, <span class="number">0x2B</span>, <span class="number">0xC2</span>, <span class="number">0xAC</span>, <span class="number">0x3C</span>, <span class="number">0xC3</span>, <span class="number">0xAB</span>, <span class="number">0x32</span>, <span class="number">0x23</span>, <span class="number">0x2A</span>, <span class="number">0xC3</span>, <span class="number">0xB0</span>, <span class="number">0xC3</span>, <span class="number">0xB3</span>, <span class="number">0xC2</span>, <span class="number">0xAC</span>, <span class="number">0xC3</span>, <span class="number">0x85</span>, <span class="number">0xC2</span>, <span class="number">0x87</span>, <span class="number">0x2C</span>, <span class="number">0xC2</span>, <span class="number">0xA3</span>, <span class="number">0x6B</span>, <span class="number">0xC2</span>, <span class="number">0xAD</span>, <span class="number">0x0F</span>, <span class="number">0xC3</span>, <span class="number">0x87</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xA8</span>, <span class="number">0xC3</span>, <span class="number">0xB3</span>, <span class="number">0xC2</span>, <span class="number">0xAF</span>, <span class="number">0xC3</span>, <span class="number">0xA1</span>, <span class="number">0xC3</span>, <span class="number">0xB9</span>, <span class="number">0x12</span>, <span class="number">0xC3</span>, <span class="number">0x8A</span>, <span class="number">0x44</span>, <span class="number">0x72</span>, <span class="number">0xC2</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x91</span>, <span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x31</span>, <span class="number">0xC3</span>, <span class="number">0xA7</span>, <span class="number">0x51</span>, <span class="number">0x64</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x75</span>, <span class="number">0x6B</span>, <span class="number">0xC2</span>, <span class="number">0x96</span>, <span class="number">0xC2</span>, <span class="number">0x91</span>, <span class="number">0x51</span>, <span class="number">0xC3</span>, <span class="number">0xA7</span>, <span class="number">0x3E</span>, <span class="number">0x13</span>, <span class="number">0xC3</span>, <span class="number">0x8E</span>, <span class="number">0x57</span>, <span class="number">0x7B</span>, <span class="number">0x47</span>, <span class="number">0xC2</span>, <span class="number">0x9D</span>, <span class="number">0x45</span>, <span class="number">0x7F</span>, <span class="number">0x29</span>, <span class="number">0x11</span>, <span class="number">0xC3</span>, <span class="number">0x95</span>, <span class="number">0xC3</span>, <span class="number">0xA1</span>, <span class="number">0xC3</span>, <span class="number">0xA7</span>, <span class="number">0x59</span>, <span class="number">0xC2</span>, <span class="number">0x8A</span>, <span class="number">0x06</span>, <span class="number">0xC2</span>, <span class="number">0x8C</span>, <span class="number">0xC2</span>, <span class="number">0x91</span>, <span class="number">0xC2</span>, <span class="number">0xB5</span>, <span class="number">0x0F</span>, <span class="number">0x3A</span>, <span class="number">0xC2</span>, <span class="number">0x8E</span>, <span class="number">0xC2</span>, <span class="number">0xBA</span>, <span class="number">0xC3</span>, <span class="number">0x8B</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0xC3</span>, <span class="number">0xA8</span>, <span class="number">0xC3</span>, <span class="number">0xBC</span>, <span class="number">0xC2</span>, <span class="number">0x8E</span>, <span class="number">0x71</span>, <span class="number">0xC3</span>, <span class="number">0xBD</span>, <span class="number">0x6F</span>, <span class="number">0x32</span>, <span class="number">0x36</span>, <span class="number">0xC3</span>, <span class="number">0xB9</span>, <span class="number">0x42</span>, <span class="number">0xC3</span>, <span class="number">0xA7</span>, <span class="number">0x49</span>, <span class="number">0xC3</span>, <span class="number">0x92</span>, <span class="number">0x22</span>, <span class="number">0x79</span>, <span class="number">0xC3</span>, <span class="number">0x89</span>, <span class="number">0xC3</span>, <span class="number">0x93</span>, <span class="number">0x54</span>, <span class="number">0x79</span>, <span class="number">0xC3</span>, <span class="number">0x96</span>, <span class="number">0x63</span>, <span class="number">0x6A</span>, <span class="number">0x1F</span>, <span class="number">0xC3</span>, <span class="number">0x96</span>, <span class="number">0xC3</span>, <span class="number">0xB3</span>, <span class="number">0x23</span>, <span class="number">0x6F</span>, <span class="number">0xC2</span>, <span class="number">0x94</span>, <span class="number">0x37</span>, <span class="number">0xC2</span>, <span class="number">0x94</span>, <span class="number">0xC3</span>, <span class="number">0xA8</span>, <span class="number">0x76</span>, <span class="number">0xC3</span>, <span class="number">0x83</span>, <span class="number">0xC3</span>, <span class="number">0x8E</span>, <span class="number">0x7C</span>, <span class="number">0x3F</span>, <span class="number">0xC2</span>, <span class="number">0xAD</span>, <span class="number">0xC3</span>, <span class="number">0xA0</span>, <span class="number">0xC2</span>, <span class="number">0x9F</span>, <span class="number">0x0C</span>, <span class="number">0xC2</span>, <span class="number">0xAA</span>, <span class="number">0x7B</span>, <span class="number">0xC3</span>, <span class="number">0x83</span>, <span class="number">0x26</span>, <span class="number">0xC2</span>, <span class="number">0xAD</span>, <span class="number">0xC3</span>, <span class="number">0xB0</span>, <span class="number">0x7E</span>, <span class="number">0x3A</span>, <span class="number">0xC3</span>, <span class="number">0xA5</span>, <span class="number">0x47</span>, <span class="number">0xC2</span>, <span class="number">0x9D</span>, <span class="number">0x7F</span>, <span class="number">0x09</span>, <span class="number">0xC3</span>, <span class="number">0xA5</span>, <span class="number">0x49</span>, <span class="number">0x44</span>, <span class="number">0xC2</span>, <span class="number">0xB0</span>, <span class="number">0xC2</span>, <span class="number">0xAF</span>, <span class="number">0x0F</span>, <span class="number">0x3A</span>, <span class="number">0xC3</span>, <span class="number">0x8C</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0xC3</span>, <span class="number">0xBD</span>, <span class="number">0x6F</span>, <span class="number">0x32</span>, <span class="number">0x2C</span>, <span class="number">0xC3</span>, <span class="number">0x8C</span>, <span class="number">0x2D</span>, <span class="number">0x27</span>, <span class="number">0x49</span>, <span class="number">0xC3</span>, <span class="number">0xA3</span>, <span class="number">0x2A</span>, <span class="number">0xC3</span>, <span class="number">0xB0</span>, <span class="number">0xC3</span>, <span class="number">0xB3</span>, <span class="number">0xC2</span>, <span class="number">0xAC</span>, <span class="number">0xC3</span>, <span class="number">0x88</span>, <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0xC3</span>, <span class="number">0xB0</span>, <span class="number">0xC2</span>, <span class="number">0x9D</span>, <span class="number">0x7E</span>, <span class="number">0x1C</span>, <span class="number">0xC2</span>, <span class="number">0x9F</span>, <span class="number">0x29</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x47</span>, <span class="number">0xC3</span>, <span class="number">0xB5</span>, <span class="number">0xC2</span>, <span class="number">0xBC</span>, <span class="number">0xC3</span>, <span class="number">0x88</span>, <span class="number">0xC2</span>, <span class="number">0x9A</span>, <span class="number">0x38</span>, <span class="number">0xC3</span>, <span class="number">0xB0</span>, <span class="number">0xC3</span>, <span class="number">0xA2</span>, <span class="number">0xC2</span>, <span class="number">0xB8</span>, <span class="number">0xC3</span>, <span class="number">0xA9</span>, <span class="number">0x15</span>, <span class="number">0xC3</span>, <span class="number">0x92</span>, <span class="number">0x50</span>, <span class="number">0x40</span>]</span><br><span class="line">payload=<span class="built_in">bytearray</span>(arr[:<span class="number">0x136</span>]) <span class="comment">#看fano_Str2Bytes可以发现结果的长度为0x136</span></span><br><span class="line">r.sendafter(<span class="string">&#x27;:&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><p>因为要nc没拿到flag（</p>
<p>本地打通就好</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20201209105707639.png"></p>
<hr>
<h1 id="2019-RCTF-babyre1"><a href="#2019-RCTF-babyre1" class="headerlink" title="[2019 RCTF] babyre1"></a>[2019 RCTF] babyre1</h1><blockquote>
<ul>
<li>2019 RCTF &#x2F; Reverse &#x2F; 40 solved</li>
<li>Completed：2021.03.24</li>
<li>参考wp：<ul>
<li><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-253844.htm">[原创]微型加密算法实现及逆向分析-密码应用-看雪论坛</a>（查XXTEA的时候看到的</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h2><p>It’s just a baby…</p>
<p>There are multiple answers, please ensure MD5(rctf{your answer}) &#x3D;&#x3D; 5f8243a662cf71bf31d2b2602638dc1d</p>
<p>wrap your answer in rctf{}</p>
<h2 id="wp-1"><a href="#wp-1" class="headerlink" title="wp"></a>wp</h2><p>主函数这里逻辑比较明显，flag长度限定到16，puts(v6)很容易可以猜测是题目里说的输出<code>Bingo!</code>。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210324155416714.png"></p>
<p><code>sub_C00()</code>函数点进去能看到：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210324155639166.png"></p>
<p>而<code>sub_BE0()</code>实际上是取数组对应值，取ASCII码为48（<code>ord(&#39;0&#39;)</code>）到48+55-1&#x3D;102（<code>ord(&#39;f&#39;)</code>）在byte_1620数组里对应的值，稍加分析就可以知道<code>sub_C00()</code>是unhexlify的作用。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210324155752866.png"></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210324155805172.png"></p>
<p>然后为了方便后续分析，根据函数内容和参数给变量重命名。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210326104321181.png"></p>
<p>接着往下走到<code>sub_1180()</code>，主要逻辑在<code>sub_CE0()</code>这里：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210326103659136.png"></p>
<p>而<code>sub_CE0()</code>的整个大逻辑大概是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( a2 &gt; <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* ...... */</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br><span class="line">result = <span class="number">1L</span>L;</span><br><span class="line"><span class="keyword">if</span> ( a2 &lt; <span class="number">-1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* ...... */</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>也就是说通过调用<code>sub_CE0()</code>时的第二个参数a2来确定函数走哪一部分的流程。</p>
<p>而这个a2是可以算出来的，即<code>sub_1180()</code>的<code>-(v10 &gt;&gt; 2)</code>：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210326110256398.png"></p>
<p>也就是说<code>v10=a2=8</code>（这里a2是<strong>上一层函数传进来的</strong>hexLen，输入被限制在16字符，故hexLen一定为8），所以<strong>传进去的</strong><code>a2=-(v10&gt;&gt;2)=-(8&gt;&gt;2)=-2</code>，直接走下面那层<code>a2 &lt; -1</code>的逻辑。</p>
<p>其实这个<code>sub_CE0()</code>函数长得不就像XXTEA的加密&#x2F;解密函数吗（长得这么别致的真的不多见&#x3D; &#x3D;。</p>
<blockquote>
<p>关于TEA系列加解密：<a target="_blank" rel="noopener" href="https://blog.csdn.net/gsls200808/article/details/48243019">TEA、XTEA、XXTEA加密解密算法_gsls200808的专栏-CSDN博客</a></p>
</blockquote>
<p>在上面链接摘取一下XXTEA的实现代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]= &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> n= <span class="number">2</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;加密前原始数据：%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;加密后的数据：%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显地，Decoding Part跟<code>sub_CE0()</code>的<code>a2&lt;-1</code>部分基本是一模一样的，也就是我们要走的这个流程。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( a2 &lt; <span class="number">-1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v24 = -a2;</span><br><span class="line">  v25 = <span class="number">0x9E3779B9</span> * (<span class="number">52</span> / v24 + <span class="number">6</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v25 )</span><br><span class="line">  &#123;</span><br><span class="line">    v26 = &amp;a1[v24 - <span class="number">1</span>];</span><br><span class="line">    v27 = ~v4;</span><br><span class="line">    v44 = &amp;a1[~v4];</span><br><span class="line">    v28 = -v4 - <span class="number">3</span> - ((-v4 - <span class="number">4</span>) &amp; <span class="number">0xFFFFFFFE</span>);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v29 = v25 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v27 &lt;= <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v31 = v27;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v30 = v44;</span><br><span class="line">        v31 = v27;</span><br><span class="line">        v32 = *v44;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v33 = *(v30 - <span class="number">1</span>);</span><br><span class="line">          v30 -= <span class="number">2</span>;</span><br><span class="line">          v34 = v32;</span><br><span class="line">          v32 = *v30;</span><br><span class="line">          v35 = ((v5 ^ v25) + (v33 ^ *(_DWORD *)(a3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v31 ^ (<span class="keyword">unsigned</span> __int8)v29) &amp; <span class="number">3</span>)))) ^ (((<span class="number">4</span> * v5) ^ (v33 &gt;&gt; <span class="number">5</span>)) + ((v5 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v33)));</span><br><span class="line">          v36 = v31 - <span class="number">1</span>;</span><br><span class="line">          v31 -= <span class="number">2</span>;</span><br><span class="line">          v37 = v34 - v35;</span><br><span class="line">          v38 = *v30;</span><br><span class="line">          v30[<span class="number">2</span>] = v37;</span><br><span class="line">          v5 = v33</span><br><span class="line">             - ((((<span class="number">16</span> * v38) ^ (v37 &gt;&gt; <span class="number">3</span>)) + ((v32 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v37))) ^ ((v32 ^ *(_DWORD *)(a3</span><br><span class="line">                                                                                           + <span class="number">4L</span>L</span><br><span class="line">                                                                                           * (((<span class="keyword">unsigned</span> __int8)v29 ^ v36) &amp; <span class="number">3</span>)))</span><br><span class="line">                                                                        + (v25 ^ v37)));</span><br><span class="line">          v30[<span class="number">1</span>] = v5;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v28 != v31 );</span><br><span class="line">      &#125;</span><br><span class="line">      v39 = &amp;a1[v31];</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v40 = *--v39;</span><br><span class="line">        v5 = v39[<span class="number">1</span>]</span><br><span class="line">           - (((v5 ^ v25) + (v40 ^ *(_DWORD *)(a3 + <span class="number">4L</span>L * (((<span class="keyword">unsigned</span> __int8)v29 ^ (<span class="keyword">unsigned</span> __int8)v31) &amp; <span class="number">3</span>)))) ^ (((v5 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v40)) + ((v40 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v5))));</span><br><span class="line">        v39[<span class="number">1</span>] = v5;</span><br><span class="line">        --v31;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v31 );</span><br><span class="line">      v41 = *a1</span><br><span class="line">          - (((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*v26 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v5)) + ((<span class="number">16</span> * *v26) ^ (v5 &gt;&gt; <span class="number">3</span>))) ^ ((*(_DWORD *)(a3 + <span class="number">4L</span>L * (v29 &amp; <span class="number">3</span>)) ^ *v26)</span><br><span class="line">                                                                                   + (v25 ^ v5)));</span><br><span class="line">      v42 = v25 == <span class="number">0x9E3779B9</span>;</span><br><span class="line">      v25 += <span class="number">0x61C88647</span>;</span><br><span class="line">      v5 = v41;</span><br><span class="line">      *a1 = v41;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( !v42 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以可以确定这是个XXTEA的解密过程。</p>
<p>接着回到<code>sub_1180()</code>，可以看到XXTEA decrypt后还有一些操作：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210407155638353.png"></p>
<p>最后一个byte的值即v11要&lt;&#x3D;0x04才能进入到这个关键return，并且把让v8[a5]&#x3D;0x00截断，此时a5&#x3D;8-v11。</p>
<p>同时这里出现的这个关键变量<code>a5</code>，就是传进来的第五个参数即主函数的<code>v9</code>，这个变量控制着主函数下面的输出：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210407161610960.png"></p>
<p>前面题目也说了，<code>&quot;Input right flag you can got &#39;Bingo!&#39; :&quot;</code>，所以这里就是输出<code>Bingo!</code>的地方，长度不对等，有两种可能：</p>
<ul>
<li>v9&#x3D;6，按字节xor 0x17并输出前6字节。</li>
<li>v9&gt;&#x3D;7，第七字节xor 0x17后&#x3D;0x00，即第七字节&#x3D;0x17，把字符串在puts的时候截断。</li>
</ul>
<p>无论如何，前六字节都已经确定了，分别是<code>Bingo!</code>每字节xor 0x17的值。</p>
<p>加密（解密）方法确定，接下来，我们只需要确定各参数里放的数据就行了。</p>
<p>从调用<code>sub_CE0()</code>处可以依次确定主函数里的<code>unk_202010</code>是XXTEA的key，<code>v5</code>存着解密后的字符串，<code>v9</code>是解密后字符串的长度。</p>
<p>于是原关键部分标记成：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210407155703617.png"></p>
<p>在<code>sub_13D0()</code>中，我们可以发现一个用得很频繁的常数——<code>0x1021</code>：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210407143659106.png"></p>
<p>通过常数和8轮的xor可以猜测是CRC的其中一种（计网刚学完hhh），在搜索引擎查一下<code>0x1021</code>这个常数也能知道是一种CRC-16：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210407143836970.png"></p>
<p>看了一下算法对比感觉是<code>CRC-16/X25</code>（见<a target="_blank" rel="noopener" href="https://blog.csdn.net/leumber/article/details/54311811">CRC16常见几个标准的算法及C语言实现_leumber的专栏-CSDN博客</a>），然而是什么其实都不重要，反正校验算法就意味着不能通过逆向计算来通过27106反推出字符串。</p>
<p>那么，汇总一下：现在相当于我们拿到了<strong>这个字符串</strong>前六字节（xor 0x17以后等于<code>Bingo!</code>），并且<strong>这个字符串</strong>通过<code>CRC-16/X25</code>计算后出27106，由题目描述知道<code>MD5(rctf&#123;your answer&#125;) == 5f8243a662cf71bf31d2b2602638dc1d</code>。而<strong>这个字符串</strong>是由一个<strong>十六字节的输入</strong>经过unhexlify以后再经过XXTEA的解密后得到的。</p>
<p>既然有校验存在（md5和crc），那我们就愉快地爆破吧。</p>
<p>理论上说应该是只用crc爆破的，但crc容易有多解，所以题目描述又多加了一层md5防止多解。</p>
<p>所以其实只用md5来爆破就好。</p>
<p>先用<code>[hex(ord(x)^0x17) for x in &#39;Bingo!&#39;]</code>算一下前六字节：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210421102212307.png"></p>
<p>按小端组合，可以得到这两个解密出来的数字分别是<code>0x70797e55</code>和<code>0xZZZZ3678</code>（高两字节未知）。</p>
<p>于是写得爆破的exp：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MD5.c来自https://github.com/pod32g/MD5</span></span><br><span class="line"><span class="comment">// 下载文件后删掉main函数的定义，和本exp放在同目录下即可食用</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;MD5.c&quot;</span></span></span><br><span class="line"><span class="comment">// 以下是XXTEA加解密部分，来自https://blog.csdn.net/gsls200808/article/details/48243019</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 爆破部分</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]=&#123;<span class="number">0xE0C7E0C7</span>, <span class="number">0xC6F1D3D7</span>, <span class="number">0xC6D3C6D3</span>, <span class="number">0xC4D0D2CE</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> hex[<span class="number">16</span>]=&#123;<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>&#125;;</span><br><span class="line">    <span class="comment">//这里unhex不能确定是大写十六进制还是小写十六进制，都爆破一遍就好</span></span><br><span class="line">    <span class="keyword">int</span> n= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">4</span>;i++)&#123; <span class="comment">//v11&lt;=4</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">0x100</span>;j++)&#123; <span class="comment">//爆破第二字节</span></span><br><span class="line">            <span class="keyword">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">0x70797e55</span>, <span class="number">0x00003678</span>|((i&lt;&lt;<span class="number">24</span>)+(j&lt;&lt;<span class="number">16</span>))&#125;;</span><br><span class="line">            btea(v, n, k);</span><br><span class="line">            <span class="keyword">char</span> flag[<span class="number">23</span>]=<span class="string">&quot;rctf&#123;&quot;</span>;</span><br><span class="line">            <span class="keyword">int</span> pos=<span class="number">5</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">0</span>;a&lt;<span class="number">2</span>;a++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> b=<span class="number">0</span>;b&lt;<span class="number">4</span>;b++)&#123;</span><br><span class="line">                    flag[pos]=hex[*((<span class="keyword">uint8_t</span>*)v+a*<span class="number">4</span>+b)&gt;&gt;<span class="number">4</span>];</span><br><span class="line">                    flag[pos+<span class="number">1</span>]=hex[*((<span class="keyword">uint8_t</span>*)v+a*<span class="number">4</span>+b)&amp;<span class="number">0x0f</span>];</span><br><span class="line">                    pos+=<span class="number">2</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            flag[pos]=<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">            flag[pos+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">uint8_t</span> res[<span class="number">16</span>];</span><br><span class="line">            md5((<span class="keyword">uint8_t</span>*)flag,<span class="built_in">strlen</span>(flag),res);</span><br><span class="line">            <span class="keyword">char</span> flag_md5[<span class="number">33</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> x=<span class="number">0</span>;x&lt;<span class="number">16</span>;x++) <span class="built_in">sprintf</span>(flag_md5+<span class="number">2</span>*x,<span class="string">&quot;%02x&quot;</span>,res[x]);</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(flag_md5,<span class="string">&quot;5f8243a662cf71bf31d2b2602638dc1d&quot;</span>)) <span class="built_in">printf</span>(<span class="string">&quot;[*]flag: %s\n&quot;</span>,flag);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>爆破就能得到flag啦~</p>
<h2 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h2><p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210421112745190.png"></p>
<p><strong>rctf{05e8a376e4e0446e}</strong></p>
<hr>
<h1 id="2019-RCTF-babyre2"><a href="#2019-RCTF-babyre2" class="headerlink" title="[2019 RCTF] babyre2"></a>[2019 RCTF] babyre2</h1><blockquote>
<ul>
<li>2019 RCTF &#x2F; Reverse &#x2F; 28 solved</li>
<li>Completed：</li>
<li>参考wp：<ul>
<li>有？</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h2><p>yet another baby reverse for u…</p>
<p>nc 139.180.215.222 20000</p>
<p>nc 123.206.174.203 20000</p>
<h2 id="wp-2"><a href="#wp-2" class="headerlink" title="wp"></a>wp</h2><p>是一个变量巨多函数也居多的题。</p>
<p>分析过程不再赘述，要么比较简单要么跟前面挺像的，直接贴出最后改了名的分析结果好了：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210423161024319.png"></p>
<p>其中有一个需要忽略的函数<code>sub_564B320C6B90()</code>，这个函数主要是用于输入输出用的，相当于一个VM的I&#x2F;O机，可以不用管。</p>
<p>整个程序的流程是依次让我们输入<code>account</code>、<code>password</code>、<code>data</code>三个数据，如果经历了一系列加密以后通过了<code>check</code>，则输出flag。</p>
<h2 id="flag-2"><a href="#flag-2" class="headerlink" title="flag"></a>flag</h2><hr>
<h1 id="2020-GACTF-EasyRe"><a href="#2020-GACTF-EasyRe" class="headerlink" title="[2020 GACTF] EasyRe"></a>[2020 GACTF] EasyRe</h1><blockquote>
<ul>
<li>2020 GACTF &#x2F; Reverse &#x2F; 38 solved</li>
<li>Completed：2021.01.02</li>
<li>参考wp：<ul>
<li>无（ohhhh！</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h2><p>Layers of protection～</p>
<p>Overseas：<a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1TobAUm_innt7RoQ7ZI4q1CNUWKuH-Tsw/view?usp=sharing">https://drive.google.com/file/d/1TobAUm_innt7RoQ7ZI4q1CNUWKuH-Tsw/view?usp=sharing</a></p>
<h2 id="wp-3"><a href="#wp-3" class="headerlink" title="wp"></a>wp</h2><p>用ida打开发现main看起来没什么特别的，就是输入一个lld。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103164252941.png"></p>
<p>不过一个一个函数往下翻可以看到sub_8049065()这个，调用了一个mprotect函数（警觉</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103164436661.png"></p>
<p>mprotect的作用一般是改某段内存的读&#x2F;写&#x2F;执行权限，并且下面sub_8048EA5()还用了一个函数（就是主函数中即将调用的函数）作为参数，这就要立刻想到smc了，sub_8048EA5()就是加密函数。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103164654874.png"></p>
<p>这边一看就感觉很复杂的样子，那就懒得逆了，直接动态调试看看过完加密以后sub_8048838()是什么样子。在这个函数下个断点，执行到的时候直接步入。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103165118166.png"></p>
<p>可以看到这边比较散乱，因为数据全部被处理过了，要看到反汇编和反编译代码就要首先把它们undefined，然后重新分析。</p>
<p>这个函数的起始地址是0x8048838，结束地址是0x8048DE1，算一下长度是0x8048DE1-0x8048838+1&#x3D;1450。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103165327087.png"></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103165437843.png"></p>
<p>然后用ida_bytes的del_items函数（7.4的api开始不再兼容6.x的api了，在7.4以前还能用idc.MakeUnkn，见<a target="_blank" rel="noopener" href="https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml">Porting from IDAPython 6.x-7.3, to 7.4</a>）或者选这个区域直接右键-&gt;Undefined把这部分undefined掉，再在0x8048838出按<code>p</code>创建函数。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103170654811.png"></p>
<p>可以看到这其实是个vm题，smc+vm真不愧是Layers of protection呢hhh。vm代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> __cdecl <span class="title">sub_8048838</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *v2; <span class="comment">// [esp+18h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">113</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">6</span>] -= <span class="number">4</span>;</span><br><span class="line">      *(_DWORD *)a1[<span class="number">6</span>] = *(_DWORD *)(a1[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">65</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] += a1[<span class="number">2</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">66</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] -= a1[<span class="number">4</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">67</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] *= a1[<span class="number">3</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">68</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] /= a1[<span class="number">5</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0x80</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[sub_80487EF(a1, <span class="number">1</span>)] = *(_DWORD *)(a1[<span class="number">8</span>] + <span class="number">2</span>);</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">119</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">83</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(*(<span class="keyword">char</span> *)a1[<span class="number">3</span>]);</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">34</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] &lt;&lt;= a1[<span class="number">2</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0x99</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">118</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">3</span>] = *(_DWORD *)a1[<span class="number">6</span>];</span><br><span class="line">      *(_DWORD *)a1[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">      a1[<span class="number">6</span>] += <span class="number">4</span>;</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">84</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = (_BYTE *)a1[<span class="number">3</span>];</span><br><span class="line">      *v2 = getchar();</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">48</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] |= a1[<span class="number">2</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">49</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] = dword_804B28C;</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">9</span>] = a1[<span class="number">1</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">17</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, (<span class="keyword">const</span> <span class="keyword">void</span> *)a1[<span class="number">1</span>]);</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xA0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">653840640</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xA1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;flag:&quot;</span>);</span><br><span class="line">      read(<span class="number">0</span>, byte_804B2E0, <span class="number">0x28</span>u);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(byte_804B2E0) != <span class="number">33</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xB1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>];</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xB2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">9</span>] = dword_804B2A4;</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xA4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      dword_804B2A0[*(<span class="keyword">unsigned</span> __int8 *)(a1[<span class="number">8</span>] + <span class="number">1</span>)] = a1[<span class="number">1</span>];</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xB3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">9</span>] = dword_804B2A8;</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xB4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">9</span>] = dword_804B2AC;</span><br><span class="line">      ++a1[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xC1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)byte_804B2E0[*(<span class="keyword">unsigned</span> __int8 *)(a1[<span class="number">8</span>] + <span class="number">1</span>)];</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)a1[<span class="number">8</span>] == <span class="number">0xC2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( a1[<span class="number">1</span>] != *(_DWORD *)(a1[<span class="number">8</span>] + <span class="number">1</span>) )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      a1[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>仔细研究可以知道，a1这个数组里，a1[1]~a1[4]和a1[9]是一组寄存器，a1[8]指向的地方实际上是opcode（a1[8]其实就是PC），dword_804B28C则是刚刚输入的数据（myInput），byte_804B2E0就是输入的flag。</p>
<p>整理可以得到以下伪代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//arr-&gt;4bytes</span></span><br><span class="line"><span class="number">0x09</span>                    <span class="comment">//r1=myInput</span></span><br><span class="line"><span class="number">0x10</span>                    <span class="comment">//r9=r1</span></span><br><span class="line"><span class="number">0x22</span>                    <span class="comment">//r1&gt;&gt;=r2</span></span><br><span class="line"><span class="number">0x23</span>                    <span class="comment">//r1&lt;&lt;=r2</span></span><br><span class="line"><span class="number">0x30</span>                    <span class="comment">//r1|=r2</span></span><br><span class="line"><span class="number">0x31</span>                    <span class="comment">//r1&amp;=r2</span></span><br><span class="line"><span class="number">0x41</span>                    <span class="comment">//r1+=r2</span></span><br><span class="line"><span class="number">0x42</span>                    <span class="comment">//r1-=r4</span></span><br><span class="line"><span class="number">0x43</span>                    <span class="comment">//r1*=r3</span></span><br><span class="line"><span class="number">0x44</span>                    <span class="comment">//r1/=r5</span></span><br><span class="line"><span class="number">0x71</span> aa bb cc dd        <span class="comment">//push ddccbbaa</span></span><br><span class="line"><span class="number">0x76</span> ?? ?? ?? ??        <span class="comment">//pop r3</span></span><br><span class="line"><span class="number">0x77</span>                    <span class="comment">//r1^=r9</span></span><br><span class="line"><span class="number">0x80</span> rx aa bb cc dd     <span class="comment">//rx=ddbbccaa</span></span><br><span class="line"><span class="number">0x99</span>                    <span class="comment">//exit</span></span><br><span class="line"><span class="number">0xA0</span>                    <span class="comment">//check1(r1==653840640)</span></span><br><span class="line"><span class="number">0xA1</span>                    <span class="comment">//check2(input flag;strlen(flag)==33)</span></span><br><span class="line"><span class="number">0xA4</span> aa bb cc           <span class="comment">//arr[ccbbaa]=r1</span></span><br><span class="line"><span class="number">0xB1</span>                    <span class="comment">//r9=arr[0]</span></span><br><span class="line"><span class="number">0xB2</span>                    <span class="comment">//r9=arr[1]</span></span><br><span class="line"><span class="number">0xB3</span>                    <span class="comment">//r9=arr[2]</span></span><br><span class="line"><span class="number">0xB4</span>                    <span class="comment">//r9=arr[3]</span></span><br><span class="line"><span class="number">0xC1</span> aa                 <span class="comment">//r1=flag[aa]</span></span><br><span class="line"><span class="number">0xC2</span> aa bb cc dd        <span class="comment">//check3(r1==ddbbccaa)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 这三个有可能是提供给我们hook用的，但是懒得想了= =总之原opcode全程没用到</span></span><br><span class="line"><span class="comment">if ( *(_BYTE *)a1[8] == 0x53 )&#123;</span></span><br><span class="line"><span class="comment">  putchar(*(char *)a1[3]);</span></span><br><span class="line"><span class="comment">  a1[8] += 2;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">if ( *(_BYTE *)a1[8] == 0x54 )&#123;</span></span><br><span class="line"><span class="comment">  v2 = (_BYTE *)a1[3];</span></span><br><span class="line"><span class="comment">  *v2 = getchar();</span></span><br><span class="line"><span class="comment">  a1[8] += 2;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">if ( *(_BYTE *)a1[8] == 0x11 )&#123;</span></span><br><span class="line"><span class="comment">  printf(&quot;%p\n&quot;, (const void *)a1[1]);</span></span><br><span class="line"><span class="comment">  ++a1[8];</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>然后去a1[8]的地方拿到opcode，反汇编。</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103173551820.png"></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103173731962.png"></p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103173806534.png"></p>
<p>把opcode即unk_804B080处的数据dump下来，convert成python样式的byte数组，写反汇编脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">opcode=[<span class="number">0x09</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x96</span>, <span class="number">0xF3</span>, <span class="number">0x78</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xD4</span>, <span class="number">0x85</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0xA0</span>, <span class="number">0x09</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x43</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0xA4</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x44</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x21</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0xA4</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x09</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0xA4</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x04</span>, <span class="number">0xA0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x42</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x77</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0xA4</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x7A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x02</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x95</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x03</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x04</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xAD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x06</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x2F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x08</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x2D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x09</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x2F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0A</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x39</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0C</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0D</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0E</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0F</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x3F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x10</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x3A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x11</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x61</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x57</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x13</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x20</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x14</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x15</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x3F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x16</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x3F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xB5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x18</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x13</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x19</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xA0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1A</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x21</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1C</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x39</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x73</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1F</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x46</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x99</span>]</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> opcode[i]==<span class="number">0x09</span>:</span><br><span class="line">        print(<span class="string">&quot;r1=myInput&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x10</span>:</span><br><span class="line">        print(<span class="string">&quot;r9=r1&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x22</span>:</span><br><span class="line">        print(<span class="string">&quot;r1&gt;&gt;=r2&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x23</span>:</span><br><span class="line">        print(<span class="string">&quot;r1&lt;&lt;=r2&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x30</span>:</span><br><span class="line">        print(<span class="string">&quot;r1|=r2&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x31</span>:</span><br><span class="line">        print(<span class="string">&quot;r1&amp;=r2&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x41</span>:</span><br><span class="line">        print(<span class="string">&quot;r1+=r2&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x42</span>:</span><br><span class="line">        print(<span class="string">&quot;r1-=r4&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x43</span>:</span><br><span class="line">        print(<span class="string">&quot;r1*=r3&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x44</span>:</span><br><span class="line">        print(<span class="string">&quot;r1/=r5&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x71</span>:</span><br><span class="line">        idata=(opcode[i+<span class="number">4</span>]&lt;&lt;<span class="number">24</span>)+(opcode[i+<span class="number">3</span>]&lt;&lt;<span class="number">16</span>)+(opcode[i+<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)+(opcode[i+<span class="number">1</span>])</span><br><span class="line">        print(<span class="string">&quot;push 0x%x&quot;</span>%idata)</span><br><span class="line">        i+=<span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x76</span>:</span><br><span class="line">        idata=(opcode[i+<span class="number">4</span>]&lt;&lt;<span class="number">24</span>)+(opcode[i+<span class="number">3</span>]&lt;&lt;<span class="number">16</span>)+(opcode[i+<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)+(opcode[i+<span class="number">1</span>])</span><br><span class="line">        print(<span class="string">&quot;pop r3 (unknown 0x%x)&quot;</span>%idata)</span><br><span class="line">        i+=<span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x77</span>:</span><br><span class="line">        print(<span class="string">&quot;r1^=r9&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x80</span>:</span><br><span class="line">        idata=(opcode[i+<span class="number">5</span>]&lt;&lt;<span class="number">24</span>)+(opcode[i+<span class="number">4</span>]&lt;&lt;<span class="number">16</span>)+(opcode[i+<span class="number">3</span>]&lt;&lt;<span class="number">8</span>)+(opcode[i+<span class="number">2</span>])</span><br><span class="line">        print(<span class="string">&quot;r%d=0x%x&quot;</span>%(opcode[i+<span class="number">1</span>],idata))</span><br><span class="line">        i+=<span class="number">6</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x99</span>:</span><br><span class="line">        print(<span class="string">&quot;exit&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xA0</span>:</span><br><span class="line">        print(<span class="string">&quot;check1(r1==653840640)&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xA1</span>:</span><br><span class="line">        print(<span class="string">&quot;check2(input flag;strlen(flag)==33)&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xA4</span>:</span><br><span class="line">        reg=(opcode[i+<span class="number">3</span>]&lt;&lt;<span class="number">16</span>)+(opcode[i+<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)+(opcode[i+<span class="number">1</span>])</span><br><span class="line">        print(<span class="string">&quot;arr[%d]=r1&quot;</span>%reg)</span><br><span class="line">        i+=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xB1</span>:</span><br><span class="line">        print(<span class="string">&quot;r9=arr[0]&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xB2</span>:</span><br><span class="line">        print(<span class="string">&quot;r9=arr[1]&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xB3</span>:</span><br><span class="line">        print(<span class="string">&quot;r9=arr[2]&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xB4</span>:</span><br><span class="line">        print(<span class="string">&quot;r9=arr[3]&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xC1</span>:</span><br><span class="line">        print(<span class="string">&quot;r1=flag[%d]&quot;</span>%opcode[i+<span class="number">1</span>])</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0xC2</span>:</span><br><span class="line">        idata=(opcode[i+<span class="number">4</span>]&lt;&lt;<span class="number">24</span>)+(opcode[i+<span class="number">3</span>]&lt;&lt;<span class="number">16</span>)+(opcode[i+<span class="number">2</span>]&lt;&lt;<span class="number">8</span>)+(opcode[i+<span class="number">1</span>])</span><br><span class="line">        print(<span class="string">&quot;check3(r1==0x%x)&quot;</span>%idata)</span><br><span class="line">        i+=<span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x53</span>:</span><br><span class="line">        print(<span class="string">&quot;[Unkn] 0x53: %x&quot;</span>%opcode[i+<span class="number">1</span>])</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x54</span>:</span><br><span class="line">        print(<span class="string">&quot;[Unkn] 0x54: %x&quot;</span>%opcode[i+<span class="number">1</span>])</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[i]==<span class="number">0x11</span>:</span><br><span class="line">        print(<span class="string">&quot;[Unkn] 0x11&quot;</span>)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;[!]unknown opcode %d&quot;</span>%opcode[i])</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">r1=myInput</span><br><span class="line">r9=r1</span><br><span class="line">r2=<span class="number">0xd</span></span><br><span class="line">r1&gt;&gt;=r2</span><br><span class="line">r1^=r9</span><br><span class="line">r9=r1</span><br><span class="line">r2=<span class="number">0x9</span></span><br><span class="line">r1&lt;&lt;=r2</span><br><span class="line">r2=<span class="number">0x78f39600</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r1^=r9</span><br><span class="line">r9=r1</span><br><span class="line">r2=<span class="number">0x11</span></span><br><span class="line">r1&lt;&lt;=r2</span><br><span class="line">r2=<span class="number">0x85d40000</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r1^=r9</span><br><span class="line">r9=r1</span><br><span class="line">r2=<span class="number">0x13</span></span><br><span class="line">r1&gt;&gt;=r2</span><br><span class="line">r1^=r9</span><br><span class="line">check1(r1==<span class="number">653840640</span>)</span><br><span class="line"><span class="comment"># 可以看到check1只调用了一次，并且这里是用来check最开始输入的数字的，因此以这里为界把分析分成了两部分，以下则是check再次输入的flag部分</span></span><br><span class="line"></span><br><span class="line">r1=myInput</span><br><span class="line">r2=<span class="number">0xff</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r3=<span class="number">0x2</span></span><br><span class="line">r1*=r3</span><br><span class="line">r2=<span class="number">0x18</span></span><br><span class="line">r1+=r2</span><br><span class="line">arr[<span class="number">0</span>]=r1</span><br><span class="line">r1=myInput</span><br><span class="line">r2=<span class="number">0x8</span></span><br><span class="line">r1&gt;&gt;=r2</span><br><span class="line">r2=<span class="number">0xff</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r5=<span class="number">0x7</span></span><br><span class="line">r1/=r5</span><br><span class="line">r2=<span class="number">0x21</span></span><br><span class="line">r1+=r2</span><br><span class="line">arr[<span class="number">1</span>]=r1</span><br><span class="line">r1=myInput</span><br><span class="line">r2=<span class="number">0x10</span></span><br><span class="line">r1&gt;&gt;=r2</span><br><span class="line">r2=<span class="number">0xff</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r9=<span class="number">0xbb</span></span><br><span class="line">r1^=r9</span><br><span class="line">r2=<span class="number">0xff</span></span><br><span class="line">r1+=r2</span><br><span class="line">arr[<span class="number">2</span>]=r1</span><br><span class="line">r1=myInput</span><br><span class="line">r2=<span class="number">0x18</span></span><br><span class="line">r1&gt;&gt;=r2</span><br><span class="line">r2=<span class="number">0xff</span></span><br><span class="line">r1&amp;=r2</span><br><span class="line">r4=<span class="number">0xa0</span></span><br><span class="line">r1-=r4</span><br><span class="line">r2=<span class="number">0x77</span></span><br><span class="line">r1+=r2</span><br><span class="line">arr[<span class="number">3</span>]=r1</span><br><span class="line">check2(<span class="built_in">input</span> flag;strlen(flag)==<span class="number">33</span>)</span><br><span class="line">r1=flag[<span class="number">0</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x10b</span>)</span><br><span class="line">r1=flag[<span class="number">1</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x7a</span>)</span><br><span class="line">r1=flag[<span class="number">2</span>]</span><br><span class="line">r9=arr[<span class="number">3</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x95</span>)</span><br><span class="line">r1=flag[<span class="number">3</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x106</span>)</span><br><span class="line">r1=flag[<span class="number">4</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x7d</span>)</span><br><span class="line">r1=flag[<span class="number">5</span>]</span><br><span class="line">r9=arr[<span class="number">3</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0xad</span>)</span><br><span class="line">r1=flag[<span class="number">6</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x12f</span>)</span><br><span class="line">r1=flag[<span class="number">7</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x165</span>)</span><br><span class="line">r1=flag[<span class="number">8</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x12d</span>)</span><br><span class="line">r1=flag[<span class="number">9</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x12f</span>)</span><br><span class="line">r1=flag[<span class="number">10</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x139</span>)</span><br><span class="line">r1=flag[<span class="number">11</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x10d</span>)</span><br><span class="line">r1=flag[<span class="number">12</span>]</span><br><span class="line">r9=arr[<span class="number">3</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0xbb</span>)</span><br><span class="line">r1=flag[<span class="number">13</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x8</span>)</span><br><span class="line">r1=flag[<span class="number">14</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x10d</span>)</span><br><span class="line">r1=flag[<span class="number">15</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x13f</span>)</span><br><span class="line">r1=flag[<span class="number">16</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x13a</span>)</span><br><span class="line">r1=flag[<span class="number">17</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x161</span>)</span><br><span class="line">r1=flag[<span class="number">18</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x57</span>)</span><br><span class="line">r1=flag[<span class="number">19</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x120</span>)</span><br><span class="line">r1=flag[<span class="number">20</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x10d</span>)</span><br><span class="line">r1=flag[<span class="number">21</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x13f</span>)</span><br><span class="line">r1=flag[<span class="number">22</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x13f</span>)</span><br><span class="line">r1=flag[<span class="number">23</span>]</span><br><span class="line">r9=arr[<span class="number">3</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0xb5</span>)</span><br><span class="line">r1=flag[<span class="number">24</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x113</span>)</span><br><span class="line">r1=flag[<span class="number">25</span>]</span><br><span class="line">r9=arr[<span class="number">3</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0xa0</span>)</span><br><span class="line">r1=flag[<span class="number">26</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x121</span>)</span><br><span class="line">r1=flag[<span class="number">27</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x10d</span>)</span><br><span class="line">r1=flag[<span class="number">28</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0xb</span>)</span><br><span class="line">r1=flag[<span class="number">29</span>]</span><br><span class="line">r9=arr[<span class="number">2</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x139</span>)</span><br><span class="line">r1=flag[<span class="number">30</span>]</span><br><span class="line">r9=arr[<span class="number">0</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x173</span>)</span><br><span class="line">r1=flag[<span class="number">31</span>]</span><br><span class="line">r9=arr[<span class="number">1</span>]</span><br><span class="line">r1^=r9</span><br><span class="line">check3(r1==<span class="number">0x46</span>)</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<p>根据上半部分的分析写出爆破脚本把这个数字爆破出来：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">0</span>;i&lt;<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">128</span>);i++)&#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> x=i;</span><br><span class="line">        <span class="keyword">if</span>(((((((((((x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x9</span>)&amp;<span class="number">0x78f39600</span>)^(x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x11</span>)&amp;<span class="number">0x85d40000</span>)^((((x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x9</span>)&amp;<span class="number">0x78f39600</span>)^(x&gt;&gt;<span class="number">0xd</span>)^x)&gt;&gt;<span class="number">0x13</span>)^((((((((x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x9</span>)&amp;<span class="number">0x78f39600</span>)^(x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x11</span>)&amp;<span class="number">0x85d40000</span>)^((((x&gt;&gt;<span class="number">0xd</span>)^x)&lt;&lt;<span class="number">0x9</span>)&amp;<span class="number">0x78f39600</span>)^(x&gt;&gt;<span class="number">0xd</span>)^x))==<span class="number">653840640</span>)&#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;i&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 其实有很多地方不必加括号的，这里为了保险就全加了</span></span><br><span class="line"><span class="comment">// output：4293442714</span></span><br></pre></td></tr></table></figure>

<p>可以爆出这个数是4293442714，输入，发现果然出现了输入flag的提示：</p>
<p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103174524998.png"></p>
<p>接下来是flag的部分，逻辑很清楚啦，就是用这个数字生成一个arr数组，然后用flag[i] xor arr中的某一个等于已知值，基操xor不用多说。</p>
<p>这里为了更快处理就直接把check2下边的部分复制到<code>code.txt</code>中了，直接进行自动化计算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x=4293442714</span></span><br><span class="line"><span class="comment"># arr=[0,0,0,0]</span></span><br><span class="line"><span class="comment"># arr[0]=(x&amp;0xff)*2+0x18</span></span><br><span class="line"><span class="comment"># arr[1]=((x&gt;&gt;0x8)&amp;0xff)//0x7+0x21</span></span><br><span class="line"><span class="comment"># arr[2]=(((x&gt;&gt;0x10)&amp;0xff)^0xbb)+0xff</span></span><br><span class="line"><span class="comment"># arr[3]=(((x&gt;&gt;0x18)&amp;0xff)-0xa0)+0x77</span></span><br><span class="line"><span class="comment"># print(arr)</span></span><br><span class="line">arr=[<span class="number">332</span>,<span class="number">59</span>,<span class="number">338</span>,<span class="number">214</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>*<span class="number">4</span>):</span><br><span class="line">        line=f.readline().replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">4</span>==<span class="number">1</span>:</span><br><span class="line">            s=line[<span class="number">3</span>:]+<span class="string">&quot;^&quot;</span></span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">4</span>==<span class="number">3</span>:</span><br><span class="line">            s+=line[<span class="number">11</span>:<span class="number">-1</span>]</span><br><span class="line">            print(<span class="built_in">chr</span>(<span class="built_in">eval</span>(s)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag就出来啦~</p>
<h2 id="flag-3"><a href="#flag-3" class="headerlink" title="flag"></a>flag</h2><p><img src="/p/logFor-RealProbs-in-adworld-XCTF/image-20210103175000167.png"></p>
<p><strong>GACTF{c7ack_m3_sh3ll_smc_vm_0k?}</strong></p>
<hr>
<p><strong>TBC…</strong></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">c10udlnk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://c10udlnk.top/p/logFor-RealProbs-in-adworld-XCTF/">https://c10udlnk.top/p/logFor-RealProbs-in-adworld-XCTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://c10udlnk.top">c10udlnk' Blog</a> (https://c10udlnk.top)！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a><a class="post-meta__tags" href="/tags/wp/">wp</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/p/reSkillsOn-Debugging/"><i class="fa fa-chevron-left">  </i><span>RE套路 - 关于使用IDA 7.0前端进行的动态调试</span></a></div><div class="next-post pull-right"><a href="/p/reSkillsOn-Pyinstaller-extracted-to-python/"><span>RE套路 - 关于pyinstaller打包文件的复原</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3fff94cdba288d81026d',
  clientSecret: 'e449b106b98b508de4e3ab3658f46444d26f420f',
  repo: 'c10udlnk.github.io',
  owner: 'c10udlnk',
  admin: 'c10udlnk',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/lijiang-tower.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2024 By c10udlnk</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text"><u><a target="_blank" rel="noopener" href="https://tover.xyz">密码学是二进制人的自我修养 =v=</a></u></div><div class="busuanzi"><script src="/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script src="/js/DigitalRain.js"></script><script src="/live2d-widget/autoload.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">想要搜什么呢~</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search...?"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></div><!-- hexo injector body_end start -->
    <div class="myspine-spine-widget"></div>
    <script src="/js/third-party/myspine/spine-widget.js"></script>
    <script src="/js/third-party/myspine/spine-skeleton-binary.js"></script>
    <script src="/js/third-party/myspine/myspine.js"></script>
    <link type="text/css" href="/css/_third-party/myspine.css"></link>
    <script>
        new MySpine({
            spineDir: "/spine_models/",
            models: [{"name":"sd_21miku_normal_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_band_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_idol_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_night_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_street_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_wonder_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"}],
            styles: {"widget":{"width":"200px","height":"200px"},"voiceText":{"color":"#e6e6e6"}},
            behaviors: {"start":{"animation":"w_emu_run01_f","voice":"","text":"Ohhhhh好耶"},"idle":{"maxMinutes":1,"animations":[{"name":"m_cool_idle01_f","loop":false},{"name":"m_cool_joy01_f","loop":false},{"name":"m_happy_idle01_f","loop":false},{"name":"m_happy_joy01_f","loop":false},{"name":"m_normal_idle01_f","loop":false},{"name":"m_normal_joy01_f","loop":false},{"name":"m_staff_idle01_f","loop":false},{"name":"n_general_wait_01_f","loop":false},{"name":"pose_default","loop":false},{"name":"u_vbsmen_battledore00_f","loop":false},{"name":"u_vbswomen_battledore00_f","loop":false},{"name":"w_adult_idle01_f","loop":false},{"name":"w_adult_joy01_f","loop":false},{"name":"w_cool_idle01_f","loop":false},{"name":"w_cool_joy01_f","loop":false},{"name":"w_cute_idle01_f","loop":false},{"name":"w_cute_joy01_f","loop":false},{"name":"w_happy_idle01_f","loop":false},{"name":"w_happy_joy01_f","loop":false},{"name":"w_normal_idle01_f","loop":false},{"name":"w_normal_joy01_f","loop":false},{"name":"w_pure_idle01_f","loop":false},{"name":"w_pure_joy01_f","loop":false},{"name":"w_staff_idle01_f","loop":false}],"voices":[{"voice":"","text":"不买立省百分百"}]},"interact":{"maxPlaySec":3,"animations":[{"name":"w_normal_joy01_b","loop":false},{"name":"m_cool_angry01_f","loop":false},{"name":"m_cool_doubt01_f","loop":false},{"name":"m_cool_laugh01_f","loop":false},{"name":"m_cool_listen01_f","loop":false},{"name":"m_cool_sad01_f","loop":false},{"name":"m_cool_surprise01_f","loop":false},{"name":"m_cool_talk01_f","loop":false},{"name":"m_happy_angry01_f","loop":false},{"name":"m_happy_doubt01_f","loop":false},{"name":"m_happy_laugh01_f","loop":false},{"name":"m_happy_listen01_f","loop":false},{"name":"m_happy_sad01_f","loop":false},{"name":"m_happy_surprise01_f","loop":false},{"name":"m_happy_talk01_f","loop":false},{"name":"m_normal_angry01_f","loop":false},{"name":"m_normal_doubt01_f","loop":false},{"name":"m_normal_laugh01_f","loop":false},{"name":"m_normal_listen01_f","loop":false},{"name":"m_normal_surprise01_f","loop":false},{"name":"m_normal_talk01_f","loop":false},{"name":"m_normal_walk01_b","loop":false},{"name":"m_normal_walk01_f","loop":false},{"name":"m_tsukasa_run01_f","loop":false},{"name":"n_general_walk_01_b","loop":false},{"name":"n_general_walk_01_f","loop":false},{"name":"u_liondancerobot_run_01_f","loop":false},{"name":"u_liondancerobot_run_02_f","loop":false},{"name":"u_vbsmen_battledore01_f","loop":false},{"name":"u_vbsmen_battledore02_f","loop":false},{"name":"u_vbsmen_battledore03_f","loop":false},{"name":"u_vbsmen_battledore04_f","loop":false},{"name":"u_vbswomen_battledore01_f","loop":false},{"name":"u_vbswomen_battledore02_f","loop":false},{"name":"u_vbswomen_battledore03_f","loop":false},{"name":"u_vbswomen_battledore04_f","loop":false},{"name":"w_adult_angry01_f","loop":false},{"name":"w_adult_doubt01_f","loop":false},{"name":"w_adult_laugh01_f","loop":false},{"name":"w_adult_listen01_f","loop":false},{"name":"w_adult_sad01_f","loop":false},{"name":"w_adult_surprise01_f","loop":false},{"name":"w_adult_talk01_f","loop":false},{"name":"w_cool_angry01_f","loop":false},{"name":"w_cool_doubt01_f","loop":false},{"name":"w_cool_laugh01_f","loop":false},{"name":"w_cool_listen01_f","loop":false},{"name":"w_cool_sad01_f","loop":false},{"name":"w_cool_surprise01_f","loop":false},{"name":"w_cool_talk01_f","loop":false},{"name":"w_cute_angry01_f","loop":false},{"name":"w_cute_angry02_f","loop":false},{"name":"w_cute_doubt01_f","loop":false},{"name":"w_cute_laugh01_f","loop":false},{"name":"w_cute_listen01_f","loop":false},{"name":"w_cute_sad01_f","loop":false},{"name":"w_cute_surprise01_f","loop":false},{"name":"w_cute_talk01_f","loop":false},{"name":"w_emu_run02_f","loop":false},{"name":"w_happy_angry01_f","loop":false},{"name":"w_happy_angry02_f","loop":false},{"name":"w_happy_doubt01_f","loop":false},{"name":"w_happy_doubt02_f","loop":false},{"name":"w_happy_laugh01_f","loop":false},{"name":"w_happy_listen01_f","loop":false},{"name":"w_happy_sad01_f","loop":false},{"name":"w_happy_surprise01_f","loop":false},{"name":"w_happy_talk01_f","loop":false},{"name":"w_normal_laugh01_f","loop":false},{"name":"w_normal_listen01_f","loop":false},{"name":"w_normal_talk01_f","loop":false},{"name":"w_normal_walk01_b","loop":false},{"name":"w_normal_walk01_f","loop":false},{"name":"w_pure_angry01_f","loop":false},{"name":"w_pure_doubt01_f","loop":false},{"name":"w_pure_laugh01_f","loop":false},{"name":"w_pure_listen01_f","loop":false},{"name":"w_pure_sad01_f","loop":false},{"name":"w_pure_surprise01_f","loop":false},{"name":"w_pure_talk01_f","loop":false},{"name":"z_mesh_templete","loop":false},{"name":"z_test_F_negi01","loop":false}],"voices":[{"voice":"","text":"既见未来，为何不buy"}]}}
        });
    </script>
    <!-- hexo injector body_end end --></body></html>