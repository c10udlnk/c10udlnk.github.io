<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Reverse for fun =v="><meta name="keywords" content="CTF,Reverse,zero2one/å…¥é—¨,u5eful"><meta name="author" content="c10udlnk,undefined"><meta name="copyright" content="c10udlnk"><title>Reverse for fun =v= | c10udlnk's Blog</title><link rel="shortcut icon" href="/icon.jpg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@latest/dist/reveal.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@latest/dist/reset.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@latest/dist/theme/sky.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/highlight/monokai.css"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="c10udlnk's Blog" type="application/atom+xml">
</head><body><div class="reveal"><div class="slides"><section data-markdown data-separator="===" data-separator-vertical="==" data-charset="utf-8"><script type="text/template">
<style type="text/css">
    .reveal .left_items{ 
        text-align: left;
        font-size: 28px;
    }
    .reveal .subtitles{
        text-shadow: 5px 5px 10px #39C5BB;
    }
    .reveal .subtitle1{
        color: #921AFF;
        text-shadow: 3px 3px 3px #0080FF;
    }
    .reveal ul{ 
        display: block; 
    }
</style>


# <font color="#921AFF">Reverse</font>

### for

## fun!!!!!!

> CTFé€†å‘åŸºç¡€ç¯‡
>
>  -- By <font color="#0080FF">c10udlnkÂ </font><small> (a Sloth RE CTFer</small>

===

<h2 class="subtitles">é€†å‘å·¥ç¨‹æ¦‚è¿°</h2>

ä»€ä¹ˆæ˜¯<font color="red">â€œé€†å‘â€</font>ï¼Ÿ

<font color="red">â€œé€†å‘â€</font>ç©¶ç«Ÿåšäº›ä»€ä¹ˆï¼Ÿ

<font color="red">â€œé€†å‘â€</font>æ€ä¹ˆåšï¼Ÿ

==

<p class="left_items">é€†å‘å·¥ç¨‹ï¼ˆReverse Engineeringï¼Œç®€ç§°REï¼‰åœ¨è½¯ä»¶é¢†åŸŸä¸€èˆ¬æ˜¯æŒ‡é€šè¿‡åˆ†æç¨‹åºç»“æ„ã€åŠŸèƒ½ã€è¡Œä¸ºç­‰ï¼Œ<font color="red">æŒæ¡å…¶æ€»ä½“é€»è¾‘</font>ã€‚</p>

<h3 class="subtitle1">ä¸€äº›åº”ç”¨</h3>

- è½¯ä»¶ç ´è§£
- è½¯ä»¶ä¿æŠ¤
- è½¯ä»¶è¡¥ä¸
- æ¸¸æˆå¤–æŒ‚
- â€¦â€¦

==

<h3 class="subtitle1">é€†å‘åˆ†ææ–¹æ³•</h3>

#### é™æ€åˆ†ææ³•

<p class="left_items">é™æ€åˆ†ææ³•æ˜¯æŒ‡<font color="red">åœ¨ä¸æ‰§è¡Œä»£ç çš„æƒ…å†µä¸‹</font>ï¼Œå¯¹ä»£ç è¿›è¡Œé™æ€åˆ†æçš„æ–¹æ³•ã€‚ä¾‹å¦‚é€šè¿‡åˆ†æç¨‹åºè·å–å…¶ç±»å‹ã€å¤§å°ã€å­—ç¬¦ä¸²ç­‰ç›¸å…³ä¿¡æ¯ï¼Œé€šè¿‡åæ±‡ç¼–ã€åç¼–è¯‘å·¥å…·æŸ¥çœ‹å†…éƒ¨ä»£ç ã€åˆ†æä»£ç ç»“æ„ã€è·å–ä»£ç è¿è¡Œé€»è¾‘ã€‚</p>

![](image-20211022211237635.png)

#### åŠ¨æ€åˆ†ææ³•

<p class="left_items">åŠ¨æ€åˆ†ææ³•æ˜¯æŒ‡<font color="red">åœ¨ç¨‹åºæ–‡ä»¶çš„æ‰§è¡Œè¿‡ç¨‹ä¸­</font>å¯¹ä»£ç è¡Œä¸ºè¿›è¡Œåˆ†æçš„æ–¹æ³•ã€‚é€šè¿‡å€ŸåŠ©ç›¸å…³è°ƒè¯•å™¨æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿç¨‹åºè¡Œä¸ºï¼Œåˆ†æç¨‹åºå†…éƒ¨ç»“æ„å’ŒåŸç†ã€‚</p>

==

<h3 class="subtitle1">æ‰“è¡¥ä¸ && ç ´è§£</h3>

<p class="left_items">å¯¹åº”ç”¨ç¨‹åºæˆ–è€…è¿›ç¨‹å†…å­˜å†…å®¹çš„æ›´æ”¹ï¼Œå¦‚Windowsæ›´æ–°å°±æ˜¯ä¸€ä¸ªæ‰“è¡¥ä¸çš„ä¾‹å­ï¼Œç›®çš„æ˜¯ä¿®å¤ç¨‹åºæ¼æ´ï¼Œå¦ä¸€æ–¹é¢ä¿®æ”¹æŸäº›å•†ä¸šè½¯ä»¶çš„æ³¨å†Œé€»è¾‘æˆ–è€…é€†å‘æ³¨å†Œç®—æ³•åˆ™å¸¸è¢«ç§°ä¹‹ä¸ºç ´è§£ã€‚</p>

<p class="left_items">Crackmeï¼Œå…¬å¼€ç»™åˆ«äººç ´è§£çš„å°ç¨‹åºï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p>

1. KeyGenMeï¼šè¦æ±‚åˆ«äººåšå‡ºå®ƒçš„keygenï¼ˆæ³¨å†Œæœºï¼‰
2. ReverseMeï¼šè¦æ±‚åˆ«äººæŠŠå®ƒçš„ç®—æ³•åšå‡ºé€†å‘åˆ†æ
3. UnpackMeï¼šè¦æ±‚åˆ«äººæŠŠå®ƒæˆåŠŸè„±å£³

==

<h3 class="subtitle1">CTF - Reverse</h3>

<p class="left_items"><bold>CTFç«èµ›</bold>ä¸­çš„é€†å‘é¢˜ç›®ä¸€èˆ¬éƒ½æ˜¯ä»¥<font color="red">é€†å‘åˆ†æåŠ å¯†ç®—æ³•</font>ä¸ºä¸»ï¼Œåœ¨æ­¤åŸºç¡€ä¸ŠåŠ å…¥èŠ±æŒ‡ä»¤ã€åè°ƒè¯•ã€å£³ã€è™šæ‹Ÿæœºã€æ§åˆ¶æµæ··æ·†ã€å¤šè¿›ç¨‹/çº¿ç¨‹æŠ€æœ¯ç­‰å¤šç§è½¯ä»¶ä¿æŠ¤æŠ€æœ¯ä»¥å»¶ç¼“æˆ–è€…é˜»æŒ¡æ”»å‡»è€…çš„ç ´è§£ã€‚</p>

<small>å¯ä»¥å¾ˆç®€å•ï¼Œä¹Ÿå¯ä»¥éå¸¸éš¾ï¼Œéš¾é¢˜ä»¥ç»¼åˆå¯†ç å­¦çŸ¥è¯†å’ŒLinux/Windowsç³»ç»Ÿåº•å±‚åŸç†ä¸ºä¸»ã€‚</small>

![](image-20211023114519818.png)

==

<h3 class="subtitle1">ä¸€èˆ¬è§£é¢˜æ­¥éª¤</h3>

1. è·å–ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ï¼ˆæ–‡ä»¶ç±»å‹ã€æºè¯­è¨€ã€æœ‰æ— åŠ å£³â€¦â€¦ï¼‰
2. æ ¹æ®ä¿¡æ¯ä½¿ç”¨å¯¹åº”çš„å·¥å…·
3. å®šä½å…³é”®ä»£ç ï¼ˆå…³é”®å­—ç¬¦ä¸²å®šä½ã€é€»è¾‘å®šä½â€¦â€¦ï¼‰
4. ç»“åˆé™æ€åˆ†æå’ŒåŠ¨æ€åˆ†ææ ¹æ®ç¨‹åºé€»è¾‘é€†å‘æ¨å¯¼å‡ºæ”»å‡»ä»£ç 



<p class="left_items"><font color="red">é™æ€åˆ†æï¼š</font>çœ‹åç¼–è¯‘å™¨çš„ç»“æœè¿›è¡Œåˆ†æã€‚</p>

<p class="left_items">åˆ†æè¿‡ç¨‹ä¸ä¼šè¢«ç¨‹åºæ£€æµ‹åˆ°ï¼Œå¯ä»¥è®©ä¸€äº›åè°ƒè¯•æ‰‹æ®µæ— æ•ˆã€‚</p>

<p class="left_items"><font color="red">åŠ¨æ€åˆ†æï¼š</font>é€šè¿‡è°ƒè¯•å™¨å¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•ï¼Œé€šè¿‡ç¨‹åºçš„åŠ¨æ€æ‰§è¡Œè¿‡ç¨‹æ¥åˆ†æã€‚</p>

<p class="left_items">åˆ†æè¿‡ç¨‹ä¸æ˜“å—åˆ°åƒåœ¾ä»£ç å½±å“ï¼Œé€»è¾‘å¤æ‚çš„ä»£ç å¯ä»¥é€šè¿‡åŠ¨æ€è°ƒè¯•å¯¹åŠŸèƒ½è¿›è¡ŒçŒœæµ‹ã€‚</p>

===

<h2 class="subtitles">æ±‡ç¼–åŸºç¡€</h2>

ä»€ä¹ˆæ˜¯<font color="red">æ±‡ç¼–è¯­è¨€</font>ï¼Ÿ

<font color="red">å¯„å­˜å™¨</font>ã€è¿è¡Œæ ˆã€å‡½æ•°è°ƒç”¨çº¦å®šâ€¦â€¦

æ¥è®²ç‚¹<font color="red">æ±‡ç¼–</font>æŒ‡ä»¤é›†~å§

==

<h3 class="subtitle1">ä»€ä¹ˆæ˜¯æ±‡ç¼–è¯­è¨€</h3>

> <small>CSAPP: ... assembly code, a textual representation of the machine code giving the individual instructions in the program ...</small>

- æ˜¯ä¸€ç§åº•å±‚çš„è®¡ç®—æœºè¯­è¨€ï¼Œå¹¶ä¸æœºå™¨æŒ‡ä»¤ä¸€ä¸€å¯¹åº”
- æ±‡ç¼–è¯­è¨€ç›´æ¥æ§åˆ¶/æè¿°CPUçš„æ“ä½œ

==

<h3 class="subtitle1">å¯„å­˜å™¨</h3>

- æ˜¯ä¸­å¤®å¤„ç†å™¨å†…ç”¨æ¥æš‚å­˜æŒ‡ä»¤ã€æ•°æ®å’Œåœ°å€çš„ç”µè„‘å­˜å‚¨å™¨ã€‚
- å¯„å­˜å™¨çš„å­˜è´®å®¹é‡æœ‰é™ï¼Œè¯»å†™é€Ÿåº¦éå¸¸å¿«ã€‚
- åœ¨è®¡ç®—æœºä½“ç³»ç»“æ„é‡Œï¼Œå¯„å­˜å™¨å­˜å‚¨åœ¨å·²çŸ¥æ—¶é—´ç‚¹æ‰€ä½œè®¡ç®—çš„ä¸­é—´ç»“æœï¼Œé€šè¿‡å¿«é€Ÿåœ°è®¿é—®æ•°æ®æ¥åŠ é€Ÿè®¡ç®—æœºç¨‹åºçš„è¿è¡Œã€‚ 
- å¯„å­˜å™¨ä½äºå­˜å‚¨å™¨å±‚æ¬¡ç»“æ„çš„æœ€é¡¶ç«¯ï¼Œä¹Ÿæ˜¯CPUå¯ä»¥è¯»å†™çš„æœ€å¿«çš„å­˜å‚¨å™¨

==

![](image-20211022215438705.png)

==

<h3 class="subtitle1">å¯„å­˜å™¨åˆ†ç±»</h3>ï¼ˆä»¥X86ä¸ºä¾‹ï¼‰

- é€šç”¨å¯„å­˜å™¨ï¼šEAXã€EBXã€ECXã€EDXã€ESIã€EDIã€EBPã€ESP
- æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼šEIPï¼ˆæŒ‡å‘å½“å‰è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ï¼‰
- æ ‡å¿—å¯„å­˜å™¨ï¼šEFLAGSï¼ˆç¨‹åºæ ¹æ®æ ‡å¿—å­˜å™¨ä¼—çŠ¶æ€çš„å€¼æ§åˆ¶ç¨‹åºçš„åˆ†æ”¯è¯­å¥çš„è·³è½¬ï¼‰
- æ®µå¯„å­˜å™¨ï¼šCSã€DSã€SSã€ESã€FSã€GS
- ç‰¹æ®Šå¯„å­˜å™¨ï¼šDR0-DR7ï¼ˆå¯ç”¨äºè®¾ç½®ç¡¬ä»¶æ–­ç‚¹ï¼‰

==

<h3 class="subtitle1">æ±‡ç¼–æŒ‡ä»¤é›†</h3>

<p class="left_items">x86æ±‡ç¼–ä»£ç æœ‰ä¸¤ç§è®°æ³•ï¼šIntel å’Œ AT&Tã€‚å¸¸ç”¨çš„é€†å‘åˆ†æå·¥å…·å¦‚IDA Proã€Ollydbg<font color="red">é€šå¸¸ä½¿ç”¨Intelè®°æ³•</font>ï¼Œæ‰€ä»¥è¿™é‡Œä¸»è¦ä»¥Intelè¯­æ³•ä¸ºä¾‹ã€‚</p>

<p class="left_items">Intel å’Œ AT&Tè¯­æ³•çš„åŒºåˆ«ï¼š</p>

<small>

1. å‰ç¼€ï¼šAT&Tå¯„å­˜å™¨å‰ç¼€æœ‰'%'ï¼Œç«‹å³æ•°å‰ç¼€æœ‰'$'ï¼›ä½†åœ¨Intelä¸­å¹¶æ²¡æœ‰è¿™äº›å‰ç¼€ã€‚
2. åç¼€ï¼šåœ¨Intelä¸­ï¼Œé€šè¿‡åœ¨æ•°å­—åé¢æ·»åŠ 'h'æ¥è¡¨ç¤ºåå…­è¿›åˆ¶ï¼›è€Œåœ¨AT&Tä¸­åˆ™åœ¨æ•°å­—å‰é¢æ·»åŠ '0x'ï¼ŒåŒæ—¶intelçš„æŒ‡ä»¤ä¸­å¹¶æ²¡æœ‰åç¼€ã€‚
3. æ“ä½œæ•°æ–¹å‘: AT&Tä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæºæ“ä½œæ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®æ ‡æ“ä½œæ•°ã€‚ä½†åœ¨Intelä¸­åˆ™æ˜¯ç›¸åã€‚

</small>

==

æŒ‡ä»¤çš„ç±»å‹é€šå¸¸åˆ†ä¸º3ç§ï¼š

- æ•°æ®ç§»åŠ¨æŒ‡ä»¤ï¼šmovã€leaã€pushã€pop
- é€»è¾‘è¿ç®—æŒ‡ä»¤ï¼šaddã€subã€mulã€divã€xorã€orã€and
- æµç¨‹æ§åˆ¶æŒ‡ä»¤ï¼šjmpã€jeã€jzï¼ˆâ€¦â€¦ï¼‰ã€callã€retã€leave

==

<h4 class="subtitle1">mov</h4>

<p class="left_items">movæŒ‡ä»¤å¯ä»¥æŠŠç¬¬äºŒä¸ªå‚æ•°ä¸­çš„å€¼å¤åˆ¶åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ï¼Œè¯¥æŒ‡ä»¤å¯åœ¨å¯„å­˜å™¨å’Œå¯„å­˜å™¨ä¹‹é—´æ“ä½œï¼Œä¹Ÿå¯ä»¥åœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¹‹é—´æ“ä½œï¼Œä½†ä¸èƒ½åœ¨å†…å­˜å’Œå†…å­˜ä¸­æ“ä½œã€‚</p>

<small>

|       è¯­æ³•       |             ä¾‹å­             |
| :--------------: | :--------------------------: |
| mov 	reg, reg | mov 	ebx, dword ptr [eax] |
| mov	reg, mem  |       mov 	ebx, eax       |
| mov	mem, reg  |      mov 	eax, 0x10       |
| mov 	reg, con |                              |
| mov	mem, con  |                              |
|                  |                              |

</small>

==

<h4 class="subtitle1">lea</h4>

<p class="left_items">leaï¼š â€œload effective addressâ€ï¼Œç”¨äºæŠŠå†…å­˜åœ°å€èµ‹å€¼ç»™æ“ä½œæ•°ã€‚</p>

<small>

|      è¯­æ³•       |                             ä¾‹å­                             |
| :-------------: | :----------------------------------------------------------: |
| lea	reg, mem | lea	rax, [rbx]<br><font color="#39C5BB">;ç­‰ä»·äºmov	rax,rbx</font> |
|                 | lea	rax, [rax+rbx]<br><font color="#39C5BB">;ç­‰ä»·äºadd	rax,rbx</font> |

</small>

==

<h4 class="subtitle1">push</h4>

<p class="left_items">pushæŒ‡ä»¤è°ƒç”¨æ—¶ï¼Œä¼šå…ˆæŠŠespï¼ˆæ ˆé¡¶æŒ‡é’ˆï¼‰å‡4ï¼Œå¹¶å°†å‚æ•°å¤åˆ¶åˆ°æ ˆé¡¶å½“ä¸­</p>

<h4 class="subtitle1">pop</h4>

<p class="left_items">popæŒ‡ä»¤ä¸ºpushçš„é€†æ“ä½œï¼Œè°ƒç”¨æ—¶ä¼šæŠŠespï¼ˆæ ˆé¡¶æŒ‡é’ˆï¼‰æŒ‡å‘çš„æ•°æ®å¤åˆ¶åˆ°æ“ä½œæ•°ä¸­ï¼Œç„¶åå¯¹ESPåŠ 4</p>

<small>

|                   è¯­æ³•                    |                             ä¾‹å­                             |
| :---------------------------------------: | :----------------------------------------------------------: |
| push	reg<br>push	mem<br>push	con | push	rdi<br><font color="#39C5BB">;ç­‰ä»·äºesp-=4;[esp]=rdi</font> |
|         pop	reg<br>pop	mem          | pop	rdi<br/><font color="#39C5BB">;ç­‰ä»·äºrdi=[esp];esp+=4</font> |

</small>

==

<h4 class="subtitle1">é€»è¾‘è¿ç®—</h4>

é€»è¾‘è¿ç®—æŒ‡ä»¤ä»¥`add`æŒ‡ä»¤ä¸ºä¾‹ï¼Œå…¶ä½™åŒç›®è¿ç®—ç¬¦ç±»ä¼¼ã€‚

<p class="left_items">add:  å°†ä¸¤å‚æ•°ç›¸åŠ å¹¶å­˜å‚¨åˆ°ç›®æ ‡å‚æ•°ä¸­ã€‚åœ¨è¯­æ³•ä¸­ï¼Œå¿…é¡»è¦è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ä¸ºå¯„å­˜å™¨ã€‚</p>

<small>

|                             è¯­æ³•                             |      ä¾‹å­      |
| :----------------------------------------------------------: | :------------: |
| add	reg, reg<br>add	mem, reg<br>add	reg, mem<br>add 	reg, con<br>add	mem, con | add 	eax,10 |

</small>

==

<h4 class="subtitle1">æµç¨‹æ§åˆ¶</h4>

<p class="left_items">åœ¨æ±‡ç¼–ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨æ ‡ç­¾ä»¥åŠè·³è½¬æŒ‡ä»¤æ¥æ§åˆ¶æµç¨‹ï¼Œä¾‹å¦‚ï¼š</p>

```assembly
begin:  add	eax,1
        mov	edi,eax
        jmp	begin
```

<p class="left_items">æ±‡ç¼–è¿è¡Œåˆ°æœ€åä¸€å¥çš„æ—¶å€™ï¼Œæ‰§è¡Œjmp beginï¼Œç¨‹åºæ‰§è¡Œè·³åˆ°beginæ ‡ç­¾å¤„ã€‚</p>

é€šå¸¸è·³è½¬éƒ½ä¼šå’Œcmpï¼ˆæ¯”è¾ƒæŒ‡ä»¤ï¼‰å’Œä¸€èµ·ä½¿ç”¨ã€‚

==

<h4 class="subtitle1">æµç¨‹æ§åˆ¶</h4>

<p class="left_items">cmpï¼šæ¯”è¾ƒæŒ‡ä»¤ï¼Œå°†ä¸¤ä¸ªæ“ä½œæ•°çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒçš„ç»“æœä¼šå­˜åœ¨çŠ¶æ€å¯„å­˜å™¨ä¸­ï¼Œä½†ä¸ä¼šæ”¹å˜æ“ä½œæ•°çš„å€¼ã€‚</p>

```assembly
cmp	reg, reg
cmp	mem, reg
cmp	reg, mem
cmp	reg, con
```

<p class="left_items">ä¸è·³è½¬æŒ‡ä»¤ç»“åˆä½¿ç”¨ï¼š</p>

```assembly
cmp ebx, eax  ;å°†ebxå’Œeaxè¿›è¡Œæ¯”è¾ƒ
je  label     ;å¦‚æœæ¯”è¾ƒç»“æœç›¸ç­‰çš„è¯åˆ™è¿›è¡Œè·³è½¬equal
```

<p class="left_items">å…¶ä»–è·³è½¬æŒ‡ä»¤ï¼š</p>

`jne`ï¼ˆä¸ç›¸ç­‰ï¼‰ã€ `jg`ï¼ˆå¤§äºï¼‰ã€`jge`ï¼ˆå¤§äºç­‰äºï¼‰ã€`jl`ï¼ˆå°äºï¼‰ã€`jle`ï¼ˆå°äºç­‰äºï¼‰â€¦â€¦

==

<h4 class="subtitle1">æµç¨‹æ§åˆ¶</h4>

<p class="left_items">callï¼šå‡½æ•°è°ƒç”¨</p>

```assembly
call func
;ç›¸å½“äºpush eip | jmp func
```

<p class="left_items">retï¼šå‡½æ•°è¿”å›</p>

```assembly
ret
;ç›¸å½“äºpop eip
```

<p class="left_items">leaveï¼šè¿˜åŸebpã€esp</p>

```assembly
leave
;ç›¸å½“äºmov esp, ebp | pop ebp
```

===

<h2 class="subtitles">ç›¸å…³å·¥å…·</h2>

é”µé”µ~

<font color="red">å¸¸ç”¨å·¥å…·</font>å’Œ<font color="red">æœ€å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨æ–¹æ³•</font>éƒ½åœ¨è¿™é‡Œ~

==

<h3 class="subtitle1">å®éªŒç¯å¢ƒ</h3>

<small>

- <font color="red">æ“ä½œç³»ç»Ÿï¼š</font>Windows + Linuxè™šæ‹Ÿæœº/æœåŠ¡å™¨/WSL2
- <font color="red">æŸ¥çœ‹PEä¿¡æ¯ï¼š</font>ExeinfoPEã€PEIDã€LordPEâ€¦â€¦
- <font color="red">åæ±‡ç¼–/åç¼–è¯‘ï¼š</font>IDA7.5/IDA7.0ï¼ŒOllydbgï¼Œghidraâ€¦â€¦
- <font color="red">IDAæ’ä»¶ï¼š</font>findcrypt3ã€keypatchã€lazyIDAâ€¦â€¦
- <font color="red">è°ƒè¯•ï¼š</font>IDA7.5/IDA7.0ï¼ˆå¤šå¹³å°åæ±‡ç¼–ã€åç¼–è¯‘è½¯ä»¶ï¼Œå†…ç½®Windowsã€Linuxã€MacOSã€ARMç­‰å¤šå¹³å°è°ƒè¯•å™¨ï¼‰ï¼ŒOllydbgï¼ˆWin32åæ±‡ç¼–å·¥å…·ã€è°ƒè¯•å™¨ï¼‰ï¼ŒWinDbgï¼ˆWindowså†…æ ¸è°ƒè¯•å™¨ï¼‰ï¼ŒGDBï¼ˆLinuxå¹³å°è°ƒè¯•å™¨ï¼‰â€¦â€¦
- <font color="red">å°‘è§è¯­è¨€åç¼–è¯‘</font>ï¼šdnSpyï¼ˆ.Netï¼‰ã€JEBï¼ˆapkï¼‰ã€jd-guiï¼ˆJavaå­—èŠ‚ç ï¼‰â€¦â€¦
- <font color="red">å‚è€ƒä¹¦ç±ï¼š</font>**åŠ å¯†ä¸è§£å¯†4** ã€æ±‡ç¼–è¯­è¨€ã€CSAPPã€é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†

</small>

==

<h3 class="subtitle1">IDAPro</h3>

The IDA Disassembler and Debugger is an interactive, programmable, extensible, multi-processor disassembler hosted on Windows, Linux, or Mac OS X. 

- Disassembler
- Debugger
- Interactive
- Programmable

==

![](image-20211023125101532.png)

==

<h3 class="subtitle1">ä¸€äº›å¿«æ·é”®</h3>

- `F5`ï¼šåç¼–è¯‘
- `TAB`ï¼šåæ±‡ç¼–çª—å£ã€åç¼–è¯‘çª—å£åˆ‡æ¢
- `shift + F12`ï¼šæŸ¥çœ‹å­—ç¬¦ä¸²
- `x`ï¼šäº¤å‰å¼•ç”¨
- `/`ï¼šæ³¨é‡Š
- `n`ï¼šä¿®æ”¹æ ‡è¯†ç¬¦
- `ENTER / åŒå‡»`ï¼šè¿›å…¥å‡½æ•°ï¼ˆè·³è½¬åˆ°é¼ æ ‡æŒ‡å‘çš„ä½ç½®ï¼‰
- `g`ï¼šè·³è½¬åˆ°æŸä¸€åœ°å€
- `ESC`ï¼šåé€€ä¸Šä¸€ä½ç½®
- `crtl + s`ï¼šæŸ¥çœ‹åŒºæ®µ

==

<h3 class="subtitle1">ä¸€äº›å¿«æ·é”®</h3>

- `p`ï¼šcreate function
- `c`ï¼šcovert to code
- `d`ï¼šcovert to data
- `h`ï¼šcovert to hex
- `r`ï¼šcovert to ascii
- `a`ï¼šcovert to string
- `u`ï¼šundefine

==

<h3 class="subtitle1">HexRays Decompiler</h3>

![](image-20211023130040921.png)

![](image-20211023130101470.png)

==

<h3 class="subtitle1">åŠ¨æ€è°ƒè¯•</h3>

åŠ¨æ€è°ƒè¯•æ•™ç¨‹ä¼ é€é—¨ -> [https://c10udlnk.top/p/reSkillsOn-Debugging](https://c10udlnk.top/p/reSkillsOn-Debugging)

- `F2`ï¼šCCæ–­ç‚¹
- `F4`ï¼šæ‰§è¡Œåˆ°æ‰€æŒ‡å‘çš„ä½ç½®
- `F7`ï¼šå•æ­¥æ‰§è¡Œï¼ˆæ­¥å…¥ï¼‰
- `F8`ï¼šå•æ­¥æ‰§è¡Œï¼ˆæ­¥è¿‡ï¼‰
- `F9`ï¼šæ‰§è¡Œåˆ°ä¸‹ä¸€æ–­ç‚¹

è°ƒè¯•æ—¶ï¼Œæ•°æ®ã€å †æ ˆã€å¯„å­˜å™¨ã€æ±‡ç¼–ä»£ç éƒ½å¯ä»¥ç›´æ¥ä¿®æ”¹ã€‚

===

<h2 class="subtitles">ä¸€ç‚¹ç»ƒä¹ </h2>

æ—¢ç„¶ä½ å·²ç»å­¦ä¼šHello worldäº†ï¼Œ

é‚£æˆ‘ä»¬å°±æ¥<font color="red">å®è·µä¸€ä¸‹</font>å§~

==

<h3 class="subtitle1">å®éªŒæ­¥éª¤</h3>

<small>

1. é€šè¿‡é™æ€åˆ†æå’ŒåŠ¨æ€è°ƒè¯•åˆ†æç¨‹åºæ‰§è¡Œé€»è¾‘
2. é€šè¿‡åˆ†æç¨‹åºæ‰§è¡Œé€»è¾‘è¿˜åŸCheckç®—æ³•
3. é€†å‘Checkç®—æ³•è·å–flag

</small>

|   Demo    |          å…³é”®ç‚¹          |
| :-------: | :----------------------: |
| Xor_Win32 |    xorã€win32åŠ¨æ€è°ƒè¯•    |
| Xor_Linux |    xorã€linuxåŠ¨æ€è°ƒè¯•    |
| babyMaze  | è¯»æ‡‚ä¼ªä»£ç ï¼Œäº†è§£ç¨‹åºé€»è¾‘ |
|  base64   |     å¸¸è§ç¼–ç ç®—æ³•åˆ†æ     |

===

<h2 class="subtitles">æ‰“å¹¿å‘Šæ—¶é—´â€¦â€¦</h2>

<small>

1. 2021å¹´åå¸ˆCTFæ–°ç”Ÿèµ›å°±è¦å¼€å§‹äº†ï¼æ¬¢è¿å¤§å®¶è¸Šè·ƒæŠ¥åï¼

   æœ‰ç‚’é¸¡ä¸°å¯Œçš„å¥–å“ç­‰ç€ä½ ä»¬ï¼Œè¿˜æœ‰æœºä¼šåŠ å…¥Slothè·Ÿæˆ‘ä»¬ä¸€èµ·ç©yo~ >v<

   ï¼ˆè¯¦ç»†æ—¶é—´å®‰æ’å…³æ³¨@ISCNUå…¬ä¼—å·ï¼‰

2. HSCTF{Sloth}å®‰å…¨å¹æ°´ç¾¤ğŸ‘‡

==

![](image-20211023172643781.png)

</small>
</script></section></div></div><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/dist/reveal.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/zoom/zoom.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/search/search.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/notes/notes.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/math/math.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/markdown/markdown.js"></script><script src="https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/highlight/highlight.js"></script><script>Reveal.initialize({
  mouseWheel: false,
  transition: 'convex',
  transitionSpeed: 'default',
  parallaxBackgroundImage: '',
  parallaxBackgroundSize: '',
  parallaxBackgroundHorizontal: '',
  parallaxBackgroundVertical: '',
  autoSlide: false,
  loop: false,
  controlsLayout: 'bottom-right', // Determines where controls appear, "edges" or "bottom-right"
  controlsBackArrows: 'faded',
  progress: true,
  showNotes: false,
  autoPlayMedia: false,
  backgroundTransition: 'fade',
  markdown: {
    smartypants: true
  },
  plugins: [
  // Search
  RevealSearch,
  // Speaker notes
  RevealNotes,
  // Zoom in and out with Alt+click
  RevealZoom,
  // MathJax
  RevealMath,
  // Markdown
  RevealMarkdown,
  // Highlight
  RevealHighlight,
  ],
  dependencies: [
    //- { src: 'https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/markdown/markdown.js', condition: //- function() { return !!document.querySelector( '[data-markdown]' ); } },
    // Syntax highlight for <code> elements
    //- { src: 'https://cdn.jsdelivr.net/npm/reveal.js@latest/plugin/highlight/highlight.js', async: true, callback: function() {
    //-   // issue #218
    //-   setTimeout(function () {
    //-     hljs.initHighlighting();
    //-   }, 0)
    //- } },
  ]
});
</script><script>console.log(
  "plugins search: ", Reveal.hasPlugin( 'search' ),
  ", plugins markdown: ", Reveal.hasPlugin( 'markdown' ),
  ", plugins highlight: ", Reveal.hasPlugin( 'highlight' ),
);</script><!-- hexo injector body_end start -->
    <div class="myspine-spine-widget"></div>
    <script src="/js/third-party/myspine/spine-widget.js"></script>
    <script src="/js/third-party/myspine/spine-skeleton-binary.js"></script>
    <script src="/js/third-party/myspine/myspine.js"></script>
    <link type="text/css" href="/css/_third-party/myspine.css"></link>
    <script>
        new MySpine({
            spineDir: "/spine_models/",
            models: [{"name":"sd_21miku_normal_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_band_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_idol_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_night_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_street_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_wonder_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"}],
            styles: {"widget":{"width":"200px","height":"200px"},"voiceText":{"color":"#e6e6e6"}},
            behaviors: {"start":{"animation":"w_emu_run01_f","voice":"","text":"Ohhhhhå¥½è€¶"},"idle":{"maxMinutes":1,"animations":[{"name":"m_cool_idle01_f","loop":false},{"name":"m_cool_joy01_f","loop":false},{"name":"m_happy_idle01_f","loop":false},{"name":"m_happy_joy01_f","loop":false},{"name":"m_normal_idle01_f","loop":false},{"name":"m_normal_joy01_f","loop":false},{"name":"m_staff_idle01_f","loop":false},{"name":"n_general_wait_01_f","loop":false},{"name":"pose_default","loop":false},{"name":"u_vbsmen_battledore00_f","loop":false},{"name":"u_vbswomen_battledore00_f","loop":false},{"name":"w_adult_idle01_f","loop":false},{"name":"w_adult_joy01_f","loop":false},{"name":"w_cool_idle01_f","loop":false},{"name":"w_cool_joy01_f","loop":false},{"name":"w_cute_idle01_f","loop":false},{"name":"w_cute_joy01_f","loop":false},{"name":"w_happy_idle01_f","loop":false},{"name":"w_happy_joy01_f","loop":false},{"name":"w_normal_idle01_f","loop":false},{"name":"w_normal_joy01_f","loop":false},{"name":"w_pure_idle01_f","loop":false},{"name":"w_pure_joy01_f","loop":false},{"name":"w_staff_idle01_f","loop":false}],"voices":[{"voice":"","text":"ä¸ä¹°ç«‹çœç™¾åˆ†ç™¾"}]},"interact":{"maxPlaySec":3,"animations":[{"name":"w_normal_joy01_b","loop":false},{"name":"m_cool_angry01_f","loop":false},{"name":"m_cool_doubt01_f","loop":false},{"name":"m_cool_laugh01_f","loop":false},{"name":"m_cool_listen01_f","loop":false},{"name":"m_cool_sad01_f","loop":false},{"name":"m_cool_surprise01_f","loop":false},{"name":"m_cool_talk01_f","loop":false},{"name":"m_happy_angry01_f","loop":false},{"name":"m_happy_doubt01_f","loop":false},{"name":"m_happy_laugh01_f","loop":false},{"name":"m_happy_listen01_f","loop":false},{"name":"m_happy_sad01_f","loop":false},{"name":"m_happy_surprise01_f","loop":false},{"name":"m_happy_talk01_f","loop":false},{"name":"m_normal_angry01_f","loop":false},{"name":"m_normal_doubt01_f","loop":false},{"name":"m_normal_laugh01_f","loop":false},{"name":"m_normal_listen01_f","loop":false},{"name":"m_normal_surprise01_f","loop":false},{"name":"m_normal_talk01_f","loop":false},{"name":"m_normal_walk01_b","loop":false},{"name":"m_normal_walk01_f","loop":false},{"name":"m_tsukasa_run01_f","loop":false},{"name":"n_general_walk_01_b","loop":false},{"name":"n_general_walk_01_f","loop":false},{"name":"u_liondancerobot_run_01_f","loop":false},{"name":"u_liondancerobot_run_02_f","loop":false},{"name":"u_vbsmen_battledore01_f","loop":false},{"name":"u_vbsmen_battledore02_f","loop":false},{"name":"u_vbsmen_battledore03_f","loop":false},{"name":"u_vbsmen_battledore04_f","loop":false},{"name":"u_vbswomen_battledore01_f","loop":false},{"name":"u_vbswomen_battledore02_f","loop":false},{"name":"u_vbswomen_battledore03_f","loop":false},{"name":"u_vbswomen_battledore04_f","loop":false},{"name":"w_adult_angry01_f","loop":false},{"name":"w_adult_doubt01_f","loop":false},{"name":"w_adult_laugh01_f","loop":false},{"name":"w_adult_listen01_f","loop":false},{"name":"w_adult_sad01_f","loop":false},{"name":"w_adult_surprise01_f","loop":false},{"name":"w_adult_talk01_f","loop":false},{"name":"w_cool_angry01_f","loop":false},{"name":"w_cool_doubt01_f","loop":false},{"name":"w_cool_laugh01_f","loop":false},{"name":"w_cool_listen01_f","loop":false},{"name":"w_cool_sad01_f","loop":false},{"name":"w_cool_surprise01_f","loop":false},{"name":"w_cool_talk01_f","loop":false},{"name":"w_cute_angry01_f","loop":false},{"name":"w_cute_angry02_f","loop":false},{"name":"w_cute_doubt01_f","loop":false},{"name":"w_cute_laugh01_f","loop":false},{"name":"w_cute_listen01_f","loop":false},{"name":"w_cute_sad01_f","loop":false},{"name":"w_cute_surprise01_f","loop":false},{"name":"w_cute_talk01_f","loop":false},{"name":"w_emu_run02_f","loop":false},{"name":"w_happy_angry01_f","loop":false},{"name":"w_happy_angry02_f","loop":false},{"name":"w_happy_doubt01_f","loop":false},{"name":"w_happy_doubt02_f","loop":false},{"name":"w_happy_laugh01_f","loop":false},{"name":"w_happy_listen01_f","loop":false},{"name":"w_happy_sad01_f","loop":false},{"name":"w_happy_surprise01_f","loop":false},{"name":"w_happy_talk01_f","loop":false},{"name":"w_normal_laugh01_f","loop":false},{"name":"w_normal_listen01_f","loop":false},{"name":"w_normal_talk01_f","loop":false},{"name":"w_normal_walk01_b","loop":false},{"name":"w_normal_walk01_f","loop":false},{"name":"w_pure_angry01_f","loop":false},{"name":"w_pure_doubt01_f","loop":false},{"name":"w_pure_laugh01_f","loop":false},{"name":"w_pure_listen01_f","loop":false},{"name":"w_pure_sad01_f","loop":false},{"name":"w_pure_surprise01_f","loop":false},{"name":"w_pure_talk01_f","loop":false},{"name":"z_mesh_templete","loop":false},{"name":"z_test_F_negi01","loop":false}],"voices":[{"voice":"","text":"æ—¢è§æœªæ¥ï¼Œä¸ºä½•ä¸buy"}]}}
        });
    </script>
    <!-- hexo injector body_end end --></body></html>