<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="【wp】2020XCTF_逆向"><meta name="keywords" content="CTF,Reverse,wp"><meta name="author" content="c10udlnk"><meta name="copyright" content="c10udlnk"><title>【wp】2020XCTF_逆向 | c10udlnk's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到你搜索的这个呀>^<（FOR ${query}）"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="c10udlnk's Blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经阅读 -&gt;</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#12-20-%E5%8D%8E%E4%B8%BA%E4%BA%91%E4%B8%93%E5%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">[12.20] 华为云专场</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Weird-lua"><span class="toc-number">1.1.</span> <span class="toc-text">Weird_lua</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%9F%E7%9D%80%E5%AE%98%E6%96%B9wp%E8%B5%B0%E4%B8%8D%E9%80%9A%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.1.</span> <span class="toc-text">跟着官方wp走不通的思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%88%9B%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.2.</span> <span class="toc-text">自创思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#divination-TO-DO"><span class="toc-number">1.2.</span> <span class="toc-text">divination[TO DO]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-23-%E9%B2%B2%E9%B9%8F%E8%AE%A1%E7%AE%97%E4%B8%93%E5%9C%BA"><span class="toc-number">2.</span> <span class="toc-text">[12.23] 鲲鹏计算专场</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mips"><span class="toc-number">2.1.</span> <span class="toc-text">mips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pypy"><span class="toc-number">2.2.</span> <span class="toc-text">pypy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#print"><span class="toc-number">2.3.</span> <span class="toc-text">print</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-27-HarmonyOS%E5%92%8CHMS%E4%B8%93%E5%9C%BA"><span class="toc-number">3.</span> <span class="toc-text">[12.27] HarmonyOS和HMS专场</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#re123"><span class="toc-number">3.1.</span> <span class="toc-text">re123</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#puzzle"><span class="toc-number">3.2.</span> <span class="toc-text">puzzle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#aRm"><span class="toc-number">3.3.</span> <span class="toc-text">aRm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pe"><span class="toc-number">3.4.</span> <span class="toc-text">pe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crash"><span class="toc-number">3.5.</span> <span class="toc-text">crash</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/c10udlnk=v=.jpg"></div><div class="author-info__name text-center">c10udlnk</div><div class="author-info__description text-center">A RE CTFer, a s0Ity f1sh... &lt;。)#)))≦</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/c10udlnk">do not Follow Me</a></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/ToverPomelo">just Follow my \Tover/</a></div><hr><div class="author-info-articles"><a class="author-info-articles__linkbf article-meta" target="_blank" rel="noopener" href="https://tover.xyz"><span class="pull-left">\Tover/ \Tover/ \Tover/</span><span class="pull-right">jmp → </span></a><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">41</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">12</span></a><a class="author-info-articles__links article-meta" href="/links"><span class="pull-left">友链</span><span class="pull-right">∞</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/lijiang-tower.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">c10udlnk's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/archives">po5ts</a><a class="site-page" href="/tags">t4gs</a><a class="site-page" href="/categories">categ0ries</a><a class="site-page" href="/slides">slid3s</a><a class="site-page" href="/links">l1nks</a><a class="site-page" href="/p/blogsFor-AboutMe-Pinned">Who Am I</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">【wp】2020XCTF_逆向</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-12-29</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Write-up/">Write up</a><div class="post-meta-wordcount"><span>Words cnt: </span><span class="word-count">30.3k</span><span class="post-meta__separator">|</span><span>Need time: 169 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>前几天的XCTF最后一场终于打完了，三场比赛下来对逆向部分的大概感觉是从第一场的啥都不会做到后来的终于能有参与度了TvT，至少后两场的题目都是pc逆向，虽然特殊架构但好歹能做（tcl</p>
<p>本文是三场XCTF所有逆向题目的wp+复现整理。赛中拿到了7&#x2F;10的flag，很多是跟着队里的大佬做出来的（tqltql），这边就试着独立复现一下，至少打完应该长长记性（</p>
<p>官方wp出了，借助wp提供的思路复现填坑√。（9&#x2F;10）</p>
<a id="more"></a>

<p>1220那场的apk逆向还没复现完，因为博客要更新点配置所以就先放上来了qvq。</p>
<p>比赛官网：<a target="_blank" rel="noopener" href="https://huaweictf2020.xctf.org.cn/">XCTF高校网络安全专题挑战赛</a></p>
<p>官方wp：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.xctf.org.cn/library/details/b69108559ccd6ff0fa3ec79e3f2f198f121e90a8/">XCTF高校网络安全专题挑战赛-华为云专场 官方Writeup - XCTF社区</a></li>
<li><a target="_blank" rel="noopener" href="https://www.xctf.org.cn/library/details/55599c9c17ea0e8ca0b094adbe075a03a7321599/">XCTF高校网络安全专题挑战赛-鲲鹏计算专场 官方Writeup - XCTF社区</a></li>
<li><a target="_blank" rel="noopener" href="https://www.xctf.org.cn/library/details/5acdc1c31cf4935ac38fce445978888a5710cf11/">XCTF高校网络安全专题挑战赛-HarmonyOS和HMS专场 官方Writeup - XCTF社区</a></li>
</ol>
<hr>
<h1 id="12-20-华为云专场"><a href="#12-20-华为云专场" class="headerlink" title="[12.20] 华为云专场"></a>[12.20] 华为云专场</h1><h2 id="Weird-lua"><a href="#Weird-lua" class="headerlink" title="Weird_lua"></a>Weird_lua</h2><blockquote>
<p>根据官方wp，说是改了loadbyte和opcode顺序。这里假装没看过wp，看能不能分析出怎么看出来是这里魔改的。</p>
</blockquote>
<p>首先看附件是<code>lua</code>和<code>check_license_out.lua</code>，可以用file分别看一下</p>
<p><img src="/p/wpFor-2020XCTF/image-20210225152906252.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210225152915828.png"></p>
<p>单独运行<code>./lua</code>，可以看到版本号是5.3.3</p>
<p><img src="/p/wpFor-2020XCTF/image-20210225160651288.png"></p>
<p>这里运行目标文件的方式是<code>./lua ./check_license_out.lua</code></p>
<p><img src="/p/wpFor-2020XCTF/image-20210225153920925.png"></p>
<p>感觉这个.lua文件实际可能是.luac文件，即lua字节码文件。</p>
<p>于是先随便写一个lua源码（除了不知名check以外，大致对目标文件<code>check_license_out.lua</code>进行复刻），用v5.3.3的lua（可以在lua官网<a target="_blank" rel="noopener" href="http://www.lua.org/download.html">Lua: download</a>下载）编译成字节码，看看正常版和魔改版两个文件的区别。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(s)</span></span></span><br><span class="line">    <span class="keyword">local</span> <span class="built_in">len</span>=#s</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>==<span class="number">42</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Check!&quot;</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;length error&quot;</span></span><br><span class="line">    <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">write</span>(<span class="string">&quot;input: &quot;</span>)</span><br><span class="line">str=<span class="built_in">io</span>.<span class="built_in">read</span>()</span><br><span class="line"><span class="built_in">print</span>(check(str))</span><br></pre></td></tr></table></figure>

<p>用<code>lua test.lua</code>运行：（注意这里是用正常的lua解释器而不是题目给的）</p>
<p><img src="/p/wpFor-2020XCTF/image-20210225154050280.png"></p>
<p>然后用<code>luac -o test.luac test.lua</code>得到<code>test.luac</code>字节码文件，然后把<code>check_license_out.lua</code>（上）和<code>test.luac</code>（下）用010Editor打开对比十六进制码。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210225154521444.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210225154542779.png"></p>
<p>可以看到，除了最开始的一字节为”1B”和”1C”以外，其余文件头中不同的字节都相差较大，感觉是某个特定的换算关系，位置看起来却没什么规律。</p>
<p>定位到<code>lua-5.3.3/src</code>文件夹中，有两个执行luac dump相关操作的头文件，分别是<code>ldump.h</code>（save precompiled Lua chunks）和<code>lundump.h</code>（load precompiled Lua chunks），这里猜测是用于load的<code>lundump.c</code>被魔改。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210302235800922.png"></p>
<p>从这里（类似于主函数的函数）开始是整个的load步骤，可以看到上面对比中第一个差距比较大的字节是在0004h的位置，应该是在checkHeader部分，跟进这个<code>checkHeader()</code>函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210303000036934.png"></p>
<p>237行是check文件头的<code>&quot;\x1bLua&quot;</code>部分（题目开头0x1c这个很容易看出就是硬改），而下面开始是check LUAC_VERSION即lua的版本号，本来应该是0x53，但是题目文件对应位置是0xAC，而且往后对照可以看到，不同字节部分都用了<code>LoadByte()</code>函数，猜测是在加载字节的时候有魔改，至于具体怎么魔改那可能得靠直觉了吧(。)，大概能靠猜？（或者看<code>lua</code>文件的反编译&#x3D; &#x3D;</p>
<p>在官方wp里，魔改的具体信息已经给了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> lu_byte <span class="title">LoadByte</span> <span class="params">(LoadState *S)</span> </span>&#123;</span><br><span class="line">    lu_byte x;</span><br><span class="line">    LoadVar(S, x);</span><br><span class="line">    <span class="comment">//x ^= 0xff; 此行为魔改部分</span></span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="跟着官方wp走不通的思路"><a href="#跟着官方wp走不通的思路" class="headerlink" title="跟着官方wp走不通的思路"></a>跟着官方wp走不通的思路</h3><p><strong>本部分可跳过</strong>，最后因为刚刚接触lua，对这个语言不熟悉，卡在创造不出帖子里提到的 <strong>“用于 dump 的函数，尽量覆盖所有的指令操作，否则只能提取出已有的指令”</strong> 的lua函数，帖子里的test无法在5.3版本的lua中提取出所有字节码，需要自己动手创造（。</p>
<p>因为这里LoadByte的魔改会影响到下一步的opcode顺序还原，所以要先把这些错误字节xor回去。</p>
<p>又因为LoadByte的更改只影响到部分字节，我们并不清楚具体哪些字节遭到了祸害，所以想到了一个比较笨的方法就是重新编译一个lua解释器，这样我们就有了opcode顺序魔改前的解释器和魔改后的解释器（题目所给的）。</p>
<p>（如果有师傅有更好的办法求告知&gt;&lt;）</p>
<p>将之前的<code>lua-5.3.3</code>文件夹复制到一个新路径，cd到文件夹中，执行<code>make clean</code>将文件中上一次的编译临时文件清空。<del>其实理论上说不复制出来也应该不会影响到原来的lua，但为了保险起见还是这么干吧。</del></p>
<p>然后把<code>lua-5.3.3/src/ldump.c</code>（注意文件名！！）的52-56行即<code>DumpByte()</code>函数部分改为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DumpByte</span> <span class="params">(<span class="keyword">int</span> y, DumpState *D)</span> </span>&#123;</span><br><span class="line">  lu_byte x = (lu_byte)y;</span><br><span class="line">  x^=<span class="number">0xff</span>;<span class="comment">//增加此行</span></span><br><span class="line">  DumpVar(x, D);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>保存，退回到<code>lua-5.3.3</code>根目录下，在WSL中用<code>make linux</code>编译。</p>
<p>至于为什么是改<code>ldump.c</code>而不是改官方wp指定魔改的<code>lundump.c</code>，因为<code>ldump.c</code>的作用是保存字节码，而<code>lundump.c</code>的作用是加载字节码。这里参照<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-250618.htm">[原创]用 Lua 简单还原 OpCode 顺序</a>文中的方法进行还原。</p>
<p>帖子里的lua版本为v5.1.5，对这里v5.3.3并不能直接用（opcode有增加+有些5.3中新增的指令），需要对源码（<code>Check_OpCode/check_opcode.lua</code>）做一些修改，修改后的文件如下。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- check_opcode.lua</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> bit = <span class="built_in">require</span>(<span class="string">&#x27;bit&#x27;</span>)</span><br><span class="line"><span class="keyword">local</span> test = <span class="built_in">require</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 加载用正常 lua 的 dump 文件</span></span><br><span class="line"><span class="keyword">local</span> fp = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.luac&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="keyword">local</span> ori_data = fp:<span class="built_in">read</span>(<span class="string">&quot;*all&quot;</span>)</span><br><span class="line">fp:<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">-- print(&#x27;data len &#x27;.. #data)</span></span><br><span class="line"><span class="comment">-- print(&#x27;ori_data len &#x27; .. #ori_data)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> ori_op_name = &#123;</span><br><span class="line">    <span class="string">&quot;MOVE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LOADK&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LOADKX&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LOADBOOL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LOADNIL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GETUPVAL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GETTABUP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GETTABLE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SETTABUP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SETUPVAL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SETTABLE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;NEWTABLE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SELF&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ADD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SUB&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MUL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MOD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;POW&quot;</span>,</span><br><span class="line">    <span class="string">&quot;DIV&quot;</span>,</span><br><span class="line">    <span class="string">&quot;IDIV&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BAND&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BOR&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BXOR&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SHL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SHR&quot;</span>,</span><br><span class="line">    <span class="string">&quot;UNM&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BNOT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;NOT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LEN&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CONCAT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;JMP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;EQ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TEST&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TESTSET&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TAILCALL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;RETURN&quot;</span>,</span><br><span class="line">    <span class="string">&quot;FORLOOP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;FORPREP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TFORCALL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TFORLOOP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;SETLIST&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CLOSURE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;VARARG&quot;</span>,</span><br><span class="line">    <span class="string">&quot;EXTRAARG&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">local</span> data = <span class="built_in">string</span>.<span class="built_in">dump</span>(test)	<span class="comment">-- dump</span></span><br><span class="line"><span class="keyword">local</span> new_op = &#123;&#125;</span><br><span class="line"><span class="comment">-- 用目标 lua 和正常 lua 的 dump 数据对比</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">2</span>, #data <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">local</span> by_ori = <span class="built_in">string</span>.<span class="built_in">byte</span>(ori_data,i)</span><br><span class="line">	<span class="keyword">local</span> by_new = <span class="built_in">string</span>.<span class="built_in">byte</span>(data,i)</span><br><span class="line">	<span class="keyword">if</span> by_ori ~= by_new <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- 字节码被xor 0xff处理</span></span><br><span class="line">        <span class="keyword">local</span> op_name = ori_op_name[by_ori + <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">local</span> op_idx = by_new</span><br><span class="line">        <span class="comment">-- if by_ori&gt;47 then</span></span><br><span class="line">        <span class="comment">--     op_name = ori_op_name[(by_ori~0xff) + 1]</span></span><br><span class="line">        <span class="comment">--     op_idx = (by_new~0xff)</span></span><br><span class="line">        <span class="comment">-- end</span></span><br><span class="line">        <span class="keyword">if</span> op_name~=<span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">if</span> new_op[op_name]~=<span class="literal">nil</span> <span class="keyword">and</span> new_op[op_name]~=op_idx <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">print</span>(op_name,new_op[op_name])</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">		    new_op[op_name] = op_idx</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;old \t new \t name&quot;</span>)</span><br><span class="line"><span class="keyword">local</span> cnt=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> idx, op_name <span class="keyword">in</span> <span class="built_in">pairs</span>(ori_op_name) <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">local</span> tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">if</span> new_op[op_name] ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		tmp = new_op[op_name]</span><br><span class="line">        cnt=cnt+<span class="number">1</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="built_in">print</span>((idx - <span class="number">1</span>) .. <span class="string">&quot;\t&quot;</span> .. tmp .. <span class="string">&quot;\t&quot;</span> .. op_name )</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(cnt)</span><br></pre></td></tr></table></figure>

<p>将题目附件的<code>lua</code>重命名为<code>lua_problem</code>并复制到<code>Check_OpCode</code>文件夹中，同时将刚刚xor了字节的<code>lua-5.3.3/src/lua</code>也复制过来。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210303223220203.png"></p>
<p>P.S. 由于帖子中给出的<code>test.lua</code>与前文中最开始用到的lua文件重名，故以下<code>test.lua</code>均代表为帖子中的lua文件，前文中的<code>test.lua</code>不再被引用。</p>
<p>依次在WSL中运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./lua dump_test_luac.lua</span><br><span class="line">./lua_problem check_opcode.lua</span><br></pre></td></tr></table></figure>

<p>（然后发现写不出能覆盖所有字节码的<code>test()</code>，遂放弃该思路。</p>
<h3 id="自创思路"><a href="#自创思路" class="headerlink" title="自创思路"></a>自创思路</h3><p>我们知道在lua源码里，opcode是按顺序存放在<code>lopcodes.h</code>和<code>lopcodes.c</code>里的，故顺序魔改其实可以追踪lua解释器在ida中的反编译即可。（这里的<code>lua</code>就是题目给的那个。</p>
<p>源码中的opcode处：</p>
<p><img src="/p/wpFor-2020XCTF/image-20210304125916447.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210304125958675.png"></p>
<p>将<code>lua</code>加载进ida中，用<code>shift+F12</code>提取字符串，并用<code>ctrl+F</code>搜索“MOVE”</p>
<p><img src="/p/wpFor-2020XCTF/image-20210304130048988.png"></p>
<p>双击，按<code>x</code>找到交叉引用</p>
<p><img src="/p/wpFor-2020XCTF/image-20210304130133374.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210304130146457.png"></p>
<p>这里就是魔改后的opcode顺序！</p>
<p>那么我们现在就掌握了所有魔改的信息，开始恢复还原。</p>
<p>这里用到的是著名的lua反汇编&#x2F;反编译项目<a target="_blank" rel="noopener" href="https://github.com/viruscamp/luadec">viruscamp&#x2F;luadec: Lua Decompiler for lua 5.1 , 5.2 and 5.3</a>，由于lua解释器被魔改（xor 0xff和opcode顺序），所以我们需要在原安装步骤的基础上做些调整。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/viruscamp/luadec</span><br><span class="line">cd luadec</span><br><span class="line">git submodule update --init lua-5.3</span><br><span class="line">cd lua-5.3</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##### 此处在make之前需要调整源码！</span></span></span><br><span class="line">make linux</span><br><span class="line">cd ../luadec</span><br><span class="line">make LUAVER=5.3</span><br></pre></td></tr></table></figure>

<p>调整源码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* luadec/lua-5.3/src/lopcodes.h 原line165-232 */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">OP_MOVE,</span><br><span class="line">OP_LOADK,</span><br><span class="line">OP_LOADKX,</span><br><span class="line">OP_LOADBOOL,</span><br><span class="line">OP_LOADNIL,</span><br><span class="line">OP_GETUPVAL,</span><br><span class="line">OP_LT,</span><br><span class="line">OP_RETURN,</span><br><span class="line">OP_GETTABLE,</span><br><span class="line">OP_TESTSET,</span><br><span class="line">OP_SELF,</span><br><span class="line">OP_NEWTABLE,</span><br><span class="line">OP_LE,</span><br><span class="line">OP_ADD,</span><br><span class="line">OP_SUB,</span><br><span class="line">OP_MUL,</span><br><span class="line">OP_MOD,</span><br><span class="line">OP_POW,</span><br><span class="line">OP_DIV,</span><br><span class="line">OP_IDIV,</span><br><span class="line">OP_BAND,</span><br><span class="line">OP_BOR,</span><br><span class="line">OP_BXOR,</span><br><span class="line">OP_SHL,</span><br><span class="line">OP_SHR,</span><br><span class="line">OP_UNM,</span><br><span class="line">OP_BNOT,</span><br><span class="line">OP_NOT,</span><br><span class="line">OP_LEN,</span><br><span class="line">OP_GETTABUP,</span><br><span class="line">OP_JMP,</span><br><span class="line">OP_TEST,</span><br><span class="line">OP_SETTABUP,</span><br><span class="line">OP_TFORCALL,</span><br><span class="line">OP_FORPREP,</span><br><span class="line">OP_EXTRAARG,</span><br><span class="line">OP_CALL,</span><br><span class="line">OP_FORLOOP,</span><br><span class="line">OP_SETLIST,</span><br><span class="line">OP_CONCAT,</span><br><span class="line">OP_TAILCALL,</span><br><span class="line">OP_TFORLOOP,</span><br><span class="line">OP_VARARG,</span><br><span class="line">OP_SETTABLE,</span><br><span class="line">OP_SETUPVAL,</span><br><span class="line">OP_CLOSURE,</span><br><span class="line">OP_EQ,</span><br><span class="line">&#125; OpCode;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* luadec/lua-5.3/src/lopcodes.c 原line20-69 */</span></span><br><span class="line">LUAI_DDEF <span class="keyword">const</span> <span class="keyword">char</span> *<span class="keyword">const</span> luaP_opnames[NUM_OPCODES+<span class="number">1</span>] = &#123;</span><br><span class="line">  <span class="string">&quot;MOVE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LOADK&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LOADKX&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LOADBOOL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LOADNIL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;GETUPVAL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LT&quot;</span>,</span><br><span class="line">  <span class="string">&quot;RETURN&quot;</span>,</span><br><span class="line">  <span class="string">&quot;GETTABLE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TESTSET&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SELF&quot;</span>,</span><br><span class="line">  <span class="string">&quot;NEWTABLE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ADD&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SUB&quot;</span>,</span><br><span class="line">  <span class="string">&quot;MUL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;MOD&quot;</span>,</span><br><span class="line">  <span class="string">&quot;POW&quot;</span>,</span><br><span class="line">  <span class="string">&quot;DIV&quot;</span>,</span><br><span class="line">  <span class="string">&quot;IDIV&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BAND&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BOR&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BXOR&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SHL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SHR&quot;</span>,</span><br><span class="line">  <span class="string">&quot;UNM&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BNOT&quot;</span>,</span><br><span class="line">  <span class="string">&quot;NOT&quot;</span>,</span><br><span class="line">  <span class="string">&quot;LEN&quot;</span>,</span><br><span class="line">  <span class="string">&quot;GETTABUP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;JMP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TEST&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SETTABUP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TFORCALL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;FORPREP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;EXTRAARG&quot;</span>,</span><br><span class="line">  <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;FORLOOP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SETLIST&quot;</span>,</span><br><span class="line">  <span class="string">&quot;CONCAT&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TAILCALL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TFORLOOP&quot;</span>,</span><br><span class="line">  <span class="string">&quot;VARARG&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SETTABLE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SETUPVAL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;CLOSURE&quot;</span>,</span><br><span class="line">  <span class="string">&quot;EQ&quot;</span>,</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* luadec/lua-5.3/src/lundump.c 原line60-64 */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> lu_byte <span class="title">LoadByte</span> <span class="params">(LoadState *S)</span> </span>&#123;</span><br><span class="line">  lu_byte x;</span><br><span class="line">  LoadVar(S, x);</span><br><span class="line">  x^=<span class="number">0xff</span>;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* luadec/lua-5.3/src/Makefile 原line9 */</span></span><br><span class="line">CC= gcc -<span class="built_in">std</span>=gnu99 -m32</span><br><span class="line"><span class="comment">//因为题目所给的lua解释器为32位</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* luadec/luadec/Makefile 原line16 */</span></span><br><span class="line">CC= gcc -m32</span><br><span class="line"><span class="comment">//同上</span></span><br></pre></td></tr></table></figure>

<p>修改完源码后接着make。</p>
<p>走完流程后把<code>check_license_out.lua</code>的第一个字节改为<code>&quot;\x1b&quot;</code>，以对上LUA_SIGNATURE，并复制到<code>luadec/luadec</code>文件夹中。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210304133241178.png"></p>
<p>然后在<code>luadec/luadec</code>下运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./luadec -dis check_license_out.lua &gt; discheck</span><br></pre></td></tr></table></figure>

<p>（如wp所说，反编译会报错，只能反汇编，估计是乱魔改的原因哈哈哈哈。</p>
<p>得到反汇编的discheck。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br></pre></td><td class="code"><pre><span class="line">; Disassembled using luadec 2.2 rev: 895d923 for Lua 5.3 from https:&#x2F;&#x2F;github.com&#x2F;viruscamp&#x2F;luadec</span><br><span class="line">; Command line: -dis check_license_out.lua </span><br><span class="line"></span><br><span class="line">; Function:        0</span><br><span class="line">; Defined at line: 0</span><br><span class="line">; #Upvalues:       1</span><br><span class="line">; #Parameters:     0</span><br><span class="line">; Is_vararg:       2</span><br><span class="line">; Max Stack Size:  53</span><br><span class="line"></span><br><span class="line">    0 [-]: __eq      R0 0         ; R0 :&#x3D; closure(Function #0_0)</span><br><span class="line">    1 [-]: SETTABUP  U0 K0 R0     ; U0[&quot;to_v&quot;] :&#x3D; R0</span><br><span class="line">    2 [-]: NEWTABLE  R0 21 0      ; R0 :&#x3D; &#123;&#125; (size &#x3D; 21,0)</span><br><span class="line">    3 [-]: LOADK     R1 K1        ; R1 :&#x3D; 172</span><br><span class="line">    4 [-]: LOADK     R2 K2        ; R2 :&#x3D; 25</span><br><span class="line">    5 [-]: LOADK     R3 K3        ; R3 :&#x3D; 60</span><br><span class="line">    6 [-]: LOADK     R4 K4        ; R4 :&#x3D; 95</span><br><span class="line">    7 [-]: LOADK     R5 K5        ; R5 :&#x3D; 5</span><br><span class="line">    8 [-]: LOADK     R6 K6        ; R6 :&#x3D; 27</span><br><span class="line">    9 [-]: LOADK     R7 K7        ; R7 :&#x3D; 49</span><br><span class="line">   10 [-]: LOADK     R8 K8        ; R8 :&#x3D; 58</span><br><span class="line">   11 [-]: LOADK     R9 K9        ; R9 :&#x3D; 171</span><br><span class="line">   12 [-]: LOADK     R10 K5       ; R10 :&#x3D; 5</span><br><span class="line">   13 [-]: LOADK     R11 K10      ; R11 :&#x3D; 253</span><br><span class="line">   14 [-]: LOADK     R12 K11      ; R12 :&#x3D; 45</span><br><span class="line">   15 [-]: LOADK     R13 K12      ; R13 :&#x3D; 87</span><br><span class="line">   16 [-]: LOADK     R14 K13      ; R14 :&#x3D; 246</span><br><span class="line">   17 [-]: LOADK     R15 K14      ; R15 :&#x3D; 197</span><br><span class="line">   18 [-]: LOADK     R16 K15      ; R16 :&#x3D; 12</span><br><span class="line">   19 [-]: LOADK     R17 K16      ; R17 :&#x3D; 97</span><br><span class="line">   20 [-]: LOADK     R18 K17      ; R18 :&#x3D; 234</span><br><span class="line">   21 [-]: LOADK     R19 K18      ; R19 :&#x3D; 159</span><br><span class="line">   22 [-]: LOADK     R20 K19      ; R20 :&#x3D; 119</span><br><span class="line">   23 [-]: LOADK     R21 K20      ; R21 :&#x3D; 157</span><br><span class="line">   24 [-]: LOADK     R22 K21      ; R22 :&#x3D; 169</span><br><span class="line">   25 [-]: LOADK     R23 K22      ; R23 :&#x3D; 121</span><br><span class="line">   26 [-]: LOADK     R24 K23      ; R24 :&#x3D; 54</span><br><span class="line">   27 [-]: LOADK     R25 K24      ; R25 :&#x3D; 242</span><br><span class="line">   28 [-]: (null)    R0 25 1      ; R0[0] to R0[24] :&#x3D; R1 to R25 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;0, b&#x3D;25, c&#x3D;1, FPF&#x3D;50</span><br><span class="line">   29 [-]: NEWTABLE  R1 21 0      ; R1 :&#x3D; &#123;&#125; (size &#x3D; 21,0)</span><br><span class="line">   30 [-]: LOADK     R2 K25       ; R2 :&#x3D; 94</span><br><span class="line">   31 [-]: LOADK     R3 K26       ; R3 :&#x3D; 117</span><br><span class="line">   32 [-]: LOADK     R4 K27       ; R4 :&#x3D; 57</span><br><span class="line">   33 [-]: LOADK     R5 K28       ; R5 :&#x3D; 37</span><br><span class="line">   34 [-]: LOADK     R6 K23       ; R6 :&#x3D; 54</span><br><span class="line">   35 [-]: LOADK     R7 K29       ; R7 :&#x3D; 110</span><br><span class="line">   36 [-]: LOADK     R8 K30       ; R8 :&#x3D; 15</span><br><span class="line">   37 [-]: LOADK     R9 K31       ; R9 :&#x3D; 223</span><br><span class="line">   38 [-]: LOADK     R10 K32      ; R10 :&#x3D; 163</span><br><span class="line">   39 [-]: LOADK     R11 K33      ; R11 :&#x3D; 133</span><br><span class="line">   40 [-]: LOADK     R12 K34      ; R12 :&#x3D; 99</span><br><span class="line">   41 [-]: LOADK     R13 K35      ; R13 :&#x3D; 237</span><br><span class="line">   42 [-]: LOADK     R14 K36      ; R14 :&#x3D; 8</span><br><span class="line">   43 [-]: LOADK     R15 K37      ; R15 :&#x3D; 128</span><br><span class="line">   44 [-]: LOADK     R16 K6       ; R16 :&#x3D; 27</span><br><span class="line">   45 [-]: LOADK     R17 K23      ; R17 :&#x3D; 54</span><br><span class="line">   46 [-]: LOADK     R18 K38      ; R18 :&#x3D; 233</span><br><span class="line">   47 [-]: LOADK     R19 K39      ; R19 :&#x3D; 181</span><br><span class="line">   48 [-]: LOADK     R20 K24      ; R20 :&#x3D; 242</span><br><span class="line">   49 [-]: LOADK     R21 K40      ; R21 :&#x3D; 55</span><br><span class="line">   50 [-]: LOADK     R22 K41      ; R22 :&#x3D; 230</span><br><span class="line">   51 [-]: LOADK     R23 K42      ; R23 :&#x3D; 62</span><br><span class="line">   52 [-]: LOADK     R24 K43      ; R24 :&#x3D; 42</span><br><span class="line">   53 [-]: LOADK     R25 K44      ; R25 :&#x3D; 252</span><br><span class="line">   54 [-]: LOADK     R26 K45      ; R26 :&#x3D; 116</span><br><span class="line">   55 [-]: (null)    R1 25 1      ; R1[0] to R1[24] :&#x3D; R2 to R26 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;1, b&#x3D;25, c&#x3D;1, FPF&#x3D;50</span><br><span class="line">   56 [-]: NEWTABLE  R2 48 0      ; R2 :&#x3D; &#123;&#125; (size &#x3D; 48,0)</span><br><span class="line">   57 [-]: LOADK     R3 K46       ; R3 :&#x3D; 81</span><br><span class="line">   58 [-]: LOADK     R4 K47       ; R4 :&#x3D; 138</span><br><span class="line">   59 [-]: LOADK     R5 K48       ; R5 :&#x3D; 85</span><br><span class="line">   60 [-]: LOADK     R6 K49       ; R6 :&#x3D; 142</span><br><span class="line">   61 [-]: LOADK     R7 K50       ; R7 :&#x3D; 185</span><br><span class="line">   62 [-]: LOADK     R8 K51       ; R8 :&#x3D; 35</span><br><span class="line">   63 [-]: LOADK     R9 K52       ; R9 :&#x3D; 229</span><br><span class="line">   64 [-]: LOADK     R10 K53      ; R10 :&#x3D; 83</span><br><span class="line">   65 [-]: LOADK     R11 K36      ; R11 :&#x3D; 8</span><br><span class="line">   66 [-]: LOADK     R12 K54      ; R12 :&#x3D; 225</span><br><span class="line">   67 [-]: LOADK     R13 K55      ; R13 :&#x3D; 92</span><br><span class="line">   68 [-]: LOADK     R14 K31      ; R14 :&#x3D; 223</span><br><span class="line">   69 [-]: LOADK     R15 K56      ; R15 :&#x3D; 222</span><br><span class="line">   70 [-]: LOADK     R16 K57      ; R16 :&#x3D; 47</span><br><span class="line">   71 [-]: LOADK     R17 K58      ; R17 :&#x3D; 182</span><br><span class="line">   72 [-]: LOADK     R18 K59      ; R18 :&#x3D; 158</span><br><span class="line">   73 [-]: LOADK     R19 K60      ; R19 :&#x3D; 17</span><br><span class="line">   74 [-]: LOADK     R20 K61      ; R20 :&#x3D; 74</span><br><span class="line">   75 [-]: LOADK     R21 K62      ; R21 :&#x3D; 34</span><br><span class="line">   76 [-]: LOADK     R22 K63      ; R22 :&#x3D; 100</span><br><span class="line">   77 [-]: LOADK     R23 K64      ; R23 :&#x3D; 43</span><br><span class="line">   78 [-]: LOADK     R24 K65      ; R24 :&#x3D; 103</span><br><span class="line">   79 [-]: LOADK     R25 K66      ; R25 :&#x3D; 102</span><br><span class="line">   80 [-]: LOADK     R26 K67      ; R26 :&#x3D; 147</span><br><span class="line">   81 [-]: LOADK     R27 K35      ; R27 :&#x3D; 237</span><br><span class="line">   82 [-]: LOADK     R28 K68      ; R28 :&#x3D; 88</span><br><span class="line">   83 [-]: LOADK     R29 K69      ; R29 :&#x3D; 73</span><br><span class="line">   84 [-]: LOADK     R30 K70      ; R30 :&#x3D; 28</span><br><span class="line">   85 [-]: LOADK     R31 K71      ; R31 :&#x3D; 224</span><br><span class="line">   86 [-]: LOADK     R32 K72      ; R32 :&#x3D; 23</span><br><span class="line">   87 [-]: LOADK     R33 K73      ; R33 :&#x3D; 44</span><br><span class="line">   88 [-]: LOADK     R34 K74      ; R34 :&#x3D; 40</span><br><span class="line">   89 [-]: LOADK     R35 K75      ; R35 :&#x3D; 154</span><br><span class="line">   90 [-]: LOADK     R36 K76      ; R36 :&#x3D; 127</span><br><span class="line">   91 [-]: LOADK     R37 K77      ; R37 :&#x3D; 16</span><br><span class="line">   92 [-]: LOADK     R38 K21      ; R38 :&#x3D; 169</span><br><span class="line">   93 [-]: LOADK     R39 K78      ; R39 :&#x3D; 160</span><br><span class="line">   94 [-]: LOADK     R40 K79      ; R40 :&#x3D; 118</span><br><span class="line">   95 [-]: LOADK     R41 K80      ; R41 :&#x3D; 51</span><br><span class="line">   96 [-]: LOADK     R42 K81      ; R42 :&#x3D; 194</span><br><span class="line">   97 [-]: LOADK     R43 K82      ; R43 :&#x3D; 31</span><br><span class="line">   98 [-]: LOADK     R44 K83      ; R44 :&#x3D; 68</span><br><span class="line">   99 [-]: LOADK     R45 K84      ; R45 :&#x3D; 89</span><br><span class="line">  100 [-]: LOADK     R46 K85      ; R46 :&#x3D; 65</span><br><span class="line">  101 [-]: LOADK     R47 K86      ; R47 :&#x3D; 162</span><br><span class="line">  102 [-]: LOADK     R48 K87      ; R48 :&#x3D; 13</span><br><span class="line">  103 [-]: LOADK     R49 K88      ; R49 :&#x3D; 141</span><br><span class="line">  104 [-]: LOADK     R50 K89      ; R50 :&#x3D; 0</span><br><span class="line">  105 [-]: LOADK     R51 K90      ; R51 :&#x3D; 244</span><br><span class="line">  106 [-]: LOADK     R52 K19      ; R52 :&#x3D; 119</span><br><span class="line">  107 [-]: (null)    R2 50 1      ; R2[0] to R2[49] :&#x3D; R3 to R52 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;50, c&#x3D;1, FPF&#x3D;50</span><br><span class="line">  108 [-]: LOADK     R3 K91       ; R3 :&#x3D; 161</span><br><span class="line">  109 [-]: LOADK     R4 K92       ; R4 :&#x3D; 198</span><br><span class="line">  110 [-]: LOADK     R5 K93       ; R5 :&#x3D; 228</span><br><span class="line">  111 [-]: LOADK     R6 K4        ; R6 :&#x3D; 95</span><br><span class="line">  112 [-]: LOADK     R7 K94       ; R7 :&#x3D; 10</span><br><span class="line">  113 [-]: LOADK     R8 K95       ; R8 :&#x3D; 78</span><br><span class="line">  114 [-]: LOADK     R9 K28       ; R9 :&#x3D; 37</span><br><span class="line">  115 [-]: LOADK     R10 K22      ; R10 :&#x3D; 121</span><br><span class="line">  116 [-]: LOADK     R11 K96      ; R11 :&#x3D; 236</span><br><span class="line">  117 [-]: LOADK     R12 K97      ; R12 :&#x3D; 59</span><br><span class="line">  118 [-]: LOADK     R13 K3       ; R13 :&#x3D; 60</span><br><span class="line">  119 [-]: LOADK     R14 K98      ; R14 :&#x3D; 91</span><br><span class="line">  120 [-]: LOADK     R15 K99      ; R15 :&#x3D; 146</span><br><span class="line">  121 [-]: LOADK     R16 K100     ; R16 :&#x3D; 46</span><br><span class="line">  122 [-]: LOADK     R17 K101     ; R17 :&#x3D; 77</span><br><span class="line">  123 [-]: LOADK     R18 K102     ; R18 :&#x3D; 218</span><br><span class="line">  124 [-]: LOADK     R19 K103     ; R19 :&#x3D; 66</span><br><span class="line">  125 [-]: LOADK     R20 K104     ; R20 :&#x3D; 200</span><br><span class="line">  126 [-]: LOADK     R21 K105     ; R21 :&#x3D; 61</span><br><span class="line">  127 [-]: LOADK     R22 K106     ; R22 :&#x3D; 241</span><br><span class="line">  128 [-]: LOADK     R23 K107     ; R23 :&#x3D; 70</span><br><span class="line">  129 [-]: LOADK     R24 K40      ; R24 :&#x3D; 55</span><br><span class="line">  130 [-]: LOADK     R25 K108     ; R25 :&#x3D; 39</span><br><span class="line">  131 [-]: LOADK     R26 K109     ; R26 :&#x3D; 227</span><br><span class="line">  132 [-]: LOADK     R27 K43      ; R27 :&#x3D; 42</span><br><span class="line">  133 [-]: LOADK     R28 K110     ; R28 :&#x3D; 2</span><br><span class="line">  134 [-]: LOADK     R29 K111     ; R29 :&#x3D; 231</span><br><span class="line">  135 [-]: LOADK     R30 K112     ; R30 :&#x3D; 235</span><br><span class="line">  136 [-]: LOADK     R31 K113     ; R31 :&#x3D; 122</span><br><span class="line">  137 [-]: LOADK     R32 K114     ; R32 :&#x3D; 135</span><br><span class="line">  138 [-]: LOADK     R33 K115     ; R33 :&#x3D; 152</span><br><span class="line">  139 [-]: LOADK     R34 K116     ; R34 :&#x3D; 137</span><br><span class="line">  140 [-]: LOADK     R35 K117     ; R35 :&#x3D; 173</span><br><span class="line">  141 [-]: LOADK     R36 K118     ; R36 :&#x3D; 232</span><br><span class="line">  142 [-]: LOADK     R37 K119     ; R37 :&#x3D; 101</span><br><span class="line">  143 [-]: LOADK     R38 K120     ; R38 :&#x3D; 75</span><br><span class="line">  144 [-]: LOADK     R39 K38      ; R39 :&#x3D; 233</span><br><span class="line">  145 [-]: LOADK     R40 K121     ; R40 :&#x3D; 21</span><br><span class="line">  146 [-]: LOADK     R41 K44      ; R41 :&#x3D; 252</span><br><span class="line">  147 [-]: LOADK     R42 K30      ; R42 :&#x3D; 15</span><br><span class="line">  148 [-]: LOADK     R43 K33      ; R43 :&#x3D; 133</span><br><span class="line">  149 [-]: LOADK     R44 K122     ; R44 :&#x3D; 111</span><br><span class="line">  150 [-]: LOADK     R45 K123     ; R45 :&#x3D; 205</span><br><span class="line">  151 [-]: LOADK     R46 K27      ; R46 :&#x3D; 57</span><br><span class="line">  152 [-]: LOADK     R47 K124     ; R47 :&#x3D; 132</span><br><span class="line">  153 [-]: LOADK     R48 K125     ; R48 :&#x3D; 187</span><br><span class="line">  154 [-]: LOADK     R49 K126     ; R49 :&#x3D; 96</span><br><span class="line">  155 [-]: LOADK     R50 K7       ; R50 :&#x3D; 49</span><br><span class="line">  156 [-]: LOADK     R51 K127     ; R51 :&#x3D; 124</span><br><span class="line">  157 [-]: LOADK     R52 K128     ; R52 :&#x3D; 86</span><br><span class="line">  158 [-]: (null)    R2 50 2      ; R2[50] to R2[99] :&#x3D; R3 to R52 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;50, c&#x3D;2, FPF&#x3D;50</span><br><span class="line">  159 [-]: LOADK     R3 K129      ; R3 :&#x3D; 19</span><br><span class="line">  160 [-]: LOADK     R4 K130      ; R4 :&#x3D; 188</span><br><span class="line">  161 [-]: LOADK     R5 K131      ; R5 :&#x3D; 80</span><br><span class="line">  162 [-]: LOADK     R6 K132      ; R6 :&#x3D; 213</span><br><span class="line">  163 [-]: LOADK     R7 K133      ; R7 :&#x3D; 106</span><br><span class="line">  164 [-]: LOADK     R8 K134      ; R8 :&#x3D; 214</span><br><span class="line">  165 [-]: LOADK     R9 K135      ; R9 :&#x3D; 203</span><br><span class="line">  166 [-]: LOADK     R10 K136     ; R10 :&#x3D; 177</span><br><span class="line">  167 [-]: LOADK     R11 K137     ; R11 :&#x3D; 56</span><br><span class="line">  168 [-]: LOADK     R12 K138     ; R12 :&#x3D; 104</span><br><span class="line">  169 [-]: LOADK     R13 K139     ; R13 :&#x3D; 82</span><br><span class="line">  170 [-]: LOADK     R14 K29      ; R14 :&#x3D; 110</span><br><span class="line">  171 [-]: LOADK     R15 K140     ; R15 :&#x3D; 196</span><br><span class="line">  172 [-]: LOADK     R16 K141     ; R16 :&#x3D; 113</span><br><span class="line">  173 [-]: LOADK     R17 K142     ; R17 :&#x3D; 155</span><br><span class="line">  174 [-]: LOADK     R18 K143     ; R18 :&#x3D; 170</span><br><span class="line">  175 [-]: LOADK     R19 K144     ; R19 :&#x3D; 150</span><br><span class="line">  176 [-]: LOADK     R20 K26      ; R20 :&#x3D; 117</span><br><span class="line">  177 [-]: LOADK     R21 K145     ; R21 :&#x3D; 26</span><br><span class="line">  178 [-]: LOADK     R22 K146     ; R22 :&#x3D; 140</span><br><span class="line">  179 [-]: LOADK     R23 K147     ; R23 :&#x3D; 144</span><br><span class="line">  180 [-]: LOADK     R24 K148     ; R24 :&#x3D; 11</span><br><span class="line">  181 [-]: LOADK     R25 K1       ; R25 :&#x3D; 172</span><br><span class="line">  182 [-]: LOADK     R26 K149     ; R26 :&#x3D; 67</span><br><span class="line">  183 [-]: LOADK     R27 K150     ; R27 :&#x3D; 209</span><br><span class="line">  184 [-]: LOADK     R28 K151     ; R28 :&#x3D; 125</span><br><span class="line">  185 [-]: LOADK     R29 K23      ; R29 :&#x3D; 54</span><br><span class="line">  186 [-]: LOADK     R30 K8       ; R30 :&#x3D; 58</span><br><span class="line">  187 [-]: LOADK     R31 K37      ; R31 :&#x3D; 128</span><br><span class="line">  188 [-]: LOADK     R32 K152     ; R32 :&#x3D; 204</span><br><span class="line">  189 [-]: LOADK     R33 K153     ; R33 :&#x3D; 186</span><br><span class="line">  190 [-]: LOADK     R34 K154     ; R34 :&#x3D; 199</span><br><span class="line">  191 [-]: LOADK     R35 K155     ; R35 :&#x3D; 189</span><br><span class="line">  192 [-]: LOADK     R36 K156     ; R36 :&#x3D; 208</span><br><span class="line">  193 [-]: LOADK     R37 K157     ; R37 :&#x3D; 239</span><br><span class="line">  194 [-]: LOADK     R38 K158     ; R38 :&#x3D; 143</span><br><span class="line">  195 [-]: LOADK     R39 K159     ; R39 :&#x3D; 249</span><br><span class="line">  196 [-]: LOADK     R40 K13      ; R40 :&#x3D; 246</span><br><span class="line">  197 [-]: LOADK     R41 K160     ; R41 :&#x3D; 1</span><br><span class="line">  198 [-]: LOADK     R42 K161     ; R42 :&#x3D; 139</span><br><span class="line">  199 [-]: LOADK     R43 K162     ; R43 :&#x3D; 33</span><br><span class="line">  200 [-]: LOADK     R44 K12      ; R44 :&#x3D; 87</span><br><span class="line">  201 [-]: LOADK     R45 K163     ; R45 :&#x3D; 64</span><br><span class="line">  202 [-]: LOADK     R46 K45      ; R46 :&#x3D; 116</span><br><span class="line">  203 [-]: LOADK     R47 K164     ; R47 :&#x3D; 84</span><br><span class="line">  204 [-]: LOADK     R48 K165     ; R48 :&#x3D; 254</span><br><span class="line">  205 [-]: LOADK     R49 K166     ; R49 :&#x3D; 126</span><br><span class="line">  206 [-]: LOADK     R50 K167     ; R50 :&#x3D; 202</span><br><span class="line">  207 [-]: LOADK     R51 K168     ; R51 :&#x3D; 148</span><br><span class="line">  208 [-]: LOADK     R52 K169     ; R52 :&#x3D; 76</span><br><span class="line">  209 [-]: (null)    R2 50 3      ; R2[100] to R2[149] :&#x3D; R3 to R52 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;50, c&#x3D;3, FPF&#x3D;50</span><br><span class="line">  210 [-]: LOADK     R3 K170      ; R3 :&#x3D; 247</span><br><span class="line">  211 [-]: LOADK     R4 K171      ; R4 :&#x3D; 115</span><br><span class="line">  212 [-]: LOADK     R5 K172      ; R5 :&#x3D; 109</span><br><span class="line">  213 [-]: LOADK     R6 K173      ; R6 :&#x3D; 3</span><br><span class="line">  214 [-]: LOADK     R7 K174      ; R7 :&#x3D; 238</span><br><span class="line">  215 [-]: LOADK     R8 K175      ; R8 :&#x3D; 114</span><br><span class="line">  216 [-]: LOADK     R9 K176      ; R9 :&#x3D; 156</span><br><span class="line">  217 [-]: LOADK     R10 K177     ; R10 :&#x3D; 195</span><br><span class="line">  218 [-]: LOADK     R11 K32      ; R11 :&#x3D; 163</span><br><span class="line">  219 [-]: LOADK     R12 K18      ; R12 :&#x3D; 159</span><br><span class="line">  220 [-]: LOADK     R13 K178     ; R13 :&#x3D; 52</span><br><span class="line">  221 [-]: LOADK     R14 K179     ; R14 :&#x3D; 36</span><br><span class="line">  222 [-]: LOADK     R15 K180     ; R15 :&#x3D; 245</span><br><span class="line">  223 [-]: LOADK     R16 K181     ; R16 :&#x3D; 240</span><br><span class="line">  224 [-]: LOADK     R17 K182     ; R17 :&#x3D; 63</span><br><span class="line">  225 [-]: LOADK     R18 K183     ; R18 :&#x3D; 153</span><br><span class="line">  226 [-]: LOADK     R19 K184     ; R19 :&#x3D; 166</span><br><span class="line">  227 [-]: LOADK     R20 K185     ; R20 :&#x3D; 167</span><br><span class="line">  228 [-]: LOADK     R21 K186     ; R21 :&#x3D; 175</span><br><span class="line">  229 [-]: LOADK     R22 K187     ; R22 :&#x3D; 9</span><br><span class="line">  230 [-]: LOADK     R23 K188     ; R23 :&#x3D; 151</span><br><span class="line">  231 [-]: LOADK     R24 K9       ; R24 :&#x3D; 171</span><br><span class="line">  232 [-]: LOADK     R25 K189     ; R25 :&#x3D; 216</span><br><span class="line">  233 [-]: LOADK     R26 K190     ; R26 :&#x3D; 207</span><br><span class="line">  234 [-]: LOADK     R27 K191     ; R27 :&#x3D; 179</span><br><span class="line">  235 [-]: LOADK     R28 K192     ; R28 :&#x3D; 72</span><br><span class="line">  236 [-]: LOADK     R29 K193     ; R29 :&#x3D; 176</span><br><span class="line">  237 [-]: LOADK     R30 K194     ; R30 :&#x3D; 48</span><br><span class="line">  238 [-]: LOADK     R31 K195     ; R31 :&#x3D; 178</span><br><span class="line">  239 [-]: LOADK     R32 K20      ; R32 :&#x3D; 157</span><br><span class="line">  240 [-]: LOADK     R33 K196     ; R33 :&#x3D; 20</span><br><span class="line">  241 [-]: LOADK     R34 K39      ; R34 :&#x3D; 181</span><br><span class="line">  242 [-]: LOADK     R35 K197     ; R35 :&#x3D; 149</span><br><span class="line">  243 [-]: LOADK     R36 K198     ; R36 :&#x3D; 53</span><br><span class="line">  244 [-]: LOADK     R37 K199     ; R37 :&#x3D; 184</span><br><span class="line">  245 [-]: LOADK     R38 K200     ; R38 :&#x3D; 4</span><br><span class="line">  246 [-]: LOADK     R39 K201     ; R39 :&#x3D; 136</span><br><span class="line">  247 [-]: LOADK     R40 K202     ; R40 :&#x3D; 165</span><br><span class="line">  248 [-]: LOADK     R41 K203     ; R41 :&#x3D; 217</span><br><span class="line">  249 [-]: LOADK     R42 K204     ; R42 :&#x3D; 50</span><br><span class="line">  250 [-]: LOADK     R43 K205     ; R43 :&#x3D; 190</span><br><span class="line">  251 [-]: LOADK     R44 K206     ; R44 :&#x3D; 191</span><br><span class="line">  252 [-]: LOADK     R45 K207     ; R45 :&#x3D; 192</span><br><span class="line">  253 [-]: LOADK     R46 K208     ; R46 :&#x3D; 193</span><br><span class="line">  254 [-]: LOADK     R47 K209     ; R47 :&#x3D; 98</span><br><span class="line">  255 [-]: LOADK     R48 K210     ; R48 :&#x3D; 215</span><br><span class="line">  256 [-]: LOADK     R49 K42      ; R49 :&#x3D; 62</span><br><span class="line">  257 [-]: LOADK     R50 K211     ; R50 :&#x3D; 112</span><br><span class="line">  258 [-]: LOADK     R51 K212     ; R51 :&#x3D; 38</span><br><span class="line">  259 [-]: LOADK     R52 K213     ; R52 :&#x3D; 90</span><br><span class="line">  260 [-]: (null)    R2 50 4      ; R2[150] to R2[199] :&#x3D; R3 to R52 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;50, c&#x3D;4, FPF&#x3D;50</span><br><span class="line">  261 [-]: LOADK     R3 K214      ; R3 :&#x3D; 123</span><br><span class="line">  262 [-]: LOADK     R4 K215      ; R4 :&#x3D; 105</span><br><span class="line">  263 [-]: LOADK     R5 K25       ; R5 :&#x3D; 94</span><br><span class="line">  264 [-]: LOADK     R6 K216      ; R6 :&#x3D; 221</span><br><span class="line">  265 [-]: LOADK     R7 K34       ; R7 :&#x3D; 99</span><br><span class="line">  266 [-]: LOADK     R8 K217      ; R8 :&#x3D; 201</span><br><span class="line">  267 [-]: LOADK     R9 K218      ; R9 :&#x3D; 206</span><br><span class="line">  268 [-]: LOADK     R10 K219     ; R10 :&#x3D; 251</span><br><span class="line">  269 [-]: LOADK     R11 K220     ; R11 :&#x3D; 14</span><br><span class="line">  270 [-]: LOADK     R12 K221     ; R12 :&#x3D; 211</span><br><span class="line">  271 [-]: LOADK     R13 K222     ; R13 :&#x3D; 220</span><br><span class="line">  272 [-]: LOADK     R14 K223     ; R14 :&#x3D; 131</span><br><span class="line">  273 [-]: LOADK     R15 K224     ; R15 :&#x3D; 212</span><br><span class="line">  274 [-]: LOADK     R16 K225     ; R16 :&#x3D; 130</span><br><span class="line">  275 [-]: LOADK     R17 K226     ; R17 :&#x3D; 134</span><br><span class="line">  276 [-]: LOADK     R18 K10      ; R18 :&#x3D; 253</span><br><span class="line">  277 [-]: LOADK     R19 K227     ; R19 :&#x3D; 120</span><br><span class="line">  278 [-]: LOADK     R20 K228     ; R20 :&#x3D; 145</span><br><span class="line">  279 [-]: LOADK     R21 K229     ; R21 :&#x3D; 18</span><br><span class="line">  280 [-]: LOADK     R22 K230     ; R22 :&#x3D; 219</span><br><span class="line">  281 [-]: LOADK     R23 K231     ; R23 :&#x3D; 79</span><br><span class="line">  282 [-]: LOADK     R24 K232     ; R24 :&#x3D; 129</span><br><span class="line">  283 [-]: LOADK     R25 K15      ; R25 :&#x3D; 12</span><br><span class="line">  284 [-]: LOADK     R26 K233     ; R26 :&#x3D; 93</span><br><span class="line">  285 [-]: LOADK     R27 K5       ; R27 :&#x3D; 5</span><br><span class="line">  286 [-]: LOADK     R28 K234     ; R28 :&#x3D; 183</span><br><span class="line">  287 [-]: LOADK     R29 K235     ; R29 :&#x3D; 107</span><br><span class="line">  288 [-]: LOADK     R30 K236     ; R30 :&#x3D; 71</span><br><span class="line">  289 [-]: LOADK     R31 K237     ; R31 :&#x3D; 226</span><br><span class="line">  290 [-]: LOADK     R32 K238     ; R32 :&#x3D; 180</span><br><span class="line">  291 [-]: LOADK     R33 K239     ; R33 :&#x3D; 24</span><br><span class="line">  292 [-]: LOADK     R34 K17      ; R34 :&#x3D; 234</span><br><span class="line">  293 [-]: LOADK     R35 K240     ; R35 :&#x3D; 7</span><br><span class="line">  294 [-]: LOADK     R36 K241     ; R36 :&#x3D; 108</span><br><span class="line">  295 [-]: LOADK     R37 K242     ; R37 :&#x3D; 174</span><br><span class="line">  296 [-]: LOADK     R38 K243     ; R38 :&#x3D; 6</span><br><span class="line">  297 [-]: LOADK     R39 K11      ; R39 :&#x3D; 45</span><br><span class="line">  298 [-]: LOADK     R40 K244     ; R40 :&#x3D; 29</span><br><span class="line">  299 [-]: LOADK     R41 K245     ; R41 :&#x3D; 32</span><br><span class="line">  300 [-]: LOADK     R42 K246     ; R42 :&#x3D; 168</span><br><span class="line">  301 [-]: LOADK     R43 K41      ; R43 :&#x3D; 230</span><br><span class="line">  302 [-]: LOADK     R44 K14      ; R44 :&#x3D; 197</span><br><span class="line">  303 [-]: LOADK     R45 K247     ; R45 :&#x3D; 41</span><br><span class="line">  304 [-]: LOADK     R46 K2       ; R46 :&#x3D; 25</span><br><span class="line">  305 [-]: LOADK     R47 K248     ; R47 :&#x3D; 255</span><br><span class="line">  306 [-]: LOADK     R48 K249     ; R48 :&#x3D; 164</span><br><span class="line">  307 [-]: LOADK     R49 K6       ; R49 :&#x3D; 27</span><br><span class="line">  308 [-]: LOADK     R50 K250     ; R50 :&#x3D; 210</span><br><span class="line">  309 [-]: LOADK     R51 K251     ; R51 :&#x3D; 248</span><br><span class="line">  310 [-]: LOADK     R52 K16      ; R52 :&#x3D; 97</span><br><span class="line">  311 [-]: (null)    R2 50 5      ; R2[200] to R2[249] :&#x3D; R3 to R52 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;50, c&#x3D;5, FPF&#x3D;50</span><br><span class="line">  312 [-]: LOADK     R3 K252      ; R3 :&#x3D; 250</span><br><span class="line">  313 [-]: LOADK     R4 K253      ; R4 :&#x3D; 22</span><br><span class="line">  314 [-]: LOADK     R5 K24       ; R5 :&#x3D; 242</span><br><span class="line">  315 [-]: LOADK     R6 K254      ; R6 :&#x3D; 243</span><br><span class="line">  316 [-]: LOADK     R7 K255      ; R7 :&#x3D; 30</span><br><span class="line">  317 [-]: LOADK     R8 K256      ; R8 :&#x3D; 69</span><br><span class="line">  318 [-]: (null)    R2 6 6       ; R2[250] to R2[255] :&#x3D; R3 to R8 ; R(a)[(c-1)*FPF+i] :&#x3D; R(a+i), 1 &lt;&#x3D; i &lt;&#x3D; b, a&#x3D;2, b&#x3D;6, c&#x3D;6, FPF&#x3D;50</span><br><span class="line">  319 [-]: LOADK     R3 K257      ; R3 :&#x3D; &quot;encrypt&quot;</span><br><span class="line">  320 [-]: __eq      R4 1         ; R4 :&#x3D; closure(Function #0_1)</span><br><span class="line">  321 [-]: SETTABUP  U0 R3 R4     ; U0[R3] :&#x3D; R4</span><br><span class="line">  322 [-]: LOADK     R3 K258      ; R3 :&#x3D; &quot;check_license&quot;</span><br><span class="line">  323 [-]: __eq      R4 2         ; R4 :&#x3D; closure(Function #0_2)</span><br><span class="line">  324 [-]: SETTABUP  U0 R3 R4     ; U0[R3] :&#x3D; R4</span><br><span class="line">  325 [-]: LOADK     R3 K259      ; R3 :&#x3D; &quot;io&quot;</span><br><span class="line">  326 [-]: GETTABUP  R3 U0 R3     ; R3 :&#x3D; U0[R3]</span><br><span class="line">  327 [-]: LOADK     R4 K260      ; R4 :&#x3D; &quot;write&quot;</span><br><span class="line">  328 [-]: GETTABLE  R3 R3 R4     ; R3 :&#x3D; R3[R4]</span><br><span class="line">  329 [-]: LOADK     R4 K261      ; R4 :&#x3D; &quot;input: &quot;</span><br><span class="line">  330 [-]: CALL      R3 2 1       ;  :&#x3D; R3(R4)</span><br><span class="line">  331 [-]: LOADK     R3 K262      ; R3 :&#x3D; &quot;license&quot;</span><br><span class="line">  332 [-]: LOADK     R4 K259      ; R4 :&#x3D; &quot;io&quot;</span><br><span class="line">  333 [-]: GETTABUP  R4 U0 R4     ; R4 :&#x3D; U0[R4]</span><br><span class="line">  334 [-]: LOADK     R5 K263      ; R5 :&#x3D; &quot;read&quot;</span><br><span class="line">  335 [-]: GETTABLE  R4 R4 R5     ; R4 :&#x3D; R4[R5]</span><br><span class="line">  336 [-]: LOADK     R5 K264      ; R5 :&#x3D; &quot;*l&quot;</span><br><span class="line">  337 [-]: CALL      R4 2 2       ; R4 :&#x3D; R4(R5)</span><br><span class="line">  338 [-]: SETTABUP  U0 R3 R4     ; U0[R3] :&#x3D; R4</span><br><span class="line">  339 [-]: LOADK     R3 K258      ; R3 :&#x3D; &quot;check_license&quot;</span><br><span class="line">  340 [-]: GETTABUP  R3 U0 R3     ; R3 :&#x3D; U0[R3]</span><br><span class="line">  341 [-]: LOADK     R4 K262      ; R4 :&#x3D; &quot;license&quot;</span><br><span class="line">  342 [-]: GETTABUP  R4 U0 R4     ; R4 :&#x3D; U0[R4]</span><br><span class="line">  343 [-]: CALL      R3 2 1       ;  :&#x3D; R3(R4)</span><br><span class="line">  344 [-]: RETURN    R0 1         ; return </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; Function:        0_0</span><br><span class="line">; Defined at line: 2</span><br><span class="line">; #Upvalues:       1</span><br><span class="line">; #Parameters:     1</span><br><span class="line">; Is_vararg:       0</span><br><span class="line">; Max Stack Size:  10</span><br><span class="line"></span><br><span class="line">    0 [-]: NEWTABLE  R1 0 0       ; R1 :&#x3D; &#123;&#125; (size &#x3D; 0,0)</span><br><span class="line">    1 [-]: LOADK     R2 K0        ; R2 :&#x3D; 1</span><br><span class="line">    2 [-]: GETTABUP  R3 U0 K1     ; R3 :&#x3D; U0[&quot;string&quot;]</span><br><span class="line">    3 [-]: GETTABLE  R3 R3 K2     ; R3 :&#x3D; R3[&quot;len&quot;]</span><br><span class="line">    4 [-]: MOVE      R4 R0        ; R4 :&#x3D; R0</span><br><span class="line">    5 [-]: CALL      R3 2 2       ; R3 :&#x3D; R3(R4)</span><br><span class="line">    6 [-]: LOADK     R4 K0        ; R4 :&#x3D; 1</span><br><span class="line">    7 [-]: FORPREP   R2 8         ; R2 -&#x3D; R4; pc +&#x3D; 8 (goto 16)</span><br><span class="line">    8 [-]: LEN       R6 R1        ; R6 :&#x3D; #R1</span><br><span class="line">    9 [-]: ADD       R6 R6 K0     ; R6 :&#x3D; R6 + 1</span><br><span class="line">   10 [-]: GETTABUP  R7 U0 K1     ; R7 :&#x3D; U0[&quot;string&quot;]</span><br><span class="line">   11 [-]: GETTABLE  R7 R7 K3     ; R7 :&#x3D; R7[&quot;byte&quot;]</span><br><span class="line">   12 [-]: MOVE      R8 R0        ; R8 :&#x3D; R0</span><br><span class="line">   13 [-]: MOVE      R9 R5        ; R9 :&#x3D; R5</span><br><span class="line">   14 [-]: CALL      R7 3 2       ; R7 :&#x3D; R7(R8 to R9)</span><br><span class="line">   15 [-]: __mode    R1 R6 R7     ; R1[R6] :&#x3D; R7</span><br><span class="line">   16 [-]: (null)    R2 -9        ; R2 +&#x3D; R4; if R2 &lt;&#x3D; R3 then R5 :&#x3D; R2; PC +&#x3D; -9 , goto 8 end</span><br><span class="line">   17 [-]: RETURN    R1 2         ; return R1</span><br><span class="line">   18 [-]: RETURN    R0 1         ; return </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; Function:        0_1</span><br><span class="line">; Defined at line: 15</span><br><span class="line">; #Upvalues:       4</span><br><span class="line">; #Parameters:     1</span><br><span class="line">; Is_vararg:       0</span><br><span class="line">; Max Stack Size:  10</span><br><span class="line"></span><br><span class="line">    0 [-]: GETTABUP  R1 U0 K0     ; R1 :&#x3D; U0[&quot;to_v&quot;]</span><br><span class="line">    1 [-]: MOVE      R2 R0        ; R2 :&#x3D; R0</span><br><span class="line">    2 [-]: CALL      R1 2 2       ; R1 :&#x3D; R1(R2)</span><br><span class="line">    3 [-]: NEWTABLE  R2 0 0       ; R2 :&#x3D; &#123;&#125; (size &#x3D; 0,0)</span><br><span class="line">    4 [-]: LOADK     R3 K1        ; R3 :&#x3D; 1</span><br><span class="line">    5 [-]: LEN       R4 R1        ; R4 :&#x3D; #R1</span><br><span class="line">    6 [-]: LOADK     R5 K1        ; R5 :&#x3D; 1</span><br><span class="line">    7 [-]: FORPREP   R3 10        ; R3 -&#x3D; R5; pc +&#x3D; 10 (goto 18)</span><br><span class="line">    8 [-]: GETTABLE  R7 R1 R6     ; R7 :&#x3D; R1[R6]</span><br><span class="line">    9 [-]: GETTABUP  R8 U1 R6     ; R8 :&#x3D; U1[R6]</span><br><span class="line">   10 [-]: BXOR      R7 R7 R8     ; R7 :&#x3D; R7 ~ R8</span><br><span class="line">   11 [-]: __mode    R1 R6 R7     ; R1[R6] :&#x3D; R7</span><br><span class="line">   12 [-]: LEN       R7 R2        ; R7 :&#x3D; #R2</span><br><span class="line">   13 [-]: ADD       R7 R7 K1     ; R7 :&#x3D; R7 + 1</span><br><span class="line">   14 [-]: GETTABLE  R8 R1 R6     ; R8 :&#x3D; R1[R6]</span><br><span class="line">   15 [-]: ADD       R8 R8 K1     ; R8 :&#x3D; R8 + 1</span><br><span class="line">   16 [-]: GETTABUP  R8 U2 R8     ; R8 :&#x3D; U2[R8]</span><br><span class="line">   17 [-]: __mode    R2 R7 R8     ; R2[R7] :&#x3D; R8</span><br><span class="line">   18 [-]: (null)    R3 -11       ; R3 +&#x3D; R5; if R3 &lt;&#x3D; R4 then R6 :&#x3D; R3; PC +&#x3D; -11 , goto 8 end</span><br><span class="line">   19 [-]: LOADK     R3 K2        ; R3 :&#x3D; 0</span><br><span class="line">   20 [-]: LOADK     R4 K1        ; R4 :&#x3D; 1</span><br><span class="line">   21 [-]: LEN       R5 R1        ; R5 :&#x3D; #R1</span><br><span class="line">   22 [-]: LOADK     R6 K1        ; R6 :&#x3D; 1</span><br><span class="line">   23 [-]: FORPREP   R4 7         ; R4 -&#x3D; R6; pc +&#x3D; 7 (goto 31)</span><br><span class="line">   24 [-]: GETTABLE  R8 R2 R7     ; R8 :&#x3D; R2[R7]</span><br><span class="line">   25 [-]: GETTABUP  R9 U3 R7     ; R9 :&#x3D; U3[R7]</span><br><span class="line">   26 [-]: __add     0 R8 R9      ; if R8 &#x3D;&#x3D; R9 then goto 28 else goto 30</span><br><span class="line">   27 [-]: JMP       R0 2         ; PC +&#x3D; 2 (goto 30)</span><br><span class="line">   28 [-]: ADD       R3 R3 K1     ; R3 :&#x3D; R3 + 1</span><br><span class="line">   29 [-]: JMP       R0 1         ; PC +&#x3D; 1 (goto 31)</span><br><span class="line">   30 [-]: ADD       R3 R3 K3     ; R3 :&#x3D; R3 + 2</span><br><span class="line">   31 [-]: (null)    R4 -8        ; R4 +&#x3D; R6; if R4 &lt;&#x3D; R5 then R7 :&#x3D; R4; PC +&#x3D; -8 , goto 24 end</span><br><span class="line">   32 [-]: LEN       R4 R1        ; R4 :&#x3D; #R1</span><br><span class="line">   33 [-]: __add     1 R3 R4      ; if R3 ~&#x3D; R4 then goto 35 else goto 39</span><br><span class="line">   34 [-]: JMP       R0 4         ; PC +&#x3D; 4 (goto 39)</span><br><span class="line">   35 [-]: GETTABUP  R4 U0 K4     ; R4 :&#x3D; U0[&quot;print&quot;]</span><br><span class="line">   36 [-]: LOADK     R5 K5        ; R5 :&#x3D; &quot;bad&quot;</span><br><span class="line">   37 [-]: CALL      R4 2 1       ;  :&#x3D; R4(R5)</span><br><span class="line">   38 [-]: JMP       R0 3         ; PC +&#x3D; 3 (goto 42)</span><br><span class="line">   39 [-]: GETTABUP  R4 U0 K4     ; R4 :&#x3D; U0[&quot;print&quot;]</span><br><span class="line">   40 [-]: LOADK     R5 K6        ; R5 :&#x3D; &quot;good&quot;</span><br><span class="line">   41 [-]: CALL      R4 2 1       ;  :&#x3D; R4(R5)</span><br><span class="line">   42 [-]: RETURN    R0 1         ; return </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; Function:        0_2</span><br><span class="line">; Defined at line: 38</span><br><span class="line">; #Upvalues:       1</span><br><span class="line">; #Parameters:     1</span><br><span class="line">; Is_vararg:       0</span><br><span class="line">; Max Stack Size:  3</span><br><span class="line"></span><br><span class="line">    0 [-]: LEN       R1 R0        ; R1 :&#x3D; #R0</span><br><span class="line">    1 [-]: SETTABUP  U0 K0 R1     ; U0[&quot;size&quot;] :&#x3D; R1</span><br><span class="line">    2 [-]: GETTABUP  R1 U0 K0     ; R1 :&#x3D; U0[&quot;size&quot;]</span><br><span class="line">    3 [-]: __add     1 R1 K1      ; if R1 ~&#x3D; 25 then goto 5 else goto 9</span><br><span class="line">    4 [-]: JMP       R0 4         ; PC +&#x3D; 4 (goto 9)</span><br><span class="line">    5 [-]: GETTABUP  R1 U0 K2     ; R1 :&#x3D; U0[&quot;print&quot;]</span><br><span class="line">    6 [-]: LOADK     R2 K3        ; R2 :&#x3D; &quot;length error&quot;</span><br><span class="line">    7 [-]: CALL      R1 2 1       ;  :&#x3D; R1(R2)</span><br><span class="line">    8 [-]: RETURN    R0 1         ; return </span><br><span class="line">    9 [-]: GETTABUP  R1 U0 K4     ; R1 :&#x3D; U0[&quot;encrypt&quot;]</span><br><span class="line">   10 [-]: MOVE      R2 R0        ; R2 :&#x3D; R0</span><br><span class="line">   11 [-]: CALL      R1 2 1       ;  :&#x3D; R1(R2)</span><br><span class="line">   12 [-]: RETURN    R0 1         ; return </span><br></pre></td></tr></table></figure>

<p>说是反汇编其实还是有一点反编译注释的吼。</p>
<p>根据注释来走就很容易理顺逻辑啦（可以参考<a target="_blank" rel="noopener" href="https://www.mdeditor.tw/pl/pPTs">深入理解 Lua 虚拟机_腾讯技术工程 - MdEditor</a>），算法用python还原是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Function 0_0:  to_v()</span></span><br><span class="line"><span class="comment"># Function 0_1:  encrypt()</span></span><br><span class="line"><span class="comment"># Function 0_2:  check_license()</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_v</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> s]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">global</span> tb0,tb1,tb2</span><br><span class="line">    u1,u2,u3=tb0,tb2,tb1 <span class="comment">#这个upvalue对应我也不知道是怎么看出来的，可能靠试吧</span></span><br><span class="line">    l1=to_v(s)</span><br><span class="line">    size=<span class="built_in">len</span>(l1)</span><br><span class="line">    l2=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">        l1[i]^=u1[i]</span><br><span class="line">        l2.append(u2[l1[i]+<span class="number">1</span>])</span><br><span class="line">    r3=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">        <span class="keyword">if</span> l2[i]==u3[i]:</span><br><span class="line">            r3+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r3+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> r3!=size:</span><br><span class="line">        print(<span class="string">&quot;bad&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;good&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_license</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s)!=<span class="number">25</span>:</span><br><span class="line">        print(<span class="string">&quot;length error&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        encrypt(s)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tb0=[<span class="number">172</span>, <span class="number">25</span>, <span class="number">60</span>, <span class="number">95</span>, <span class="number">5</span>, <span class="number">27</span>, <span class="number">49</span>, <span class="number">58</span>, <span class="number">171</span>, <span class="number">5</span>, <span class="number">253</span>, <span class="number">45</span>, <span class="number">87</span>, <span class="number">246</span>, <span class="number">197</span>, <span class="number">12</span>, <span class="number">97</span>, <span class="number">234</span>, <span class="number">159</span>, <span class="number">119</span>, <span class="number">157</span>, <span class="number">169</span>, <span class="number">121</span>, <span class="number">54</span>, <span class="number">242</span>]</span><br><span class="line">    tb1=[<span class="number">94</span>, <span class="number">117</span>, <span class="number">57</span>, <span class="number">37</span>, <span class="number">54</span>, <span class="number">110</span>, <span class="number">15</span>, <span class="number">223</span>, <span class="number">163</span>, <span class="number">133</span>, <span class="number">99</span>, <span class="number">237</span>, <span class="number">8</span>, <span class="number">128</span>, <span class="number">27</span>, <span class="number">54</span>, <span class="number">233</span>, <span class="number">181</span>, <span class="number">242</span>, <span class="number">55</span>, <span class="number">230</span>, <span class="number">62</span>, <span class="number">42</span>, <span class="number">252</span>, <span class="number">116</span>]</span><br><span class="line">    tb2=[<span class="number">81</span>, <span class="number">138</span>, <span class="number">85</span>, <span class="number">142</span>, <span class="number">185</span>, <span class="number">35</span>, <span class="number">229</span>, <span class="number">83</span>, <span class="number">8</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">223</span>, <span class="number">222</span>, <span class="number">47</span>, <span class="number">182</span>, <span class="number">158</span>, <span class="number">17</span>, <span class="number">74</span>, <span class="number">34</span>, <span class="number">100</span>, <span class="number">43</span>, <span class="number">103</span>, <span class="number">102</span>, <span class="number">147</span>, <span class="number">237</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">28</span>, <span class="number">224</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">40</span>, <span class="number">154</span>, <span class="number">127</span>, <span class="number">16</span>, <span class="number">169</span>, <span class="number">160</span>, <span class="number">118</span>, <span class="number">51</span>, <span class="number">194</span>, <span class="number">31</span>, <span class="number">68</span>, <span class="number">89</span>, <span class="number">65</span>, <span class="number">162</span>, <span class="number">13</span>, <span class="number">141</span>, <span class="number">0</span>, <span class="number">244</span>, <span class="number">119</span>, <span class="number">161</span>, <span class="number">198</span>, <span class="number">228</span>, <span class="number">95</span>, <span class="number">10</span>, <span class="number">78</span>, <span class="number">37</span>, <span class="number">121</span>, <span class="number">236</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">91</span>, <span class="number">146</span>, <span class="number">46</span>, <span class="number">77</span>, <span class="number">218</span>, <span class="number">66</span>, <span class="number">200</span>, <span class="number">61</span>, <span class="number">241</span>, <span class="number">70</span>, <span class="number">55</span>, <span class="number">39</span>, <span class="number">227</span>, <span class="number">42</span>, <span class="number">2</span>, <span class="number">231</span>, <span class="number">235</span>, <span class="number">122</span>, <span class="number">135</span>, <span class="number">152</span>, <span class="number">137</span>, <span class="number">173</span>, <span class="number">232</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">233</span>, <span class="number">21</span>, <span class="number">252</span>, <span class="number">15</span>, <span class="number">133</span>, <span class="number">111</span>, <span class="number">205</span>, <span class="number">57</span>, <span class="number">132</span>, <span class="number">187</span>, <span class="number">96</span>, <span class="number">49</span>, <span class="number">124</span>, <span class="number">86</span>, <span class="number">19</span>, <span class="number">188</span>, <span class="number">80</span>, <span class="number">213</span>, <span class="number">106</span>, <span class="number">214</span>, <span class="number">203</span>, <span class="number">177</span>, <span class="number">56</span>, <span class="number">104</span>, <span class="number">82</span>, <span class="number">110</span>, <span class="number">196</span>, <span class="number">113</span>, <span class="number">155</span>, <span class="number">170</span>, <span class="number">150</span>, <span class="number">117</span>, <span class="number">26</span>, <span class="number">140</span>, <span class="number">144</span>, <span class="number">11</span>, <span class="number">172</span>, <span class="number">67</span>, <span class="number">209</span>, <span class="number">125</span>, <span class="number">54</span>, <span class="number">58</span>, <span class="number">128</span>, <span class="number">204</span>, <span class="number">186</span>, <span class="number">199</span>, <span class="number">189</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">143</span>, <span class="number">249</span>, <span class="number">246</span>, <span class="number">1</span>, <span class="number">139</span>, <span class="number">33</span>, <span class="number">87</span>, <span class="number">64</span>, <span class="number">116</span>, <span class="number">84</span>, <span class="number">254</span>, <span class="number">126</span>, <span class="number">202</span>, <span class="number">148</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">3</span>, <span class="number">238</span>, <span class="number">114</span>, <span class="number">156</span>, <span class="number">195</span>, <span class="number">163</span>, <span class="number">159</span>, <span class="number">52</span>, <span class="number">36</span>, <span class="number">245</span>, <span class="number">240</span>, <span class="number">63</span>, <span class="number">153</span>, <span class="number">166</span>, <span class="number">167</span>, <span class="number">175</span>, <span class="number">9</span>, <span class="number">151</span>, <span class="number">171</span>, <span class="number">216</span>, <span class="number">207</span>, <span class="number">179</span>, <span class="number">72</span>, <span class="number">176</span>, <span class="number">48</span>, <span class="number">178</span>, <span class="number">157</span>, <span class="number">20</span>, <span class="number">181</span>, <span class="number">149</span>, <span class="number">53</span>, <span class="number">184</span>, <span class="number">4</span>, <span class="number">136</span>, <span class="number">165</span>, <span class="number">217</span>, <span class="number">50</span>, <span class="number">190</span>, <span class="number">191</span>, <span class="number">192</span>, <span class="number">193</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">62</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">90</span>, <span class="number">123</span>, <span class="number">105</span>, <span class="number">94</span>, <span class="number">221</span>, <span class="number">99</span>, <span class="number">201</span>, <span class="number">206</span>, <span class="number">251</span>, <span class="number">14</span>, <span class="number">211</span>, <span class="number">220</span>, <span class="number">131</span>, <span class="number">212</span>, <span class="number">130</span>, <span class="number">134</span>, <span class="number">253</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">18</span>, <span class="number">219</span>, <span class="number">79</span>, <span class="number">129</span>, <span class="number">12</span>, <span class="number">93</span>, <span class="number">5</span>, <span class="number">183</span>, <span class="number">107</span>, <span class="number">71</span>, <span class="number">226</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">108</span>, <span class="number">174</span>, <span class="number">6</span>, <span class="number">45</span>, <span class="number">29</span>, <span class="number">32</span>, <span class="number">168</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">41</span>, <span class="number">25</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">27</span>, <span class="number">210</span>, <span class="number">248</span>, <span class="number">97</span>, <span class="number">250</span>, <span class="number">22</span>, <span class="number">242</span>, <span class="number">243</span>, <span class="number">30</span>, <span class="number">69</span>]</span><br><span class="line">    print(<span class="string">&quot;input: &quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    license=<span class="built_in">input</span>()</span><br><span class="line">    check_license(license)</span><br></pre></td></tr></table></figure>

<p>就可以根据逻辑写出exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tb0=[<span class="number">172</span>, <span class="number">25</span>, <span class="number">60</span>, <span class="number">95</span>, <span class="number">5</span>, <span class="number">27</span>, <span class="number">49</span>, <span class="number">58</span>, <span class="number">171</span>, <span class="number">5</span>, <span class="number">253</span>, <span class="number">45</span>, <span class="number">87</span>, <span class="number">246</span>, <span class="number">197</span>, <span class="number">12</span>, <span class="number">97</span>, <span class="number">234</span>, <span class="number">159</span>, <span class="number">119</span>, <span class="number">157</span>, <span class="number">169</span>, <span class="number">121</span>, <span class="number">54</span>, <span class="number">242</span>]</span><br><span class="line">tb1=[<span class="number">94</span>, <span class="number">117</span>, <span class="number">57</span>, <span class="number">37</span>, <span class="number">54</span>, <span class="number">110</span>, <span class="number">15</span>, <span class="number">223</span>, <span class="number">163</span>, <span class="number">133</span>, <span class="number">99</span>, <span class="number">237</span>, <span class="number">8</span>, <span class="number">128</span>, <span class="number">27</span>, <span class="number">54</span>, <span class="number">233</span>, <span class="number">181</span>, <span class="number">242</span>, <span class="number">55</span>, <span class="number">230</span>, <span class="number">62</span>, <span class="number">42</span>, <span class="number">252</span>, <span class="number">116</span>]</span><br><span class="line">tb2=[<span class="number">81</span>, <span class="number">138</span>, <span class="number">85</span>, <span class="number">142</span>, <span class="number">185</span>, <span class="number">35</span>, <span class="number">229</span>, <span class="number">83</span>, <span class="number">8</span>, <span class="number">225</span>, <span class="number">92</span>, <span class="number">223</span>, <span class="number">222</span>, <span class="number">47</span>, <span class="number">182</span>, <span class="number">158</span>, <span class="number">17</span>, <span class="number">74</span>, <span class="number">34</span>, <span class="number">100</span>, <span class="number">43</span>, <span class="number">103</span>, <span class="number">102</span>, <span class="number">147</span>, <span class="number">237</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">28</span>, <span class="number">224</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">40</span>, <span class="number">154</span>, <span class="number">127</span>, <span class="number">16</span>, <span class="number">169</span>, <span class="number">160</span>, <span class="number">118</span>, <span class="number">51</span>, <span class="number">194</span>, <span class="number">31</span>, <span class="number">68</span>, <span class="number">89</span>, <span class="number">65</span>, <span class="number">162</span>, <span class="number">13</span>, <span class="number">141</span>, <span class="number">0</span>, <span class="number">244</span>, <span class="number">119</span>, <span class="number">161</span>, <span class="number">198</span>, <span class="number">228</span>, <span class="number">95</span>, <span class="number">10</span>, <span class="number">78</span>, <span class="number">37</span>, <span class="number">121</span>, <span class="number">236</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">91</span>, <span class="number">146</span>, <span class="number">46</span>, <span class="number">77</span>, <span class="number">218</span>, <span class="number">66</span>, <span class="number">200</span>, <span class="number">61</span>, <span class="number">241</span>, <span class="number">70</span>, <span class="number">55</span>, <span class="number">39</span>, <span class="number">227</span>, <span class="number">42</span>, <span class="number">2</span>, <span class="number">231</span>, <span class="number">235</span>, <span class="number">122</span>, <span class="number">135</span>, <span class="number">152</span>, <span class="number">137</span>, <span class="number">173</span>, <span class="number">232</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">233</span>, <span class="number">21</span>, <span class="number">252</span>, <span class="number">15</span>, <span class="number">133</span>, <span class="number">111</span>, <span class="number">205</span>, <span class="number">57</span>, <span class="number">132</span>, <span class="number">187</span>, <span class="number">96</span>, <span class="number">49</span>, <span class="number">124</span>, <span class="number">86</span>, <span class="number">19</span>, <span class="number">188</span>, <span class="number">80</span>, <span class="number">213</span>, <span class="number">106</span>, <span class="number">214</span>, <span class="number">203</span>, <span class="number">177</span>, <span class="number">56</span>, <span class="number">104</span>, <span class="number">82</span>, <span class="number">110</span>, <span class="number">196</span>, <span class="number">113</span>, <span class="number">155</span>, <span class="number">170</span>, <span class="number">150</span>, <span class="number">117</span>, <span class="number">26</span>, <span class="number">140</span>, <span class="number">144</span>, <span class="number">11</span>, <span class="number">172</span>, <span class="number">67</span>, <span class="number">209</span>, <span class="number">125</span>, <span class="number">54</span>, <span class="number">58</span>, <span class="number">128</span>, <span class="number">204</span>, <span class="number">186</span>, <span class="number">199</span>, <span class="number">189</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">143</span>, <span class="number">249</span>, <span class="number">246</span>, <span class="number">1</span>, <span class="number">139</span>, <span class="number">33</span>, <span class="number">87</span>, <span class="number">64</span>, <span class="number">116</span>, <span class="number">84</span>, <span class="number">254</span>, <span class="number">126</span>, <span class="number">202</span>, <span class="number">148</span>, <span class="number">76</span>, <span class="number">247</span>, <span class="number">115</span>, <span class="number">109</span>, <span class="number">3</span>, <span class="number">238</span>, <span class="number">114</span>, <span class="number">156</span>, <span class="number">195</span>, <span class="number">163</span>, <span class="number">159</span>, <span class="number">52</span>, <span class="number">36</span>, <span class="number">245</span>, <span class="number">240</span>, <span class="number">63</span>, <span class="number">153</span>, <span class="number">166</span>, <span class="number">167</span>, <span class="number">175</span>, <span class="number">9</span>, <span class="number">151</span>, <span class="number">171</span>, <span class="number">216</span>, <span class="number">207</span>, <span class="number">179</span>, <span class="number">72</span>, <span class="number">176</span>, <span class="number">48</span>, <span class="number">178</span>, <span class="number">157</span>, <span class="number">20</span>, <span class="number">181</span>, <span class="number">149</span>, <span class="number">53</span>, <span class="number">184</span>, <span class="number">4</span>, <span class="number">136</span>, <span class="number">165</span>, <span class="number">217</span>, <span class="number">50</span>, <span class="number">190</span>, <span class="number">191</span>, <span class="number">192</span>, <span class="number">193</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">62</span>, <span class="number">112</span>, <span class="number">38</span>, <span class="number">90</span>, <span class="number">123</span>, <span class="number">105</span>, <span class="number">94</span>, <span class="number">221</span>, <span class="number">99</span>, <span class="number">201</span>, <span class="number">206</span>, <span class="number">251</span>, <span class="number">14</span>, <span class="number">211</span>, <span class="number">220</span>, <span class="number">131</span>, <span class="number">212</span>, <span class="number">130</span>, <span class="number">134</span>, <span class="number">253</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">18</span>, <span class="number">219</span>, <span class="number">79</span>, <span class="number">129</span>, <span class="number">12</span>, <span class="number">93</span>, <span class="number">5</span>, <span class="number">183</span>, <span class="number">107</span>, <span class="number">71</span>, <span class="number">226</span>, <span class="number">180</span>, <span class="number">24</span>, <span class="number">234</span>, <span class="number">7</span>, <span class="number">108</span>, <span class="number">174</span>, <span class="number">6</span>, <span class="number">45</span>, <span class="number">29</span>, <span class="number">32</span>, <span class="number">168</span>, <span class="number">230</span>, <span class="number">197</span>, <span class="number">41</span>, <span class="number">25</span>, <span class="number">255</span>, <span class="number">164</span>, <span class="number">27</span>, <span class="number">210</span>, <span class="number">248</span>, <span class="number">97</span>, <span class="number">250</span>, <span class="number">22</span>, <span class="number">242</span>, <span class="number">243</span>, <span class="number">30</span>, <span class="number">69</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(tb2.index(tb1[i])^tb0[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="/p/wpFor-2020XCTF/image-20210304150822710.png"></p>
<p><strong>flag{th15_15_v3r7_c0mm3n}</strong></p>
<h2 id="divination-TO-DO"><a href="#divination-TO-DO" class="headerlink" title="divination[TO DO]"></a>divination[TO DO]</h2><p>先用模拟器跑一下，发现是一个输入字符串判断的逻辑。</p>
<blockquote>
<p>因为物理机里装了WSL2，所以用的是能兼容Hyper-V的BlueStacks模拟器。</p>
</blockquote>
<p><img src="/p/wpFor-2020XCTF/image-20210221004556852.png"></p>
<p>走流程，先用<a target="_blank" rel="noopener" href="https://github.com/pxb1988/dex2jar">pxb1988&#x2F;dex2jar: Tools to work with android .dex and java .class files</a>这个工具把将apk解压后文件夹中的classes.dex文件转换成jar文件，再用<a target="_blank" rel="noopener" href="https://java-decompiler.github.io/">Java Decompiler</a>中的JD-GUI查看反编译出的java源代码。</p>
<p>然后可以看到MainActivity.class这里也有一句“大事不妙”，找到主函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210221005218142.png"></p>
<p>看了一下逻辑就是调用libdivination.so（在apk解压后的路径<code>divination/lib/arm64-v8a/libdivination.so</code>），只要返回值为真就行。</p>
<p><del>所以其实做安卓逆向看so硬逆也能逆出来hhh。</del></p>
<p>于是现在转去逆so。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210221102702774.png"></p>
<p>关键入口函数显而易见，就是这个跟包同名的函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210221110434855.png"></p>
<p>为了方便看反编译代码，按<code>y</code>把a1-a3三个参数的变量类型进行更改（ida无法自动识别。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210221110645265.png"></p>
<p>下边的函数也一目了然。</p>
<p>从后往前看，先拿到目标数组unk_3000：</p>
<p><img src="/p/wpFor-2020XCTF/image-20210221111251068.png"></p>
<hr>
<h1 id="12-23-鲲鹏计算专场"><a href="#12-23-鲲鹏计算专场" class="headerlink" title="[12.23] 鲲鹏计算专场"></a>[12.23] 鲲鹏计算专场</h1><h2 id="mips"><a href="#mips" class="headerlink" title="mips"></a>mips</h2><blockquote>
<p>真·送分题，可惜当时要上课没来得及抢一血（下午2点放题绝了</p>
<p>老传统走迷宫</p>
</blockquote>
<p>mips架构。</p>
<p>ida反编译以后可以看到</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229125551113.png"></p>
<p>v4是我们输入的字符串，很明显是迷宫逻辑，上下左右用wasd走，迷宫存在dword_100111F0里。</p>
<p>sub_10000744()这个初始函数是用来找起点用的（就是迷宫中3所在的地方，在后面可以看到3其实表示的是当前位置）。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229125822518.png"></p>
<p>这里也可以看到应该有多个迷宫（dword_10011D10是用来表示第几个迷宫的，且&lt;&#x3D;2，一个迷宫有225个数）+一个迷宫宽为15&#x3D;三个迷宫，每个迷宫为15*15。</p>
<p>然后就是下面的四个函数，随便挑一个出来（比如sub_10000D28()）可以看到</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229130146475.png"></p>
<p>很明显是个往右走的函数，3表示当前位置，并把上一个当前位置标为1（可走路径）。并且可以看到终点是4，就是说我们要把每个迷宫从3走到4。</p>
<p>dump迷宫数组，写脚本打印迷宫：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">aMap=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        <span class="keyword">if</span> aMap[i*<span class="number">15</span>+j]==<span class="number">0</span>:</span><br><span class="line">            tmp=<span class="string">&#x27;*&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> aMap[i*<span class="number">15</span>+j]==<span class="number">1</span>:</span><br><span class="line">            tmp=<span class="string">&#x27;.&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> aMap[i*<span class="number">15</span>+j]==<span class="number">3</span>:</span><br><span class="line">            tmp=<span class="string">&#x27;@&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp=<span class="string">&#x27;#&#x27;</span></span><br><span class="line">        print(tmp,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    print()</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">14</span> <span class="keyword">or</span> i==<span class="number">29</span>:</span><br><span class="line">        print()</span><br></pre></td></tr></table></figure>

<p>可以看到打印出了三个迷宫，为了看得清楚所以选用几个特定字符打印。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">.....**********</span><br><span class="line">.....*@*.******</span><br><span class="line">.....*.*.******</span><br><span class="line">.....*.*.******</span><br><span class="line">.....*.*.....**</span><br><span class="line">.....*.*****.**</span><br><span class="line">.....*.*****.**</span><br><span class="line">.....*.*****..*</span><br><span class="line">.....*........*</span><br><span class="line">.....********#*</span><br><span class="line">...............</span><br><span class="line">...............</span><br><span class="line">...............</span><br><span class="line">...............</span><br><span class="line">...............</span><br><span class="line">#sssssssddddddds</span><br><span class="line"></span><br><span class="line">..*************</span><br><span class="line">..*@*....******</span><br><span class="line">..*.****.******</span><br><span class="line">..*.****.******</span><br><span class="line">..*..***.....**</span><br><span class="line">..*..*******.**</span><br><span class="line">..*..*******.**</span><br><span class="line">..*..*****....*</span><br><span class="line">..*..*****.**.*</span><br><span class="line">..*..*****.****</span><br><span class="line">..*......*.*..*</span><br><span class="line">..*...........*</span><br><span class="line">..***********#*</span><br><span class="line">...............</span><br><span class="line">...............</span><br><span class="line">#ssssssssssdddddddddds</span><br><span class="line"></span><br><span class="line">***************</span><br><span class="line">*@..***********</span><br><span class="line">***.*...*******</span><br><span class="line">***...*.*******</span><br><span class="line">****.**.*******</span><br><span class="line">*..*.**.*******</span><br><span class="line">**...**.*******</span><br><span class="line">*******.*******</span><br><span class="line">*******....****</span><br><span class="line">**********.****</span><br><span class="line">**********.****</span><br><span class="line">**********.****</span><br><span class="line">**********....*</span><br><span class="line">*************.*</span><br><span class="line">*************#*</span><br><span class="line">#ddssddwddssssssdddssssdddss</span><br></pre></td></tr></table></figure>

<p>走迷宫，然后把路径拼起来，根据提示转md5，get flag。</p>
<p>（有个疑惑哈，第二个迷宫理论上说就算是最短路也有多解？是题目出锅了还是我哪里看漏了&#x3D; &#x3D;</p>
<p>（再补一句，题目似乎甚至没要求最短路？？？神奇.jpg</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229163439245.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">s=<span class="string">b&quot;sssssssdddddddsssssssssssddddddddddsddssddwddssssssdddssssdddss&quot;</span></span><br><span class="line">print(<span class="string">&quot;flag&#123;%s&#125;&quot;</span>%hashlib.md5(s).hexdigest())</span><br></pre></td></tr></table></figure>

<p><strong>flag{999ea6aa6c365ab43eec2a0f0e5968d5}</strong></p>
<h2 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h2><p>把题目文件拖进ida，搜索字符串能看到</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229164109092.png"></p>
<p>猜测是pyinstaller打包的文件。</p>
<blockquote>
<p>也就是这个题让我突然发现pyinstaller还能打包成elf的，于是比赛结束以后赶紧把之前总结的解包指南更新了：<a href="https://c10udlnk.top/p/reSkillsOn-Pyinstaller-extracted-to-python/">RE套路 - 关于pyinstaller打包文件的复原 | c10udlnk_Log</a>。</p>
</blockquote>
<p>走流程解包，得到python源码。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229165610468.png"></p>
<p>看到这种混淆变量名，果断替换成ida style变量名（。</p>
<p>放一下源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.18 (v2.7.18:8d21aa21f2, Apr 20 2020, 13:25:05) [MSC v.1500 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Warning: this version of Python has problems handling the Python 3 &quot;byte&quot; type in constants properly.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Embedded file name: main.py</span></span><br><span class="line"><span class="comment"># Compiled at: 1995-09-28 00:18:56</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 257 bytes</span></span><br><span class="line"><span class="keyword">import</span> random, codecs, sys, time, pygame</span><br><span class="line"><span class="keyword">from</span> pygame.<span class="built_in">locals</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">SCREEN_WIDTH = <span class="number">600</span></span><br><span class="line">SCREEN_HEIGHT = <span class="number">480</span></span><br><span class="line">SIZE = <span class="number">20</span></span><br><span class="line">LINE_WIDTH = <span class="number">1</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;this is a fake flag&#125;&#x27;</span></span><br><span class="line">SCOPE_X = (<span class="number">0</span>, SCREEN_WIDTH // SIZE - <span class="number">1</span>)</span><br><span class="line">SCOPE_Y = (<span class="number">2</span>, SCREEN_HEIGHT // SIZE - <span class="number">1</span>)</span><br><span class="line">FOOD_STYLE_LIST = [(<span class="number">10</span>, (<span class="number">255</span>, <span class="number">100</span>, <span class="number">100</span>)), (<span class="number">20</span>, (<span class="number">100</span>, <span class="number">255</span>, <span class="number">100</span>)), (<span class="number">30</span>, (<span class="number">100</span>, <span class="number">100</span>, <span class="number">255</span>))]</span><br><span class="line">LIGHT = (<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line">DARK = (<span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">200</span>, <span class="number">30</span>, <span class="number">30</span>)</span><br><span class="line">BGCOLOR = (<span class="number">40</span>, <span class="number">40</span>, <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_text</span>(<span class="params">v1, v2, v3, v4, v5, fcolor=(<span class="params"><span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span></span>)</span>):</span></span><br><span class="line">    v6 = v2.render(v5, <span class="literal">True</span>, fcolor)</span><br><span class="line">    v1.blit(v6, (v3, v4))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_snake</span>():</span></span><br><span class="line">    v7 = deque()</span><br><span class="line">    v7.append((<span class="number">2</span>, SCOPE_Y[<span class="number">0</span>]))</span><br><span class="line">    v7.append((<span class="number">1</span>, SCOPE_Y[<span class="number">0</span>]))</span><br><span class="line">    v7.append((<span class="number">0</span>, SCOPE_Y[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">return</span> v7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_food</span>(<span class="params">v8</span>):</span></span><br><span class="line">    v9 = random.randint(SCOPE_X[<span class="number">0</span>], SCOPE_X[<span class="number">1</span>])</span><br><span class="line">    v10 = random.randint(SCOPE_Y[<span class="number">0</span>], SCOPE_Y[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">while</span> (v9, v10) <span class="keyword">in</span> v8:</span><br><span class="line">        v9 = random.randint(SCOPE_X[<span class="number">0</span>], SCOPE_X[<span class="number">1</span>])</span><br><span class="line">        v10 = random.randint(SCOPE_Y[<span class="number">0</span>], SCOPE_Y[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">     v9, v10)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_food_style</span>():</span></span><br><span class="line">    <span class="keyword">return</span> FOOD_STYLE_LIST[random.randint(<span class="number">0</span>, <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DEFAULT_KEY = <span class="string">u&#x27;Y\xf3\x02\xc3%\x9a\x820\x0b\xbb%\x7f~;\xd2\xdc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4</span>(<span class="params">v11, key=DEFAULT_KEY, skip=<span class="number">1024</span></span>):</span></span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    v13 = <span class="built_in">bytearray</span>([v14 <span class="keyword">for</span> v14 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)])</span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> v15 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        v12 = (v12 + v13[v15] + <span class="built_in">ord</span>(key[(v15 % <span class="built_in">len</span>(key))])) % <span class="number">256</span></span><br><span class="line">        v16 = v13[v15]</span><br><span class="line">        v17 = v13[v12]</span><br><span class="line">        v13[v15] = v13[v12]</span><br><span class="line">        v13[v12] = v16</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v12 = <span class="number">0</span></span><br><span class="line">        v18 = <span class="number">0</span></span><br><span class="line">        v19 = []</span><br><span class="line">        <span class="keyword">if</span> skip &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> v15 <span class="keyword">in</span> <span class="built_in">range</span>(skip):</span><br><span class="line">                v12 = (v12 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">                v18 = (v18 + v13[v12]) % <span class="number">256</span></span><br><span class="line">                v13[v12], v13[v18] = v13[v18], v13[v12]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> v20 <span class="keyword">in</span> v11:</span><br><span class="line">            v12 = (v12 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            v18 = (v18 + v13[v12]) % <span class="number">256</span></span><br><span class="line">            v13[v12], v13[v18] = v13[v18], v13[v12]</span><br><span class="line">            v21 = v13[((v13[v12] + v13[v18]) % <span class="number">256</span>)]</span><br><span class="line">            v19.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(v20) ^ v21))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(v19)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">v22</span>):</span></span><br><span class="line">    v23 = rc4(v22)</span><br><span class="line">    <span class="keyword">if</span> v23.encode(<span class="string">&#x27;utf-8&#x27;</span>).<span class="built_in">hex</span>() == <span class="string">&#x27;275b39c381c28b701ac3972338456022c2ba06c3b04f5501471c47c38ac380c29b72c3b5c38a7ec2a5c2a0&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;YOU WIN&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;YOU LOSE&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    pygame.init()</span><br><span class="line">    v24 = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))</span><br><span class="line">    pygame.display.set_caption(<span class="string">u&#x27;\u8d2a\u5403\u86c7&#x27;</span>)</span><br><span class="line">    v25 = pygame.font.SysFont(<span class="string">&#x27;SimHei&#x27;</span>, <span class="number">24</span>)</span><br><span class="line">    v26 = pygame.font.Font(<span class="literal">None</span>, <span class="number">72</span>)</span><br><span class="line">    v27, v28 = v26.size(<span class="string">&#x27;GAME OVER&#x27;</span>)</span><br><span class="line">    v29 = <span class="literal">True</span></span><br><span class="line">    v30 = init_snake()</span><br><span class="line">    v31 = create_food(v30)</span><br><span class="line">    v32 = get_food_style()</span><br><span class="line">    v33 = (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    v34 = <span class="literal">True</span></span><br><span class="line">    v35 = <span class="literal">False</span></span><br><span class="line">    v36 = <span class="number">0</span></span><br><span class="line">    v37 = <span class="number">0.5</span></span><br><span class="line">    v38 = v37</span><br><span class="line">    v39 = <span class="literal">None</span></span><br><span class="line">    v41 = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> v40 <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> v40.<span class="built_in">type</span> == QUIT:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> v40.<span class="built_in">type</span> == KEYDOWN:</span><br><span class="line">            <span class="keyword">if</span> v40.key == K_RETURN:</span><br><span class="line">                <span class="keyword">if</span> v34:</span><br><span class="line">                    v35 = <span class="literal">True</span></span><br><span class="line">                    v34 = <span class="literal">False</span></span><br><span class="line">                    v29 = <span class="literal">True</span></span><br><span class="line">                    v30 = init_snake()</span><br><span class="line">                    v31 = create_food(v30)</span><br><span class="line">                    v32 = get_food_style()</span><br><span class="line">                    v33 = (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">                    v36 = <span class="number">0</span></span><br><span class="line">                    v39 = time.time()</span><br><span class="line">            <span class="keyword">elif</span> v40.key == K_SPACE:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> v34:</span><br><span class="line">                    v41 = <span class="keyword">not</span> v41</span><br><span class="line">            <span class="keyword">elif</span> v40.key <span class="keyword">in</span> (K_w, K_UP):</span><br><span class="line">                <span class="keyword">if</span> v29:</span><br><span class="line">                    v33 = v33[<span class="number">1</span>] <span class="keyword">or</span> (<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">                    v29 = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">elif</span> v40.key <span class="keyword">in</span> (K_s, K_DOWN):</span><br><span class="line">                <span class="keyword">if</span> v29:</span><br><span class="line">                    v33 = v33[<span class="number">1</span>] <span class="keyword">or</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">                    v29 = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">elif</span> v40.key <span class="keyword">in</span> (K_a, K_LEFT):</span><br><span class="line">                <span class="keyword">if</span> v29:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> v33[<span class="number">0</span>]:</span><br><span class="line">                        v33 = (<span class="number">-1</span>, <span class="number">0</span>)</span><br><span class="line">                        v29 = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">elif</span> v40.key <span class="keyword">in</span> (K_d, K_RIGHT):</span><br><span class="line">                        <span class="keyword">if</span> v29:</span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">not</span> v33[<span class="number">0</span>]:</span><br><span class="line">                                v33 = (<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">                                v29 = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v24.fill(BGCOLOR)</span><br><span class="line">            <span class="keyword">for</span> v42 <span class="keyword">in</span> <span class="built_in">range</span>(SIZE, SCREEN_WIDTH, SIZE):</span><br><span class="line">                pygame.draw.line(v24, BLACK, (v42, SCOPE_Y[<span class="number">0</span>] * SIZE), (v42, SCREEN_HEIGHT), LINE_WIDTH)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> v43 <span class="keyword">in</span> <span class="built_in">range</span>(SCOPE_Y[<span class="number">0</span>] * SIZE, SCREEN_HEIGHT, SIZE):</span><br><span class="line">                    pygame.draw.line(v24, BLACK, (<span class="number">0</span>, v43), (SCREEN_WIDTH, v43), LINE_WIDTH)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    v44 = v34 <span class="keyword">or</span> time.time()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> v44 - v39 &gt; v38 <span class="keyword">and</span> <span class="keyword">not</span> v41:</span><br><span class="line">                v29 = <span class="literal">True</span></span><br><span class="line">                v39 = v44</span><br><span class="line">                v45 = (v30[<span class="number">0</span>][<span class="number">0</span>] + v33[<span class="number">0</span>], v30[<span class="number">0</span>][<span class="number">1</span>] + v33[<span class="number">1</span>])</span><br><span class="line">                <span class="keyword">if</span> v45 == v31:</span><br><span class="line">                    v30.appendleft(v45)</span><br><span class="line">                    v36 += v32[<span class="number">0</span>]</span><br><span class="line">                    v38 = v37 - <span class="number">0.03</span> * (v36 // <span class="number">100</span>)</span><br><span class="line">                    v31 = create_food(v30)</span><br><span class="line">                    v32 = get_food_style()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> SCOPE_X[<span class="number">0</span>] &lt;= v45[<span class="number">0</span>] &lt;= SCOPE_X[<span class="number">1</span>]:</span><br><span class="line">                        <span class="keyword">if</span> SCOPE_Y[<span class="number">0</span>] &lt;= v45[<span class="number">1</span>] &lt;= SCOPE_Y[<span class="number">1</span>]:</span><br><span class="line">                            <span class="keyword">if</span> v45 <span class="keyword">not</span> <span class="keyword">in</span> v30:</span><br><span class="line">                                v30.appendleft(v45)</span><br><span class="line">                                v30.pop()</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                v34 = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> v34:</span><br><span class="line">                        pygame.draw.rect(v24, v32[<span class="number">1</span>], (v31[<span class="number">0</span>] * SIZE, v31[<span class="number">1</span>] * SIZE, SIZE, SIZE), <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">for</span> v46 <span class="keyword">in</span> v30:</span><br><span class="line">                    pygame.draw.rect(v24, DARK, (v46[<span class="number">0</span>] * SIZE + LINE_WIDTH, v46[<span class="number">1</span>] * SIZE + LINE_WIDTH, SIZE - LINE_WIDTH * <span class="number">2</span>, SIZE - LINE_WIDTH * <span class="number">2</span>), <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print_text(v24, v25, <span class="number">30</span>, <span class="number">7</span>, <span class="string">f&quot;speed: <span class="subst">&#123;v36 // <span class="number">100</span>&#125;</span>&quot;</span>)</span><br><span class="line">                    print_text(v24, v25, <span class="number">450</span>, <span class="number">7</span>, <span class="string">f&quot;score: <span class="subst">&#123;v36&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> v36 &gt;= <span class="number">5192296858534827628530496329220096</span>:</span><br><span class="line">                        v47 = flag</span><br><span class="line">                        print_text(v24, v26, (SCREEN_WIDTH - v27) // <span class="number">2</span>, (SCREEN_HEIGHT - v28) // <span class="number">2</span>, func(v47), RED)</span><br><span class="line">                    <span class="keyword">if</span> v34:</span><br><span class="line">                        <span class="keyword">if</span> v35:</span><br><span class="line">                            print_text(v24, v26, (SCREEN_WIDTH - v27) // <span class="number">2</span>, (SCREEN_HEIGHT - v28) // <span class="number">2</span>, <span class="string">&#x27;GAME OVER&#x27;</span>, RED)</span><br><span class="line">                    pygame.display.update()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># okay decompiling main.pyc</span></span><br></pre></td></tr></table></figure>

<p>可以看到最后getflag这里（func()）的程序逻辑就一个rc4加密，由rc4的特性可知加密和解密流程相同，故复用程序中的rc4()来得到flag。</p>
<p>uncompyle反编译出来的源码是python3，但是题目本身的源码是python2，注意编码问题。</p>
<blockquote>
<p>关于编码问题，可以看：</p>
<p><a target="_blank" rel="noopener" href="https://pycoders-weekly-chinese.readthedocs.io/en/latest/issue5/unipain.html">Unicode之痛 — PyCoder’s Weelky CN</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yangmingxianshen/p/7990102.html">关于python2中的unicode和str以及python3中的str和bytes - 明王不动心 - 博客园</a></p>
</blockquote>
<p>这里因为反编译做了转换成python3的处理，所以脚本用python3写。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">DEFAULT_KEY = <span class="string">u&#x27;Y\xf3\x02\xc3%\x9a\x820\x0b\xbb%\x7f~;\xd2\xdc&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4</span>(<span class="params">v11, key=DEFAULT_KEY, skip=<span class="number">1024</span></span>):</span></span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    v13 = <span class="built_in">bytearray</span>([v14 <span class="keyword">for</span> v14 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)])</span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> v15 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        v12 = (v12 + v13[v15] + <span class="built_in">ord</span>(key[(v15 % <span class="built_in">len</span>(key))])) % <span class="number">256</span></span><br><span class="line">        v16 = v13[v15]</span><br><span class="line">        v17 = v13[v12]</span><br><span class="line">        v13[v15] = v13[v12]</span><br><span class="line">        v13[v12] = v16</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v12 = <span class="number">0</span></span><br><span class="line">        v18 = <span class="number">0</span></span><br><span class="line">        v19 = []</span><br><span class="line">        <span class="keyword">if</span> skip &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> v15 <span class="keyword">in</span> <span class="built_in">range</span>(skip):</span><br><span class="line">                v12 = (v12 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">                v18 = (v18 + v13[v12]) % <span class="number">256</span></span><br><span class="line">                v13[v12], v13[v18] = v13[v18], v13[v12]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> v20 <span class="keyword">in</span> v11:</span><br><span class="line">            v12 = (v12 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            v18 = (v18 + v13[v12]) % <span class="number">256</span></span><br><span class="line">            v13[v12], v13[v18] = v13[v18], v13[v12]</span><br><span class="line">            v21 = v13[((v13[v12] + v13[v18]) % <span class="number">256</span>)]</span><br><span class="line">            v19.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(v20) ^ v21))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(v19)</span><br><span class="line"><span class="comment"># def func(v22):</span></span><br><span class="line"><span class="comment">#     v23 = rc4(v22)</span></span><br><span class="line"><span class="comment">#     if v23.encode(&#x27;utf-8&#x27;).hex() == &#x27;275b39c381c28b701ac3972338456022c2ba06c3b04f5501471c47c38ac380c29b72c3b5c38a7ec2a5c2a0&#x27;:</span></span><br><span class="line"><span class="comment">#         return &#x27;YOU WIN&#x27;</span></span><br><span class="line"><span class="comment">#     return &#x27;YOU LOSE&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -=-=-=以上所有为源码中原函数-=-=-=</span></span><br><span class="line"></span><br><span class="line">cipher=<span class="string">&#x27;275b39c381c28b701ac3972338456022c2ba06c3b04f5501471c47c38ac380c29b72c3b5c38a7ec2a5c2a0&#x27;</span></span><br><span class="line">flag=<span class="built_in">bytes</span>.fromhex(cipher).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(rc4(flag))</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20201229190337791.png"></p>
<p><strong>flag{snake_bao_is_really_lucky}</strong></p>
<h2 id="print"><a href="#print" class="headerlink" title="print"></a>print</h2><blockquote>
<p>官方wp说的是给了一个brainfuck引擎，跟我赛中攻击格式化字符串漏洞的思路完全不一样(。)，一开始还以为我想得太偏了XD，然而在复现的时候发现这个brainfuck解释器的原理就是攻击格式化字符串漏洞，学到了学到了。</p>
</blockquote>
<p><del>以下试图从头开始复现。</del></p>
<p>通过在<a target="_blank" rel="noopener" href="https://duckduckgo.com/">DuckDuckGo</a>上搜索<code>setup()</code>中的特殊字符串<code>&quot;%1$.*1$d %2$hn&quot;</code>查到一个github项目<a target="_blank" rel="noopener" href="https://github.com/HexHive/printbf">HexHive&#x2F;printbf: Brainfuck interpreter inside printf</a>，发现其余的字符串与题目中的十分相似，并且<code>pbf_pre.c</code>跟程序逻辑几乎一样，推测是题目的来源。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210123170914416.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210123171023639.png"></p>
<p>所以先通过动态调试，把断点设在前面所有的赋值语句之后，用idapython的<code>get_bytes(0x5577FCB50000,16000)</code>提取出progn的内容。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210123181852813.png"></p>
<p>通过printbf项目中的<code>pbf_pre.c</code>源码可以知道progn是int *，故将提取出来的byte对象进行处理，然后按照<code>token.py</code>的逻辑逆向写出由progn反向生成的brainfuck程序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># token.py from &quot;HexHive/printbf: Brainfuck interpreter inside printf&quot;</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser</span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&quot;Nicholas Carlini &lt;npc@berkeley.edu&gt; and Mathias Payer &lt;mathias.payer@nebelwelt.net&gt;&quot;</span></span><br><span class="line">__description__ = <span class="string">&quot;Script to tokenize a BF script into a printf interpreter.&quot;</span></span><br><span class="line">__version__ = <span class="built_in">filter</span>(<span class="built_in">str</span>.isdigit, <span class="string">&quot;$Revision: 1 $&quot;</span>)</span><br><span class="line"></span><br><span class="line">parser = ArgumentParser(description=__description__)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-v&#x27;</span>, <span class="string">&#x27;--version&#x27;</span>, action=<span class="string">&#x27;version&#x27;</span>, version=<span class="string">&#x27;%(prog)s &#123;:s&#125;&#x27;</span>.<span class="built_in">format</span>(__version__))</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--template&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;template filename&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Filename for the template to use.&#x27;</span>, required=<span class="literal">False</span>, default=<span class="string">&#x27;bf_pre.c&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-bf&#x27;</span>, <span class="string">&#x27;--brainfuck&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;bf file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;BF program&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--input&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;input to bf&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;BF input&#x27;</span>, required=<span class="literal">False</span>, default=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">                    </span><br><span class="line">prog = <span class="built_in">open</span>(args.brainfuck).read()</span><br><span class="line">prog = <span class="string">&quot;&quot;</span>.join([x <span class="keyword">for</span> x <span class="keyword">in</span> prog <span class="keyword">if</span> x <span class="keyword">in</span> <span class="string">&quot;&lt;&gt;+-.,[]&quot;</span>])</span><br><span class="line">prog = prog.replace(<span class="string">&quot;[-]&quot;</span>, <span class="string">&quot;Z&quot;</span>)</span><br><span class="line"></span><br><span class="line">remap = &#123;<span class="string">&#x27;&lt;&#x27;</span>:[<span class="number">1</span>],</span><br><span class="line">         <span class="string">&#x27;&gt;&#x27;</span>:[<span class="number">2</span>],</span><br><span class="line">         <span class="string">&#x27;+&#x27;</span>:[<span class="number">3</span>],</span><br><span class="line">         <span class="string">&#x27;-&#x27;</span>:[<span class="number">4</span>],</span><br><span class="line">         <span class="string">&#x27;.&#x27;</span>:[<span class="number">5</span>,<span class="number">6</span>],</span><br><span class="line">         <span class="string">&#x27;,&#x27;</span>:[<span class="number">7</span>,<span class="number">8</span>],</span><br><span class="line">         <span class="string">&#x27;[&#x27;</span>:[<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>],</span><br><span class="line">         <span class="string">&#x27;]&#x27;</span>:[<span class="number">12</span>],</span><br><span class="line">         <span class="string">&#x27;Z&#x27;</span>:[<span class="number">13</span>],</span><br><span class="line">         <span class="string">&#x27;F&#x27;</span>:[<span class="number">14</span>],</span><br><span class="line">         <span class="string">&#x27;B&#x27;</span>:[<span class="number">15</span>],<span class="comment">#,16,17],</span></span><br><span class="line">         <span class="string">&#x27;A&#x27;</span>:[<span class="number">18</span>],</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">newprog = []</span><br><span class="line">progiter = <span class="built_in">iter</span>(prog)</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(prog):</span><br><span class="line">    e = prog[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">in</span> <span class="string">&#x27;&lt;&gt;+-&#x27;</span>:</span><br><span class="line">        res = itertools.takewhile(<span class="keyword">lambda</span> x: x == e, prog)</span><br><span class="line">        count = <span class="built_in">len</span>(<span class="built_in">list</span>(res))</span><br><span class="line">        <span class="keyword">if</span> e == <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">            newprog.append((<span class="string">&#x27;F&#x27;</span>,count))</span><br><span class="line">        <span class="keyword">elif</span> e == <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">            <span class="keyword">assert</span> count &lt; <span class="number">256</span></span><br><span class="line">            newprog.append((<span class="string">&#x27;B&#x27;</span>,<span class="number">65536</span>-count))</span><br><span class="line">        <span class="keyword">elif</span> e == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            newprog.append((<span class="string">&#x27;A&#x27;</span>,count))</span><br><span class="line">        <span class="keyword">elif</span> e == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            newprog.append((<span class="string">&#x27;A&#x27;</span>,<span class="number">256</span>-count))</span><br><span class="line">        prog = prog[count:]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        newprog.append(e)</span><br><span class="line">        prog = prog[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">stack = []</span><br><span class="line">index = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">txt = <span class="built_in">open</span>(args.template).read()</span><br><span class="line">txt = txt.replace(<span class="string">&#x27;###INPUT###&#x27;</span>, args.<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span> txt[<span class="number">0</span>:txt.find(<span class="string">&#x27;###TOKER###&#x27;</span>)],</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> newprog:</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(e) == <span class="built_in">type</span>(<span class="built_in">tuple</span>()):</span><br><span class="line">        count = e[<span class="number">1</span>]</span><br><span class="line">        e = e[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i,insn <span class="keyword">in</span> <span class="built_in">enumerate</span>(remap[e]):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(index+i*<span class="number">2</span>,insn)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> count != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">assert</span> i == <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(index+<span class="number">1</span>,count)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> e == <span class="string">&#x27;[&#x27;</span>: <span class="comment"># this is a cgoto</span></span><br><span class="line">        stack.append(index)</span><br><span class="line">    <span class="keyword">elif</span> e == <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">        backto = stack.pop()</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(backto+<span class="number">1</span>,index*<span class="number">4</span><span class="number">-4</span>)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(backto+<span class="number">3</span>,index*<span class="number">4</span><span class="number">-4</span>)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(backto+<span class="number">5</span>,index*<span class="number">4</span><span class="number">-4</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;  progn[%d] = %d;&#x27;</span>%(index+<span class="number">1</span>,(backto<span class="number">-2</span>)*<span class="number">4</span>) <span class="comment"># we always increment PC by 1</span></span><br><span class="line"></span><br><span class="line">    index += <span class="number">2</span>*<span class="built_in">len</span>(remap[e])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> txt[txt.find(<span class="string">&#x27;###TOKER###&#x27;</span>)+<span class="number">11</span>:],</span><br></pre></td></tr></table></figure>

<p>可以看到实际上就是从progn[2*k]这里看到brainfuck的每一步操作符，而对于”+-&gt;&lt;”这四种操作符的数量由progn[2*k+1]给出，故从这些位置即可提取出bf程序的操作符，得到bf程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="string">b&#x27;&#x27;</span> <span class="comment"># 这里是动态调试提取出的progn字节对象，太长了这里不贴</span></span><br><span class="line">progn=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16000</span>,<span class="number">4</span>):</span><br><span class="line">    progn.append(<span class="built_in">int</span>.from_bytes(p[i:i+<span class="number">4</span>],byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line"><span class="comment"># 转化成printbf中的int* progn</span></span><br><span class="line">i=<span class="number">2</span></span><br><span class="line">bfCode=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(progn) <span class="keyword">and</span> progn[i]!=<span class="number">0</span>:</span><br><span class="line">    <span class="keyword">if</span> progn[i]==<span class="number">5</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;.&#x27;</span></span><br><span class="line">        i+=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">7</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;,&#x27;</span></span><br><span class="line">        i+=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">9</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;[&#x27;</span></span><br><span class="line">        i+=<span class="number">6</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">12</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;]&#x27;</span></span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">13</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;[-]&#x27;</span></span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">14</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;&gt;&#x27;</span>*progn[i+<span class="number">1</span>]</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">15</span>:</span><br><span class="line">        bfCode+=<span class="string">&#x27;&lt;&#x27;</span>*(<span class="number">65536</span>-progn[i+<span class="number">1</span>])</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">18</span>:</span><br><span class="line">        <span class="comment"># 其实这里+和-没法准确区分，且对于无符号char型数据来说-n和+(256-n)得到的结果是一样的，这里选择字符数更少的操作符</span></span><br><span class="line">        <span class="keyword">if</span> progn[i+<span class="number">1</span>]&gt;<span class="number">0x7F</span>:</span><br><span class="line">            bfCode+=<span class="string">&#x27;-&#x27;</span>*(<span class="number">256</span>-progn[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bfCode+=<span class="string">&#x27;+&#x27;</span>*progn[i+<span class="number">1</span>]</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;[-] UknCode &quot;</span>+<span class="built_in">str</span>(progn[i])+<span class="string">&quot; in progn[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&quot;</span>)</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">print(bfCode)</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;,&gt;,&gt;,&gt;,&gt;,&gt;,&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;]&lt;[-&gt;+&lt;]&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;]&lt;[-&gt;+&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;]&lt;[-&gt;+&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;]&lt;[-&gt;+&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;]&lt;[-&gt;+&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]----------------------------&gt;[-]+++++&gt;[-]--------------------------------------------------------------------------------------------------&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]++++++++++++++++++++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;[-]]&gt;[&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;[-]]&gt;[&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;[-]]&gt;[&gt;&gt;&gt;+&lt;&lt;&lt;[-]]&gt;[&gt;&gt;+&lt;&lt;[-]]&gt;[&gt;+&lt;[-]]&gt;&gt;,&gt;,&gt;,&gt;,&gt;,&gt;,&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&gt;[-]+++++++++++++++++++++++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-&gt;&gt;&gt;&gt;&gt;&gt;-&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;.</span><br></pre></td></tr></table></figure>

<p>进一步的，为了方便甚至可以直接转化成c程序，最后的处理脚本为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="string">b&#x27;&#x27;</span> <span class="comment">#依旧是太长不贴（</span></span><br><span class="line">progn=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16000</span>,<span class="number">4</span>):</span><br><span class="line">    progn.append(<span class="built_in">int</span>.from_bytes(p[i:i+<span class="number">4</span>],byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line"><span class="comment"># 转化成printbf中的int* progn</span></span><br><span class="line">i=<span class="number">2</span></span><br><span class="line">indent=<span class="number">0</span></span><br><span class="line">ptr=<span class="number">0</span></span><br><span class="line">print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;#include &lt;stdio.h&gt;&quot;</span>)</span><br><span class="line">print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;int main()&#123;&quot;</span>)</span><br><span class="line">indent+=<span class="number">4</span></span><br><span class="line">print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;char mem[1000000]=&#123;0&#125;;&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(progn) <span class="keyword">and</span> progn[i]!=<span class="number">0</span>:</span><br><span class="line">    <span class="keyword">if</span> progn[i]==<span class="number">5</span>:</span><br><span class="line">        print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;printf(\&quot;%c\&quot;,mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;]);&quot;</span>)</span><br><span class="line">        i+=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">7</span>:</span><br><span class="line">        print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;scanf(\&quot;%c\&quot;,&amp;mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;]);&quot;</span>)</span><br><span class="line">        i+=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">9</span>:</span><br><span class="line">        print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;while(mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;])&#123;&quot;</span>)</span><br><span class="line">        indent+=<span class="number">4</span></span><br><span class="line">        i+=<span class="number">6</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">12</span>:</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">        indent-=<span class="number">4</span></span><br><span class="line">        print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">13</span>:</span><br><span class="line">        print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;]=0;&quot;</span>)</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">14</span>:</span><br><span class="line">        ptr+=progn[i+<span class="number">1</span>]</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">15</span>:</span><br><span class="line">        ptr-=(<span class="number">65536</span>-progn[i+<span class="number">1</span>])</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> progn[i]==<span class="number">18</span>:</span><br><span class="line">        <span class="comment"># 其实这里+和-没法准确区分，且对于无符号char型数据来说-n和+(256-n)得到的结果是一样的，这里选择字符数更少的操作符</span></span><br><span class="line">        <span class="keyword">if</span> progn[i+<span class="number">1</span>]&gt;<span class="number">0x7F</span>:</span><br><span class="line">            print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;]-=&quot;</span>+<span class="built_in">str</span>(<span class="number">256</span>-progn[i+<span class="number">1</span>])+<span class="string">&quot;;&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;mem[&quot;</span>+<span class="built_in">str</span>(ptr)+<span class="string">&quot;]+=&quot;</span>+<span class="built_in">str</span>(progn[i+<span class="number">1</span>])+<span class="string">&quot;;&quot;</span>)</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;[-] UknCode &quot;</span>+<span class="built_in">str</span>(progn[i])+<span class="string">&quot; in progn[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&quot;</span>)</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;return 0;&quot;</span>)</span><br><span class="line">indent-=<span class="number">4</span></span><br><span class="line">print(<span class="string">&#x27; &#x27;</span>*indent+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># 直接转化成C程序</span></span><br></pre></td></tr></table></figure>

<p>得到C程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> mem[<span class="number">1000000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">4</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">5</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">6</span>]);</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">        mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">        mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">8</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">8</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">9</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">9</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">4</span>])&#123;</span><br><span class="line">        mem[<span class="number">4</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">10</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">4</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">4</span>])&#123;</span><br><span class="line">        mem[<span class="number">4</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">10</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">4</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">11</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">11</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">12</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">12</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">7</span>])&#123;</span><br><span class="line">        mem[<span class="number">7</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">        mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">8</span>])&#123;</span><br><span class="line">        mem[<span class="number">8</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">14</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">8</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">14</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">9</span>])&#123;</span><br><span class="line">        mem[<span class="number">9</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">15</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">9</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">15</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">10</span>])&#123;</span><br><span class="line">        mem[<span class="number">10</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">16</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">10</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">4</span>])&#123;</span><br><span class="line">        mem[<span class="number">4</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">16</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">4</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">11</span>])&#123;</span><br><span class="line">        mem[<span class="number">11</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">17</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">11</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">17</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">12</span>])&#123;</span><br><span class="line">        mem[<span class="number">12</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">18</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">12</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">18</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">13</span>])&#123;</span><br><span class="line">        mem[<span class="number">13</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">19</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">        mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">19</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">14</span>])&#123;</span><br><span class="line">        mem[<span class="number">14</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">20</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">14</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">20</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">15</span>])&#123;</span><br><span class="line">        mem[<span class="number">15</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">21</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">15</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">21</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">16</span>])&#123;</span><br><span class="line">        mem[<span class="number">16</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">22</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">16</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">4</span>])&#123;</span><br><span class="line">        mem[<span class="number">4</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">22</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">4</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">17</span>])&#123;</span><br><span class="line">        mem[<span class="number">17</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">23</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">17</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">23</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">18</span>])&#123;</span><br><span class="line">        mem[<span class="number">18</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">24</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">18</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">24</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">19</span>])&#123;</span><br><span class="line">        mem[<span class="number">19</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">25</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">19</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">        mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">25</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">20</span>])&#123;</span><br><span class="line">        mem[<span class="number">20</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">26</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">20</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">26</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">21</span>])&#123;</span><br><span class="line">        mem[<span class="number">21</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">27</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">21</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">27</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">22</span>])&#123;</span><br><span class="line">        mem[<span class="number">22</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">28</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">22</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">4</span>])&#123;</span><br><span class="line">        mem[<span class="number">4</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">28</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">4</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">23</span>])&#123;</span><br><span class="line">        mem[<span class="number">23</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">29</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">23</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">29</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">24</span>])&#123;</span><br><span class="line">        mem[<span class="number">24</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">30</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">24</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">30</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">9</span>])&#123;</span><br><span class="line">        mem[<span class="number">9</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">9</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">16</span>])&#123;</span><br><span class="line">        mem[<span class="number">16</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">16</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">23</span>])&#123;</span><br><span class="line">        mem[<span class="number">23</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">23</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">30</span>])&#123;</span><br><span class="line">        mem[<span class="number">30</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">30</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">25</span>])&#123;</span><br><span class="line">        mem[<span class="number">25</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">25</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">20</span>])&#123;</span><br><span class="line">        mem[<span class="number">20</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">20</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">15</span>])&#123;</span><br><span class="line">        mem[<span class="number">15</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">15</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">10</span>])&#123;</span><br><span class="line">        mem[<span class="number">10</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">10</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">5</span>])&#123;</span><br><span class="line">        mem[<span class="number">5</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">5</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">13</span>])&#123;</span><br><span class="line">        mem[<span class="number">13</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">8</span>])&#123;</span><br><span class="line">        mem[<span class="number">8</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">8</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">22</span>])&#123;</span><br><span class="line">        mem[<span class="number">22</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">22</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">30</span>])&#123;</span><br><span class="line">        mem[<span class="number">30</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">30</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">7</span>])&#123;</span><br><span class="line">        mem[<span class="number">7</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">2</span>])&#123;</span><br><span class="line">        mem[<span class="number">2</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">2</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">21</span>])&#123;</span><br><span class="line">        mem[<span class="number">21</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">21</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">28</span>])&#123;</span><br><span class="line">        mem[<span class="number">28</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">28</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">17</span>])&#123;</span><br><span class="line">        mem[<span class="number">17</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">17</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">8</span>])&#123;</span><br><span class="line">        mem[<span class="number">8</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">8</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">15</span>])&#123;</span><br><span class="line">        mem[<span class="number">15</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">15</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">22</span>])&#123;</span><br><span class="line">        mem[<span class="number">22</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">22</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">29</span>])&#123;</span><br><span class="line">        mem[<span class="number">29</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">29</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">6</span>])&#123;</span><br><span class="line">        mem[<span class="number">6</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">6</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">7</span>])&#123;</span><br><span class="line">        mem[<span class="number">7</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">20</span>])&#123;</span><br><span class="line">        mem[<span class="number">20</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">20</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">3</span>])&#123;</span><br><span class="line">        mem[<span class="number">3</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">3</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">17</span>])&#123;</span><br><span class="line">        mem[<span class="number">17</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">17</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">30</span>])&#123;</span><br><span class="line">        mem[<span class="number">30</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">30</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mem[<span class="number">37</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">37</span>]+=<span class="number">53</span>;</span><br><span class="line">    mem[<span class="number">38</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">38</span>]-=<span class="number">28</span>;</span><br><span class="line">    mem[<span class="number">39</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">39</span>]+=<span class="number">5</span>;</span><br><span class="line">    mem[<span class="number">40</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">40</span>]-=<span class="number">98</span>;</span><br><span class="line">    mem[<span class="number">41</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">41</span>]+=<span class="number">73</span>;</span><br><span class="line">    mem[<span class="number">42</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">42</span>]+=<span class="number">123</span>;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">31</span>])&#123;</span><br><span class="line">        mem[<span class="number">31</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">37</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">31</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">32</span>])&#123;</span><br><span class="line">        mem[<span class="number">32</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">38</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">32</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">33</span>])&#123;</span><br><span class="line">        mem[<span class="number">33</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">39</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">33</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">34</span>])&#123;</span><br><span class="line">        mem[<span class="number">34</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">40</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">34</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">35</span>])&#123;</span><br><span class="line">        mem[<span class="number">35</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">41</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">35</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">36</span>])&#123;</span><br><span class="line">        mem[<span class="number">36</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">42</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">36</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mem[<span class="number">43</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">43</span>]+=<span class="number">48</span>;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">37</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">37</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">38</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">38</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">39</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">39</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">40</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">40</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">41</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">41</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">42</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">42</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">44</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">45</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">46</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">47</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">48</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;mem[<span class="number">49</span>]);</span><br><span class="line">    mem[<span class="number">50</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">50</span>]+=<span class="number">101</span>;</span><br><span class="line">    mem[<span class="number">51</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">51</span>]+=<span class="number">95</span>;</span><br><span class="line">    mem[<span class="number">52</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">52</span>]+=<span class="number">67</span>;</span><br><span class="line">    mem[<span class="number">53</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">53</span>]+=<span class="number">48</span>;</span><br><span class="line">    mem[<span class="number">54</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">54</span>]+=<span class="number">100</span>;</span><br><span class="line">    mem[<span class="number">55</span>]=<span class="number">0</span>;</span><br><span class="line">    mem[<span class="number">55</span>]+=<span class="number">51</span>;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">44</span>])&#123;</span><br><span class="line">        mem[<span class="number">44</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">50</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">44</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">45</span>])&#123;</span><br><span class="line">        mem[<span class="number">45</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">51</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">45</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">46</span>])&#123;</span><br><span class="line">        mem[<span class="number">46</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">52</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">46</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">47</span>])&#123;</span><br><span class="line">        mem[<span class="number">47</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">53</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">47</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">48</span>])&#123;</span><br><span class="line">        mem[<span class="number">48</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">54</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">48</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">49</span>])&#123;</span><br><span class="line">        mem[<span class="number">49</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">55</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">        mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">49</span>]+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">50</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">50</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">51</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">51</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">52</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">52</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">53</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">53</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">54</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">54</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(mem[<span class="number">55</span>])&#123;</span><br><span class="line">        mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">        mem[<span class="number">55</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,mem[<span class="number">43</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>于是现在的任务就成了分两次输入6个字符，经过处理后若mem[43]&#x3D;&#x3D;48（原二进制文件中的判断逻辑）就能得到flag。</p>
<p>这个C程序还是比较冗杂（毕竟九百多行），所以对其进行找规律分析化简。</p>
<p>先拿出前四个while即[line 10, line 27]进行分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">    mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[7]+=mem[1];mem[0]+=mem[1];mem[1]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">    mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[1]+=mem[0];mem[0]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">    mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[7]+=mem[1];mem[0]+=mem[1];mem[1]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">    mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[1]+=mem[0];mem[0]=0;</span></span><br></pre></td></tr></table></figure>

<p>也就是说整段等同于：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">7</span>]+=mem[<span class="number">1</span>]*<span class="number">2</span>;</span><br><span class="line"><span class="comment">// mem[0]和mem[1]没变</span></span><br></pre></td></tr></table></figure>

<p>所以接下来的(6-1)*4个循环也做相同处理，即[line 10, line 117]可以简化为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">7</span>]+=mem[<span class="number">1</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">8</span>]+=mem[<span class="number">2</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">9</span>]+=mem[<span class="number">3</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">10</span>]+=mem[<span class="number">4</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">11</span>]+=mem[<span class="number">5</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">12</span>]+=mem[<span class="number">6</span>]*<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>然后再拿出四个while即[line 118, line 135]进行分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(mem[<span class="number">7</span>])&#123;</span><br><span class="line">    mem[<span class="number">7</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[13]+=mem[7];mem[0]+=mem[7];mem[7]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">    mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">7</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[7]+=mem[0];mem[0]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">1</span>])&#123;</span><br><span class="line">    mem[<span class="number">1</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">13</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">0</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[13]+=mem[1];mem[0]+=mem[1];mem[1]=0;</span></span><br><span class="line"><span class="keyword">while</span>(mem[<span class="number">0</span>])&#123;</span><br><span class="line">    mem[<span class="number">0</span>]-=<span class="number">1</span>;</span><br><span class="line">    mem[<span class="number">1</span>]+=<span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// mem[1]+=mem[0];mem[0]=0;</span></span><br></pre></td></tr></table></figure>

<p>所以整段等同于：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">13</span>]=mem[<span class="number">1</span>]+mem[<span class="number">7</span>];</span><br></pre></td></tr></table></figure>

<p>所以[line 118, line 225]简化为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">13</span>]=mem[<span class="number">1</span>]+mem[<span class="number">7</span>];</span><br><span class="line">mem[<span class="number">14</span>]=mem[<span class="number">2</span>]+mem[<span class="number">8</span>];</span><br><span class="line">mem[<span class="number">15</span>]=mem[<span class="number">3</span>]+mem[<span class="number">9</span>];</span><br><span class="line">mem[<span class="number">16</span>]=mem[<span class="number">4</span>]+mem[<span class="number">10</span>];</span><br><span class="line">mem[<span class="number">17</span>]=mem[<span class="number">5</span>]+mem[<span class="number">11</span>];</span><br><span class="line">mem[<span class="number">18</span>]=mem[<span class="number">6</span>]+mem[<span class="number">12</span>];</span><br></pre></td></tr></table></figure>

<p><strong>最后[line 10, line 803]可简化为</strong>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">7</span>]+=mem[<span class="number">1</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">8</span>]+=mem[<span class="number">2</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">9</span>]+=mem[<span class="number">3</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">10</span>]+=mem[<span class="number">4</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">11</span>]+=mem[<span class="number">5</span>]*<span class="number">2</span>;</span><br><span class="line">mem[<span class="number">12</span>]+=mem[<span class="number">6</span>]*<span class="number">2</span>;</span><br><span class="line"><span class="comment">// [line 10, line 117]</span></span><br><span class="line">mem[<span class="number">13</span>]=mem[<span class="number">1</span>]+mem[<span class="number">7</span>];</span><br><span class="line">mem[<span class="number">14</span>]=mem[<span class="number">2</span>]+mem[<span class="number">8</span>];</span><br><span class="line">mem[<span class="number">15</span>]=mem[<span class="number">3</span>]+mem[<span class="number">9</span>];</span><br><span class="line">mem[<span class="number">16</span>]=mem[<span class="number">4</span>]+mem[<span class="number">10</span>];</span><br><span class="line">mem[<span class="number">17</span>]=mem[<span class="number">5</span>]+mem[<span class="number">11</span>];</span><br><span class="line">mem[<span class="number">18</span>]=mem[<span class="number">6</span>]+mem[<span class="number">12</span>];</span><br><span class="line"><span class="comment">// [line 118, line 225]</span></span><br><span class="line">mem[<span class="number">19</span>]=mem[<span class="number">1</span>]+mem[<span class="number">13</span>];</span><br><span class="line">mem[<span class="number">20</span>]=mem[<span class="number">2</span>]+mem[<span class="number">14</span>];</span><br><span class="line">mem[<span class="number">21</span>]=mem[<span class="number">3</span>]+mem[<span class="number">15</span>];</span><br><span class="line">mem[<span class="number">22</span>]=mem[<span class="number">4</span>]+mem[<span class="number">16</span>];</span><br><span class="line">mem[<span class="number">23</span>]=mem[<span class="number">5</span>]+mem[<span class="number">17</span>];</span><br><span class="line">mem[<span class="number">24</span>]=mem[<span class="number">6</span>]+mem[<span class="number">18</span>];</span><br><span class="line"><span class="comment">// [line 226, line 333]</span></span><br><span class="line">mem[<span class="number">25</span>]=mem[<span class="number">1</span>]+mem[<span class="number">19</span>];</span><br><span class="line">mem[<span class="number">26</span>]=mem[<span class="number">2</span>]+mem[<span class="number">20</span>];</span><br><span class="line">mem[<span class="number">27</span>]=mem[<span class="number">3</span>]+mem[<span class="number">21</span>];</span><br><span class="line">mem[<span class="number">28</span>]=mem[<span class="number">4</span>]+mem[<span class="number">22</span>];</span><br><span class="line">mem[<span class="number">29</span>]=mem[<span class="number">5</span>]+mem[<span class="number">23</span>];</span><br><span class="line">mem[<span class="number">30</span>]=mem[<span class="number">6</span>]+mem[<span class="number">24</span>];</span><br><span class="line"><span class="comment">// [line 334, line 441]</span></span><br><span class="line">mem[<span class="number">31</span>]=mem[<span class="number">2</span>]+mem[<span class="number">9</span>]+mem[<span class="number">16</span>]+mem[<span class="number">23</span>]+mem[<span class="number">30</span>];</span><br><span class="line">mem[<span class="number">32</span>]=mem[<span class="number">25</span>]+mem[<span class="number">20</span>]+mem[<span class="number">15</span>]+mem[<span class="number">10</span>]+mem[<span class="number">5</span>];</span><br><span class="line">mem[<span class="number">33</span>]=mem[<span class="number">13</span>]+mem[<span class="number">8</span>]+mem[<span class="number">3</span>]+mem[<span class="number">22</span>]+mem[<span class="number">30</span>];</span><br><span class="line">mem[<span class="number">34</span>]=mem[<span class="number">7</span>]+mem[<span class="number">2</span>]+mem[<span class="number">21</span>]+mem[<span class="number">28</span>]+mem[<span class="number">17</span>];</span><br><span class="line">mem[<span class="number">35</span>]=mem[<span class="number">8</span>]+mem[<span class="number">15</span>]+mem[<span class="number">22</span>]+mem[<span class="number">29</span>]+mem[<span class="number">6</span>];</span><br><span class="line">mem[<span class="number">36</span>]=mem[<span class="number">7</span>]+mem[<span class="number">20</span>]+mem[<span class="number">3</span>]+mem[<span class="number">17</span>]+mem[<span class="number">30</span>];</span><br><span class="line"><span class="comment">// [line 442, line 711]</span></span><br><span class="line">mem[<span class="number">37</span>]=<span class="number">53</span>;</span><br><span class="line">mem[<span class="number">38</span>]=<span class="number">-28</span>;</span><br><span class="line">mem[<span class="number">39</span>]=<span class="number">5</span>;</span><br><span class="line">mem[<span class="number">40</span>]=<span class="number">-98</span>;</span><br><span class="line">mem[<span class="number">41</span>]=<span class="number">73</span>;</span><br><span class="line">mem[<span class="number">42</span>]=<span class="number">123</span>;</span><br><span class="line"><span class="comment">// [line 712, line 723]</span></span><br><span class="line">mem[<span class="number">37</span>]-=mem[<span class="number">31</span>];</span><br><span class="line">mem[<span class="number">38</span>]-=mem[<span class="number">32</span>];</span><br><span class="line">mem[<span class="number">39</span>]-=mem[<span class="number">33</span>];</span><br><span class="line">mem[<span class="number">40</span>]-=mem[<span class="number">34</span>];</span><br><span class="line">mem[<span class="number">41</span>]-=mem[<span class="number">35</span>];</span><br><span class="line">mem[<span class="number">42</span>]-=mem[<span class="number">36</span>];</span><br><span class="line"><span class="comment">// [line 724, line 777]</span></span><br><span class="line">mem[<span class="number">43</span>]=<span class="number">48</span>;</span><br><span class="line"><span class="comment">// [line 778, line 779]</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">37</span>;i&lt;=<span class="number">42</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(mem[i]) mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [line 780, line 803]</span></span><br></pre></td></tr></table></figure>

<p>后半段输入后，处理的简化程序为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mem[<span class="number">50</span>]=<span class="number">101</span>;</span><br><span class="line">mem[<span class="number">51</span>]=<span class="number">95</span>;</span><br><span class="line">mem[<span class="number">52</span>]=<span class="number">67</span>;</span><br><span class="line">mem[<span class="number">53</span>]=<span class="number">48</span>;</span><br><span class="line">mem[<span class="number">54</span>]=<span class="number">100</span>;</span><br><span class="line">mem[<span class="number">55</span>]=<span class="number">51</span>;</span><br><span class="line"><span class="comment">// [line 810, line 821]</span></span><br><span class="line">mem[<span class="number">50</span>]-=mem[<span class="number">44</span>];</span><br><span class="line">mem[<span class="number">51</span>]-=mem[<span class="number">45</span>];</span><br><span class="line">mem[<span class="number">52</span>]-=mem[<span class="number">46</span>];</span><br><span class="line">mem[<span class="number">53</span>]-=mem[<span class="number">47</span>];</span><br><span class="line">mem[<span class="number">54</span>]-=mem[<span class="number">48</span>];</span><br><span class="line">mem[<span class="number">55</span>]-=mem[<span class="number">49</span>];</span><br><span class="line"><span class="comment">// [line 822, line 875]</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">50</span>;i&lt;=<span class="number">55</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(mem[i]) mem[<span class="number">43</span>]+=<span class="number">1</span>;</span><br><span class="line">    mem[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [line 876, line 899]</span></span><br></pre></td></tr></table></figure>

<p>至此分析完成。</p>
<p>而mem[43]一开始赋值就是48，也就是说两个for循环都不能进到if里。令s[12]为所求字符串，则可以得出方程组：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">1</span>]+s[<span class="number">2</span>]*<span class="number">2</span>+s[<span class="number">3</span>]*<span class="number">3</span>+s[<span class="number">4</span>]*<span class="number">4</span>+s[<span class="number">5</span>]*<span class="number">5</span>==<span class="number">53</span>;<span class="comment">//mem[2]+mem[9]+mem[16]+mem[23]+mem[30]==53;</span></span><br><span class="line">s[<span class="number">0</span>]*<span class="number">5</span>+s[<span class="number">1</span>]*<span class="number">4</span>+s[<span class="number">2</span>]*<span class="number">3</span>+s[<span class="number">3</span>]*<span class="number">2</span>+s[<span class="number">4</span>]*<span class="number">1</span>==<span class="number">-28</span>;<span class="comment">//mem[25]+mem[20]+mem[15]+mem[10]+mem[5]==-28;</span></span><br><span class="line">s[<span class="number">0</span>]*<span class="number">3</span>+s[<span class="number">1</span>]*<span class="number">2</span>+s[<span class="number">2</span>]*<span class="number">1</span>+s[<span class="number">3</span>]*<span class="number">4</span>+s[<span class="number">5</span>]*<span class="number">5</span>==<span class="number">5</span>;<span class="comment">//mem[13]+mem[8]+mem[3]+mem[22]+mem[30]==5;</span></span><br><span class="line">s[<span class="number">0</span>]*<span class="number">2</span>+s[<span class="number">1</span>]*<span class="number">1</span>+s[<span class="number">2</span>]*<span class="number">4</span>+s[<span class="number">3</span>]*<span class="number">5</span>+s[<span class="number">4</span>]*<span class="number">3</span>==<span class="number">-98</span>;<span class="comment">//mem[7]+mem[2]+mem[21]+mem[28]+mem[17]==-98;</span></span><br><span class="line">s[<span class="number">1</span>]*<span class="number">2</span>+s[<span class="number">2</span>]*<span class="number">3</span>+s[<span class="number">3</span>]*<span class="number">4</span>+s[<span class="number">4</span>]*<span class="number">5</span>+s[<span class="number">5</span>]*<span class="number">1</span>==<span class="number">73</span>;<span class="comment">//mem[8]+mem[15]+mem[22]+mem[29]+mem[6]==73;</span></span><br><span class="line">s[<span class="number">0</span>]*<span class="number">2</span>+s[<span class="number">1</span>]*<span class="number">4</span>+s[<span class="number">2</span>]*<span class="number">1</span>+s[<span class="number">4</span>]*<span class="number">3</span>+s[<span class="number">5</span>]*<span class="number">5</span>==<span class="number">123</span>;<span class="comment">//mem[7]+mem[20]+mem[3]+mem[17]+mem[30]==123;</span></span><br><span class="line">s[<span class="number">6</span>]==<span class="number">101</span>;</span><br><span class="line">s[<span class="number">7</span>]==<span class="number">95</span>;</span><br><span class="line">s[<span class="number">8</span>]==<span class="number">67</span>;</span><br><span class="line">s[<span class="number">9</span>]==<span class="number">48</span>;</span><br><span class="line">s[<span class="number">10</span>]==<span class="number">100</span>;</span><br><span class="line">s[<span class="number">11</span>]==<span class="number">51</span>;</span><br></pre></td></tr></table></figure>

<p>因为涉及到char型数据解方程的问题，s[0]-s[5]不好直接出，爆破又太慢了，所以决定构造一个程序用angr破：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// useAngr.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">6</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%6s&quot;</span>,s);</span><br><span class="line">    <span class="keyword">char</span> x1=s[<span class="number">1</span>]+s[<span class="number">2</span>]*<span class="number">2</span>+s[<span class="number">3</span>]*<span class="number">3</span>+s[<span class="number">4</span>]*<span class="number">4</span>+s[<span class="number">5</span>]*<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> x2=s[<span class="number">0</span>]*<span class="number">5</span>+s[<span class="number">1</span>]*<span class="number">4</span>+s[<span class="number">2</span>]*<span class="number">3</span>+s[<span class="number">3</span>]*<span class="number">2</span>+s[<span class="number">4</span>]*<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> x3=s[<span class="number">0</span>]*<span class="number">3</span>+s[<span class="number">1</span>]*<span class="number">2</span>+s[<span class="number">2</span>]*<span class="number">1</span>+s[<span class="number">3</span>]*<span class="number">4</span>+s[<span class="number">5</span>]*<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> x4=s[<span class="number">0</span>]*<span class="number">2</span>+s[<span class="number">1</span>]*<span class="number">1</span>+s[<span class="number">2</span>]*<span class="number">4</span>+s[<span class="number">3</span>]*<span class="number">5</span>+s[<span class="number">4</span>]*<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">char</span> x5=s[<span class="number">1</span>]*<span class="number">2</span>+s[<span class="number">2</span>]*<span class="number">3</span>+s[<span class="number">3</span>]*<span class="number">4</span>+s[<span class="number">4</span>]*<span class="number">5</span>+s[<span class="number">5</span>]*<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> x6=s[<span class="number">0</span>]*<span class="number">2</span>+s[<span class="number">1</span>]*<span class="number">4</span>+s[<span class="number">2</span>]*<span class="number">1</span>+s[<span class="number">4</span>]*<span class="number">3</span>+s[<span class="number">5</span>]*<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">if</span>(x1==<span class="number">53</span>&amp;&amp;x2==<span class="number">-28</span>&amp;&amp;x3==<span class="number">5</span>&amp;&amp;x4==<span class="number">-98</span>&amp;&amp;x5==<span class="number">73</span>&amp;&amp;x6==<span class="number">123</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Congratulations!!!!!!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>useAngr_exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">t=time.clock()</span><br><span class="line">path_to_binary=<span class="string">&#x27;./useAngr&#x27;</span></span><br><span class="line">project=angr.Project(path_to_binary,auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">initial_state=project.factory.entry_state()</span><br><span class="line">simulation=project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">find_address=<span class="number">0x4008CC</span></span><br><span class="line">simulation.one_active.options.add(angr.options.LAZY_SOLVES)</span><br><span class="line">simulation.explore(find=find_address)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;time:&#x27;</span>,<span class="built_in">round</span>(time.clock()-t,<span class="number">2</span>),<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">    solution_state=simulation.found[<span class="number">0</span>]</span><br><span class="line">    print(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution. _0x0_&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>解得：</p>
<p><img src="/p/wpFor-2020XCTF/image-20210123225114504.png"></p>
<p>有不可见字符，不过可以通过-0x80得到可见字符（估计是前面判定+和-的地方有点出入，问题不大）。</p>
<p>最后整理得到字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">key1=<span class="string">b&#x27;\xd23v\xe5\xd2\xd3&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> key1:</span><br><span class="line">    <span class="keyword">if</span> c&gt;<span class="number">0x7f</span>:</span><br><span class="line">        print(<span class="built_in">chr</span>(c<span class="number">-0x80</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="built_in">chr</span>(c),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">key2=[<span class="number">101</span>,<span class="number">95</span>,<span class="number">67</span>,<span class="number">48</span>,<span class="number">100</span>,<span class="number">51</span>]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> key2:</span><br><span class="line">    print(<span class="built_in">chr</span>(x),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20210123225812567.png"></p>
<p>由于要连远程拿flag，所以复现的时候只有本地打通没有flag，打通撒花~</p>
<p><img src="/p/wpFor-2020XCTF/image-20210123225914910.png"></p>
<p><strong>R3veRSe_C0d3</strong></p>
<hr>
<h1 id="12-27-HarmonyOS和HMS专场"><a href="#12-27-HarmonyOS和HMS专场" class="headerlink" title="[12.27] HarmonyOS和HMS专场"></a>[12.27] HarmonyOS和HMS专场</h1><blockquote>
<p>难得有一场ak逆向了！（虽然有大佬带着</p>
<p>有三道题都是卡着四血交，实惨TAT</p>
</blockquote>
<h2 id="re123"><a href="#re123" class="headerlink" title="re123"></a>re123</h2><p>用file命令可以看到是MS Windows HtmlHelp Data文件（即.chm），查看文件头也可以知道。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229191137544.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20201229191253926.png"></p>
<p>所以添加后缀名.chm。</p>
<p>关于chm文件有一个常用的反编译器ChmDecompiler，可以释放CHM里面的全部源文件（包括网页、文本、图片、CHM、ZIP、EXE等全部源文件），并且完美地恢复源文件的全部目录结构 <del>（摘抄的简介</del>。</p>
<p>所以用ChmDecompiler打开re.chm，解压缩，可以看到目录下出现一个包含四个文件的文件夹（其实源文件只有三个，.hhp是ChmDecompiler自动生成的）。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229191554582.png"></p>
<p>一个一个翻可以看到doc.htm里有一段奇怪的Item1。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229192220277.png"></p>
<p>大概可以看到是powershell的语法？（感觉像win后门，这么多no的参数</p>
<p>查了一下其实就是把后面那大段进行base64解码而已，用wsl解一下base64有</p>
<p><img src="/p/wpFor-2020XCTF/nTe52VJs0Ho9ZDxh7sTOyw.jpg" alt="img"></p>
<p>然后得到了一段.NET代码（白字）。</p>
<p>通过查微软文档可以知道，这里是把base64解码以后的字符进行Deflate解压的过程，所以用脚本把中间那段base64解码，并整理输出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deflate</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> zlib.decompress(data, -zlib.MAX_WBITS)</span><br><span class="line">    <span class="keyword">except</span> zlib.error:</span><br><span class="line">        <span class="keyword">return</span> zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">code=<span class="string">&#x27;TY5BC4IwGIbvgv9hjB2McJhEhNChJMGTkN2qg7qvFHQT/bL575vpoV2/53n2skJJBInkQG5xwqOqhkcQXCATx7q+gkaHsvYj7kIVvCgburItVgm9MTxbVB5LATp5OlQvb6IMV0LdQvdPpu+8x66SL2eOrMl+Ck7naUA69ggND5UcoEOzI+pUc8p62G3TRZubv34K6IbLespADoGR27vv+R7HpqXzt8Q9y0IJI5N8RLCtLw==&#x27;</span></span><br><span class="line">de_code=deflate(base64.b64decode(code)).decode()</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> de_code.split(<span class="string">&#x27;\r\n&#x27;</span>):</span><br><span class="line">    print(x)</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20201229193302890.png"></p>
<p>很明显的逻辑了，把doc.chm（应该是原来的re.chm）中”xxxxxxxx”后面的部分提取出来，还是用base64解码得到文件。</p>
<p><img src="/p/wpFor-2020XCTF/f3TgvbZfbMKJow7IhgNlKA.jpg" alt="img"></p>
<p>把这后面的内容手动复制出来到cont.txt里，进行base64解码，最后存在theFile中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base64 -d cont.txt &gt; theFile</span><br></pre></td></tr></table></figure>

<p>查看theFile可以猜测是exe（毕竟最开始给的就是有powershell指令的base64），把文件头补上，并改后缀名（即theFile.exe）。</p>
<p><img src="/p/wpFor-2020XCTF/jAAyrn9wsYFQ6IlOFM9BfA.jpg" alt="img"></p>
<p>用ida打开，通过FindCrypt插件可以看到AES，跟过去能看到AES加密时的S盒（其实这里前两个都是S盒，第三个是逆S盒），猜测用到了AES加密。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229195213434.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20201229195456197.png"></p>
<p>往上回溯找到主函数</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229195646671.png"></p>
<p>显然，这里是AES加密过程，sub_180001100()是密钥拓展过程，sub_1800015B0()是AES加密。</p>
<blockquote>
<p>关于逆向中各种常见密码的记录，指路：<a target="_blank" rel="noopener" href="https://yfli.top/2020/02/18/encrypt_document/#more">对称加密算法&amp;&amp;Hash算法 文档 | feng’s blog</a></p>
</blockquote>
<p>看了一下感觉是原装无魔改的AES，密文密钥都给了，那就直接写脚本解密。</p>
<p>注意这里是以整数形式给出的，别忘了小端序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">arr=[<span class="number">0x16157E2B</span>,<span class="number">0xA6D2AE28</span>,<span class="number">0x8815F7AB</span>,<span class="number">0x3C4FCF09</span>]</span><br><span class="line">key=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key=<span class="built_in">hex</span>(arr[i])[<span class="number">2</span>:]+key</span><br><span class="line">key=unhexlify(key)[::<span class="number">-1</span>] <span class="comment">#注意小端序的问题</span></span><br><span class="line">tmp=<span class="number">0x46C42084AA2A1B56E799D643453FF4B5</span></span><br><span class="line">cipher=unhexlify(<span class="built_in">hex</span>(tmp)[<span class="number">2</span>:])[::<span class="number">-1</span>]</span><br><span class="line">enc=AES.new(key,AES.MODE_ECB)</span><br><span class="line">print(enc.decrypt(cipher))</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20201229202801230.png"></p>
<p><strong>flag{youcangues}</strong></p>
<h2 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h2><p>mips架构。</p>
<p>加载进ida以后，通过字符串回溯找到主函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229203258179.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20201229203319240.png"></p>
<p>可以看到很明显的sub_401134()这个check，先往这里面看。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229203405086.png"></p>
<p>看到是一个疑似maze的逻辑（</p>
<p>不过sub_400FA8()点进去以后可以看到是swap的功能</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229203651570.png"></p>
<p>所以应该不是maze，是一个以交换为主的逻辑。</p>
<p>至于dword_4A0010，可以看到是一个九个数的数组。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229203733240.png"></p>
<p>v4和v5的出处在switch逻辑上面一点</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229204029832.png"></p>
<p>可以看到最后(v4,v5)其实表示了数组里0的位置，且数组实际可以看成是3*3。</p>
<p>即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4 0 3</span><br><span class="line">7 2 6</span><br><span class="line">8 1 5</span><br></pre></td></tr></table></figure>

<p>最后sub_400FFC()的检查逻辑：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229204442580.png"></p>
<p>实际上就是要让这个3*3等于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br><span class="line">4 5 6</span><br><span class="line">7 8 0</span><br></pre></td></tr></table></figure>

<p>把0看成空位的话，很容易就想到3*3的华容道了。</p>
<p>（或者玩算法的小伙伴可能对八数码问题这个名字更熟悉？</p>
<p><del>有本事下次出数织啊！20*20我都给你火速解出来（来自数织爱好者的吐槽）</del></p>
<p>这里实际上是求最短能得到的路径（15步），懒得想了，直接去网上抓了个现成代码下来改了改。</p>
<blockquote>
<p>八数码问题的代码见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/lishang6257/article/details/79732420">八数码问题-A*(AStar)算法实现_Broken Geeker-CSDN博客</a></p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxState 10000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isEqual</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> b[N][N],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j][n] != b[i][j]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isEqual</span><span class="params">(<span class="keyword">int</span> a[N][N],<span class="keyword">int</span> b[N][N])</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j] != b[i][j]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">evalute</span><span class="params">(<span class="keyword">int</span> state[N][N],<span class="keyword">int</span> target[N][N])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)</span><br><span class="line">            <span class="keyword">if</span>(state[i][j] != target[i][j]) num ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findBrack</span><span class="params">(<span class="keyword">int</span> a[N][N],<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j] == <span class="number">0</span>) &#123;</span><br><span class="line">                x = i;y = j;<span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> a[N][N],<span class="keyword">int</span> b[N][N],<span class="keyword">int</span> dir)</span></span>&#123;</span><br><span class="line">    <span class="comment">//1 up 2 down 3 left 4 right</span></span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>,y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            b[i][j] = a[i][j];</span><br><span class="line">            <span class="keyword">if</span>(a[i][j] == <span class="number">0</span>) &#123;</span><br><span class="line">                x = i;y = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">0</span> &amp;&amp; dir == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(x == N<span class="number">-1</span> &amp;&amp; dir == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">0</span> &amp;&amp; dir == <span class="number">3</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(y == N<span class="number">-1</span> &amp;&amp; dir == <span class="number">4</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(dir == <span class="number">1</span>)&#123;b[x<span class="number">-1</span>][y] = <span class="number">0</span>;b[x][y] = a[x<span class="number">-1</span>][y];&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dir == <span class="number">2</span>)&#123;b[x+<span class="number">1</span>][y] = <span class="number">0</span>;b[x][y] = a[x+<span class="number">1</span>][y];&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dir == <span class="number">3</span>)&#123;b[x][y<span class="number">-1</span>] = <span class="number">0</span>;b[x][y] = a[x][y<span class="number">-1</span>];&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(dir == <span class="number">4</span>)&#123;b[x][y+<span class="number">1</span>] = <span class="number">0</span>;b[x][y] = a[x][y+<span class="number">1</span>];&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">statecpy</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> b[N][N],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            a[i][j][n] = b[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getState</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> b[N][N],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            b[i][j] = a[i][j][n];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">statecpy</span><span class="params">(<span class="keyword">int</span> a[N][N],<span class="keyword">int</span> b[N][N])</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">            a[i][j] = b[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkAdd</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> b[N][N],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(isEqual(a,b,i)) <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Astar</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> start[N][N],<span class="keyword">int</span> target[N][N],<span class="keyword">int</span> path[maxState])</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> visited[maxState] = &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> fitness[maxState] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> passLen[maxState] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> curpos[N][N];</span><br><span class="line">    statecpy(curpos,start);</span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>,Curid = <span class="number">0</span>;</span><br><span class="line">    fitness[id] = evalute(curpos,target);</span><br><span class="line">    statecpy(a,start,id++);</span><br><span class="line">    <span class="keyword">while</span>(!isEqual(curpos,target))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">5</span>;i ++)&#123;<span class="comment">//向四周找方向</span></span><br><span class="line">            <span class="keyword">int</span> tmp[N][N] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">if</span>(move(curpos,tmp,i))&#123;</span><br><span class="line">                <span class="keyword">int</span> state = checkAdd(a,tmp,id);</span><br><span class="line">                <span class="keyword">if</span>(state == <span class="number">-1</span>)&#123;<span class="comment">//not add</span></span><br><span class="line">                    path[id] = Curid;</span><br><span class="line">                    passLen[id] = passLen[Curid] + <span class="number">1</span>;</span><br><span class="line">                    fitness[id] = evalute(tmp,target) + passLen[id];</span><br><span class="line">                    statecpy(a,tmp,id++);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;<span class="comment">//add</span></span><br><span class="line">                    <span class="keyword">int</span> len = passLen[Curid] + <span class="number">1</span>,fit = evalute(tmp,target) + len;</span><br><span class="line">                    <span class="keyword">if</span>(fit &lt; fitness[state])&#123;</span><br><span class="line">                        path[state] = Curid;</span><br><span class="line">                        passLen[state] = len;</span><br><span class="line">                        fitness[state] = fit;</span><br><span class="line">                        visited[state] = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        visited[Curid] = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//找到适应度最小的最为下一个带搜索节点</span></span><br><span class="line">        <span class="keyword">int</span> minCur = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; id;i ++)</span><br><span class="line">            <span class="keyword">if</span>(!visited[i] &amp;&amp; (minCur == <span class="number">-1</span> || fitness[i] &lt; fitness[minCur])) minCur = i;</span><br><span class="line">        Curid = minCur;</span><br><span class="line">        getState(a,curpos,Curid);</span><br><span class="line">        <span class="keyword">if</span>(id == maxState) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Curid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a[N][N][maxState],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-------------------------------\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>;j &lt; N;j ++)&#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; a[i][j][n] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-------------------------------\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calDe</span><span class="params">(<span class="keyword">int</span> a[N][N])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N*N;i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>;j &lt; N*N;j ++)&#123;</span><br><span class="line">            <span class="keyword">int</span> m,n,c,d;</span><br><span class="line">            m = i/N;n = i%N;</span><br><span class="line">            c = j/N;d = j%N;</span><br><span class="line">            <span class="keyword">if</span>(a[c][d] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(a[m][n] &gt; a[c][d]) sum ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">autoGenerate</span><span class="params">(<span class="keyword">int</span> a[N][N])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> maxMove = <span class="number">50</span>;</span><br><span class="line">    srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="keyword">int</span> tmp[N][N];</span><br><span class="line">    <span class="keyword">while</span>(maxMove --)&#123;</span><br><span class="line">        <span class="keyword">int</span> dir = rand()%<span class="number">4</span> + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(move(a,tmp,dir)) statecpy(a,tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[N][N][maxState] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="comment">// int start[N][N] = &#123;1,2,3,4,5,6,7,8,0&#125;;</span></span><br><span class="line">    <span class="comment">// autoGenerate(start);</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; start[0][0] &lt;&lt; start[1][1];</span></span><br><span class="line">    <span class="keyword">int</span> start[N][N] = &#123;<span class="number">4</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">5</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> target[N][N] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span>(!(calDe(start)%<span class="number">2</span> == calDe(target)%<span class="number">2</span>))&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无解\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> path[maxState] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> res =  Astar(a,start,target,path);</span><br><span class="line">    <span class="keyword">if</span>(res == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;达到最大搜索能力\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> shortest[maxState] = &#123;<span class="number">0</span>&#125;,j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(res != <span class="number">0</span>)&#123;</span><br><span class="line">        shortest[j++] = res;</span><br><span class="line">        res = path[res];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;第 0 步\n&quot;</span>;</span><br><span class="line">    show(a,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = j - <span class="number">1</span>;i &gt;= <span class="number">0</span>;i --)&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;第 &quot;</span> &lt;&lt; j-i &lt;&lt; <span class="string">&quot; 步\n&quot;</span>;</span><br><span class="line">        show(a,shortest[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到每一步的情况，进而根据switch写出路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">第 0 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 0 3</span><br><span class="line">7 2 6</span><br><span class="line">8 1 5</span><br><span class="line">-------------------------------</span><br><span class="line">第 1 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 2 3</span><br><span class="line">7 0 6</span><br><span class="line">8 1 5</span><br><span class="line">-------------------------------</span><br><span class="line">第 2 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 2 3</span><br><span class="line">7 1 6</span><br><span class="line">8 0 5</span><br><span class="line">-------------------------------</span><br><span class="line">第 3 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 2 3</span><br><span class="line">7 1 6</span><br><span class="line">8 5 0</span><br><span class="line">-------------------------------</span><br><span class="line">第 4 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 2 3</span><br><span class="line">7 1 0</span><br><span class="line">8 5 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 5 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 2 0</span><br><span class="line">7 1 3</span><br><span class="line">8 5 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 6 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 0 2</span><br><span class="line">7 1 3</span><br><span class="line">8 5 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 7 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 1 2</span><br><span class="line">7 0 3</span><br><span class="line">8 5 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 8 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 1 2</span><br><span class="line">7 5 3</span><br><span class="line">8 0 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 9 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 1 2</span><br><span class="line">7 5 3</span><br><span class="line">0 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 10 步</span><br><span class="line">-------------------------------</span><br><span class="line">4 1 2</span><br><span class="line">0 5 3</span><br><span class="line">7 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 11 步</span><br><span class="line">-------------------------------</span><br><span class="line">0 1 2</span><br><span class="line">4 5 3</span><br><span class="line">7 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 12 步</span><br><span class="line">-------------------------------</span><br><span class="line">1 0 2</span><br><span class="line">4 5 3</span><br><span class="line">7 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 13 步</span><br><span class="line">-------------------------------</span><br><span class="line">1 2 0</span><br><span class="line">4 5 3</span><br><span class="line">7 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 14 步</span><br><span class="line">-------------------------------</span><br><span class="line">1 2 3</span><br><span class="line">4 5 0</span><br><span class="line">7 8 6</span><br><span class="line">-------------------------------</span><br><span class="line">第 15 步</span><br><span class="line">-------------------------------</span><br><span class="line">1 2 3</span><br><span class="line">4 5 6</span><br><span class="line">7 8 0</span><br><span class="line">-------------------------------</span><br><span class="line"></span><br><span class="line">6 左</span><br><span class="line">2 上</span><br><span class="line">4 右</span><br><span class="line">8 下</span><br><span class="line">&#x2F;&#x2F; 884226886224488</span><br></pre></td></tr></table></figure>

<p>路径为“884226886224488”。</p>
<p>接下来看主函数里check上面的部分，看到sub_409070()实际上是一个scanf，而dword_4A1B60是我们的输入，也就是最后的flag，中间对输入进行处理以后才得到“884226886224488”这个字符串。</p>
<p>在里面翻可以翻到一个sub_400B58()，猜测是base64换表编码。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229205535378.png"></p>
<p>于是尝试写脚本编码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">b64table=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">mytable=<span class="string">&quot;&quot;</span></span><br><span class="line">offset=<span class="number">-18</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b64table)):</span><br><span class="line">    mytable+=b64table[(i+offset)%<span class="built_in">len</span>(b64table)]</span><br><span class="line">text=<span class="string">&quot;884226886224488&quot;</span>.encode()</span><br><span class="line">cipher=base64.b64encode(text).decode().translate(<span class="built_in">str</span>.maketrans(b64table,mytable))</span><br><span class="line">print(cipher)</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20201229210535246.png"></p>
<p>试试能不能过check。</p>
<p>wsl运行：（要装qemu才能执行，毕竟特殊架构。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp $(which qemu-mips) .</span><br><span class="line">./qemu-mips -L . ./puzzle</span><br></pre></td></tr></table></figure>

<p>执行mips程序，输入脚本中解出的字符串，发现成功了，get flag。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229210455631.png"></p>
<p><strong>flag{8xOi6R2k8xOk6R2i7xOm}</strong></p>
<h2 id="aRm"><a href="#aRm" class="headerlink" title="aRm"></a>aRm</h2><p>arm架构。</p>
<p>照例通过字符串回溯找到主函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201229220910936.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20201229222635806.png"></p>
<p>v1是key，v9是输入的flag，对输入的限制就是长度为42且头尾是“flag{”和“}”。</p>
<p>动态调一下可以发现，sub_27770()这个函数实际上是把unk_723A0数组里的42个数据复制到v8里。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./qemu-arm -L ./ -g 12345 ./aRm</span><br></pre></td></tr></table></figure>

<p>（Debugger选Remote GDB debugger，把端口号填上就好，其余配置具体见<a href="https://c10udlnk.top/p/reSkillsOn-Debugging/">RE套路 - 关于使用IDA 7.0前端进行的动态调试 | c10udlnk_Log</a>中调试elf部分。</p>
<p>现在我们未知的数就剩v5和v6了，v5要看sub_1714C()的输出，v6这里相当于是42条42元一次方程组（输入未知的情况下）。</p>
<p>而sub_105B4()是输出42个结果，于是可以知道只要输出了output.txt里的42个数就是正确的flag了。</p>
<p>由于前面有一个sub_169AC(key)，这边又是一个无参的sub_1714C()+1，于是猜测是srand(seed)和rand()。</p>
<p>为了证明猜测，多次运行程序输入同一个key和相同&#x2F;不同的flag，发现每一次的v5是一样的，结合rand()的伪随机性，确定这就是随机函数。</p>
<p>由于key只有一字节（0~255），干脆直接爆破。把output.txt的数据读入，用sympy库解方程，只要第一个解x0等于<code>ord(&#39;f&#39;)^v8[0]=102^0xA0=198</code>，就说明这个key有极大可能性是正确的key。</p>
<p>当然，在此之前，我们得先知道每一次的v5（即方程的系数）是多少。</p>
<p>于是hook函数，在v5生成之后复用程序原来就有的print函数及格式符，把每次生成的v5都打印出来。</p>
<p>还记得有个函数是可以输出八位十六进制数的吧，就是那个sub_105B4()，我们可以用这里面的printf，然后把调用这个函数的地方nop掉（目标要明确，现在是为了爆破key，没必要管程序的正常性hahah）。</p>
<blockquote>
<p>本来是想自己堆个调用printf出来的，不知道为什么keypatch对<code>LDR     R0, =a08x</code>解释不了，于是只好绕个小路了。</p>
</blockquote>
<p><img src="/p/wpFor-2020XCTF/image-20201230134100558.png"></p>
<p>转到汇编窗口，记一下这里的loc，等会要跳过来的。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230134235154.png"></p>
<p>看回去原来二重循环里出v5那个地方</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230134326684.png"></p>
<p>这几条语句的意思就是f5里面的那行<code>v5 = (unsigned __int8)(sub_1714C() + 1);</code>，我们从再下一行开始改。</p>
<p>注意可以改的范围在蓝框这里，这是我们不需要的<code>v6[j] += (unsigned __int8)v9[k] * v5;</code>，在这个范围里可以尽情修改，剩下的nop掉。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230134904926.png"></p>
<p>用keypatch直接输入汇编，patch后面的语句为</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230135257443.png"></p>
<p>（其实就是改了一行<code>B       loc_105D4</code>，剩下的直接Fill with NOPs就好）</p>
<p>接下来去往loc_105D4，改造一下。</p>
<p>我们知道，现在R3寄存器里实际上存的是v5的值，我们调用printf直接输出R3的值就能达成目标。</p>
<p>在ARM汇编里，函数传参用R0、R1……所以我们这里给R1一个R3的值就好。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230135756039.png"></p>
<p>这里本来就是<code>MOV     R1, R3</code>不用改，所以直接把前面nop掉。</p>
<p>因为v5那里是取(unsigned __int8)，所以把这里改一下，把”%08x”改成”%02x”，就是出来的v5。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230141148584.png"></p>
<p>别忘了后面还要跳回去，找到地址：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230140112007.png"></p>
<p>patch：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230140621270.png"></p>
<p>记得把调用sub_105B4()的地方也nop掉。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230140838366.png"></p>
<p>最后把patch的字节保存一下。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230140754908.png"></p>
<p>运行测试一下，有：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230142921253.png"></p>
<p>ok，hook成功，开始爆破。</p>
<blockquote>
<p>用pexpect进行批量的自动化交互见：<a href="https://c10udlnk.top/p/wpFor-2020chamd5XMAS/">【wp】2020ChaMd5圣诞题 | c10udlnk_Log</a></p>
<p>多亏了周五做的那个题，才有了这个题的爆破脚本（Doge。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data=[]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    tmp=f.read().split(<span class="string">&#x27;\r\n&#x27;</span>)</span><br><span class="line">    data=[<span class="built_in">int</span>(x,<span class="number">16</span>) <span class="keyword">for</span> x <span class="keyword">in</span> tmp]</span><br><span class="line">src=[<span class="number">0xA0</span>, <span class="number">0xE4</span>, <span class="number">0xBA</span>, <span class="number">0xFB</span>, <span class="number">0x10</span>, <span class="number">0xDD</span>, <span class="number">0xAC</span>, <span class="number">0x65</span>, <span class="number">0x8D</span>, <span class="number">0x0B</span>, <span class="number">0x57</span>, <span class="number">0x1A</span>, <span class="number">0xE4</span>, <span class="number">0x28</span>, <span class="number">0x96</span>, <span class="number">0xB3</span>, <span class="number">0x0C</span>, <span class="number">0x79</span>, <span class="number">0x4D</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x99</span>, <span class="number">0x58</span>, <span class="number">0xFE</span>, <span class="number">0x50</span>, <span class="number">0xD3</span>, <span class="number">0xF9</span>, <span class="number">0x3C</span>, <span class="number">0x0F</span>, <span class="number">0xC1</span>, <span class="number">0xE3</span>, <span class="number">0xA6</span>, <span class="number">0x39</span>, <span class="number">0xC3</span>, <span class="number">0x28</span>, <span class="number">0x75</span>, <span class="number">0xF8</span>, <span class="number">0xC9</span>, <span class="number">0xC8</span>, <span class="number">0xCD</span>, <span class="number">0x78</span>, <span class="number">0x26</span>]</span><br><span class="line">flag=<span class="string">&#x27;flag&#123;000000000000000000000000000000000000&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">var=[]</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    exec(<span class="string">&quot;x&quot;</span>+<span class="built_in">str</span>(num)+<span class="string">&quot;=Symbol(&#x27;x&#x27;+str(num))&quot;</span>)</span><br><span class="line">    var.append(<span class="string">&quot;x&quot;</span>+<span class="built_in">str</span>(num)) <span class="comment">#创建42个变量x0~x41</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    r=pexpect.spawn(<span class="string">&#x27;./qemu-arm -L ./ ./aRm_getRand&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">    r.sendline(flag)</span><br><span class="line">    r.readline()</span><br><span class="line">    r.readline()</span><br><span class="line">    rand=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>*<span class="number">42</span>):</span><br><span class="line">        s=r.readline()</span><br><span class="line">        rand.append(<span class="built_in">int</span>(<span class="built_in">str</span>(s)[<span class="number">2</span>:<span class="number">-5</span>],<span class="number">16</span>))</span><br><span class="line">    r.wait()</span><br><span class="line">    exper=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">        anEx=<span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">            anEx+=<span class="built_in">str</span>(rand[j*<span class="number">42</span>+k])+<span class="string">&quot;*&quot;</span>+var[k]+<span class="string">&quot;+&quot;</span></span><br><span class="line">        anEx=anEx[:<span class="number">-1</span>]+<span class="string">&quot;-&quot;</span>+<span class="built_in">str</span>(data[j])</span><br><span class="line">        exper.append(anEx)</span><br><span class="line">    res=solve(exper,var)</span><br><span class="line">    print(<span class="built_in">str</span>(i)+<span class="string">&quot;: &quot;</span>)</span><br><span class="line">    print(res.values())</span><br></pre></td></tr></table></figure>

<p>爆破得到：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201228135416441.png"></p>
<p>可知key是82，而v9在xor以后的数组也爆出来了，简单xor得flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr=[<span class="number">0xA0</span>, <span class="number">0xE4</span>, <span class="number">0xBA</span>, <span class="number">0xFB</span>, <span class="number">0x10</span>, <span class="number">0xDD</span>, <span class="number">0xAC</span>, <span class="number">0x65</span>, <span class="number">0x8D</span>, <span class="number">0x0B</span>, <span class="number">0x57</span>, <span class="number">0x1A</span>, <span class="number">0xE4</span>, <span class="number">0x28</span>, <span class="number">0x96</span>, <span class="number">0xB3</span>, <span class="number">0x0C</span>, <span class="number">0x79</span>, <span class="number">0x4D</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x99</span>, <span class="number">0x58</span>, <span class="number">0xFE</span>, <span class="number">0x50</span>, <span class="number">0xD3</span>, <span class="number">0xF9</span>, <span class="number">0x3C</span>, <span class="number">0x0F</span>, <span class="number">0xC1</span>, <span class="number">0xE3</span>, <span class="number">0xA6</span>, <span class="number">0x39</span>, <span class="number">0xC3</span>, <span class="number">0x28</span>, <span class="number">0x75</span>, <span class="number">0xF8</span>, <span class="number">0xC9</span>, <span class="number">0xC8</span>, <span class="number">0xCD</span>, <span class="number">0x78</span>, <span class="number">0x26</span>]</span><br><span class="line">x=[<span class="number">198</span>, <span class="number">136</span>, <span class="number">219</span>, <span class="number">156</span>, <span class="number">107</span>, <span class="number">228</span>, <span class="number">152</span>, <span class="number">7</span>, <span class="number">239</span>, <span class="number">63</span>, <span class="number">97</span>, <span class="number">127</span>, <span class="number">134</span>, <span class="number">5</span>, <span class="number">247</span>, <span class="number">131</span>, <span class="number">109</span>, <span class="number">75</span>, <span class="number">96</span>, <span class="number">180</span>, <span class="number">241</span>, <span class="number">173</span>, <span class="number">57</span>, <span class="number">211</span>, <span class="number">49</span>, <span class="number">224</span>, <span class="number">157</span>, <span class="number">9</span>, <span class="number">34</span>, <span class="number">243</span>, <span class="number">129</span>, <span class="number">199</span>, <span class="number">1</span>, <span class="number">244</span>, <span class="number">31</span>, <span class="number">17</span>, <span class="number">157</span>, <span class="number">171</span>, <span class="number">252</span>, <span class="number">249</span>, <span class="number">64</span>, <span class="number">91</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(x[i]^arr[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p><img src="/p/wpFor-2020XCTF/image-20201230002706300.png"></p>
<p><strong>flag{94bb46eb-a0a2-4a4a-a3d5-2ba877deb448}</strong></p>
<h2 id="pe"><a href="#pe" class="headerlink" title="pe"></a>pe</h2><p>arm架构，没环境调不动，只能硬看了XD。这题有好多奇怪的函数，而且通过伪代码跟的话就能看到函数套函数套函数……所以基本靠猜出来的（</p>
<p>继续通过字符串回溯找主函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230004038936.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20201230004436275.png"></p>
<p>根据参数猜测，sub_1400023C8()是strcmp()的作用，我们需要让v9&#x3D;”KIMLXDWRZXTHXTHQTXTXHZWC”。</p>
<p>再往上走，sub_1400015B0这个函数调用了v9，于是跟进去看功能。</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230085247002.png"></p>
<p>感觉是某种加密，以相邻的两字符为一组，对这两个字符做相同的操作，再做后续处理。</p>
<p>跟进sub_1400012B8()里看，可以看到大概是一个搜索的过程</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230122448387.png"></p>
<p>如果不等于-1就说明在表中找到了这个元素，然后返回一个索引（？</p>
<p>再往下看好像就看不太懂了，然后就是玄学的猜猜猜&#x3D; &#x3D;</p>
<p>回去看string可以看到一个这个，猜测是密钥表之类的？</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230123304290.png"></p>
<p>往上回溯也看不到什么线索，不过可以发现这25个数字刚好没有相同的。</p>
<p>现在总结一下这个古典加密算法的特点，大概是两个为一组处理+已定义的密钥表（即不是通过输入生成的）5*5+处理时用到索引。</p>
<p><del>很久很久以前想写某对cp的AU同人时想把ctf元素混进去，就看了很多简单又奇奇怪怪的编码&#x2F;古典密码（现代密码太学术了XD），没想到现在有用武之地了（手动狗头。</del></p>
<blockquote>
<p>安利一个编码&#x2F;古典密码的集合：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mq0036/p/6544055.html">CTF中那些脑洞大开的编码和加密 - jack_Meng - 博客园</a></p>
</blockquote>
<p>然后翻到了一个符合这个特点的密码，Playfair Cipher：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230124909385.png"></p>
<p>不同的是密码表是直接给出的，不过加密流程再对回ida里的反编译感觉挺像的，于是果断试试。</p>
<p>按照Playfair Cipher的加解密流程写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getIndex</span>(<span class="params">c</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        <span class="keyword">if</span> key[i].find(c)!=<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">return</span> i,key[i].find(c)</span><br><span class="line">letter_list=<span class="string">&quot;ABCDEFGHJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">key=[<span class="string">&quot;CREIH&quot;</span>,<span class="string">&quot;TQGNU&quot;</span>,<span class="string">&quot;AOVXL&quot;</span>,<span class="string">&quot;DZKYM&quot;</span>,<span class="string">&quot;PBWFS&quot;</span>]</span><br><span class="line">cipher=<span class="string">&quot;KIMLXDWRZXTHXTHQTXTXHZWC&quot;</span></span><br><span class="line">text=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(cipher),<span class="number">2</span>):</span><br><span class="line">    j=i+<span class="number">1</span></span><br><span class="line">    x1,y1=getIndex(cipher[i])</span><br><span class="line">    x2,y2=getIndex(cipher[j])</span><br><span class="line">    <span class="keyword">if</span> x1==x2:</span><br><span class="line">        text+=key[x1][(y1+<span class="number">1</span>)%<span class="number">5</span>]+key[x2][(y2+<span class="number">1</span>)%<span class="number">5</span>]</span><br><span class="line">    <span class="keyword">elif</span> y1==y2:</span><br><span class="line">        text+=key[(x1+<span class="number">1</span>)%<span class="number">5</span>][y1]+key[(x2+<span class="number">1</span>)%<span class="number">5</span>][y2]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        text+=key[x1][y2]+key[x2][y1]</span><br><span class="line">print(text)</span><br></pre></td></tr></table></figure>

<p>走一遍脚本解密可以得到：</p>
<p><img src="/p/wpFor-2020XCTF/image-20201230132557395.png"></p>
<p>YES MAYBE YOU CAN RUN AN ARM PE</p>
<p><del>No, I can’t :(</del></p>
<p>看起来能读的通，成功get flag。</p>
<p><strong>flag{YESMAYBEYOUCANRUNANARMPE}</strong></p>
<h2 id="crash"><a href="#crash" class="headerlink" title="crash"></a>crash</h2><p>用binwalk分析给的crash文件</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203135834833.png"></p>
<p>可以看到0x1000处有一个<code> ELF, 32-bit LSB executable</code>，先把这个可执行文件用dd分离出来。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203135922549.png"></p>
<p>其中if&#x3D;输入文件名（被分离的），of&#x3D;输出文件名（分离出来的），skip&#x3D;跳过的块（bs指定字节）数，count&#x3D;块长度，最后得到<code>file_0x1000</code>文件。</p>
<p>用ida打开如果出现这个warning，可以用 <a target="_blank" rel="noopener" href="https://github.com/Reinose/Useful-IDAScripts/tree/87596d4f2cb6fb56a3796e93619c9e64bb648301/PatchPLT">Reinose&#x2F;Useful-IDAScripts</a> 的方法解决。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203140139308.png"></p>
<p>老样子，通过<code>shift+F12</code>寻找字符串，通过交叉引用找到主函数。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203140825026.png"></p>
<p>先通过一些参数和常用逻辑的猜测给系统函数命名，方便后续分析。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203141153998.png"></p>
<p>然后就剩<code>sub_8048737()</code>和<code>sub_80487E7</code>这两个加密函数了。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203141241346.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210203141308404.png"></p>
<p>第一个就很简单啦，简单xor。</p>
<p>第二个点进<code>sub_80489E9()</code>可以看到md5经典常数，说明这一系列大概是个md5加密（当然md5的实现还是要看看的。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203143123837.png"></p>
<p>退回去，看到<code>0x804B060</code>这里，很像数组的始地址。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203143333398.png"></p>
<p>于是转到IDA View，按<code>G</code>跳到这个地址，可以看到一堆可见字符，按<code>A</code>转成字符串。</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203143531099.png"></p>
<p><img src="/p/wpFor-2020XCTF/image-20210203143612250.png"></p>
<p>再对回去逻辑就很明显了，就是依次取四个字符进行md5加密，然后跟这八个字符串比。</p>
<p>于是exp就可以写啦，爆破md5：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">dst=[<span class="string">&#x27;bf2b36d56f5757c13cad80494b385e78&#x27;</span>,<span class="string">&#x27;3fe9dbae5dc4408350500affa20074aa&#x27;</span>,<span class="string">&#x27;1fa6770eca6b57e47a042ffe52eca8ff&#x27;</span>,<span class="string">&#x27;1aad6b7da1122b4b5a53bf5a4d3b11b0&#x27;</span>,<span class="string">&#x27;e7b77d9e0ab19fc9ea98154f994fccc5&#x27;</span>,<span class="string">&#x27;75d9128cfeb61b8949664f6a067f6469&#x27;</span>,<span class="string">&#x27;d8b0a52c64d6075017b7346140550c46&#x27;</span>,<span class="string">&#x27;306529c7cdedfb06e27b39f7b2babf4d&#x27;</span>]</span><br><span class="line">res=[]</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">                l=[a^<span class="number">0x17</span>,b^<span class="number">0x17</span>,c^<span class="number">0x17</span>,d^<span class="number">0x17</span>]</span><br><span class="line">                tmp=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">chr</span>,l)))</span><br><span class="line">                tmpmd5=md5(tmp).hexdigest()</span><br><span class="line">                <span class="keyword">if</span> tmpmd5 <span class="keyword">in</span> dst:</span><br><span class="line">                    s=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">chr</span>,[a,b,c,d])))</span><br><span class="line">                    res.append((dst.index(tmpmd5),s))</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(res)==<span class="number">8</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">res.sort(key=(<span class="keyword">lambda</span> x:x[<span class="number">0</span>]))</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span>.join([x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> res])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>得到flag：</p>
<p><img src="/p/wpFor-2020XCTF/image-20210203145808703.png"></p>
<p><strong>flag{ux1cy1x4iltkahbc9nu1nk00d9akpp7w}</strong></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">c10udlnk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://c10udlnk.top/p/wpFor-2020XCTF/">https://c10udlnk.top/p/wpFor-2020XCTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://c10udlnk.top">c10udlnk's Blog</a> (https://c10udlnk.top)！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Reverse/">Reverse</a><a class="post-meta__tags" href="/tags/wp/">wp</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/p/wpFor-2021HWSTrial/"><i class="fa fa-chevron-left">  </i><span>【wp】HWS计划2021硬件安全冬令营线上选拔赛</span></a></div><div class="next-post pull-right"><a href="/p/wpFor-2020chamd5XMAS/"><span>【wp】2020ChaMd5圣诞题</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3fff94cdba288d81026d',
  clientSecret: 'e449b106b98b508de4e3ab3658f46444d26f420f',
  repo: 'c10udlnk.github.io',
  owner: 'c10udlnk',
  admin: 'c10udlnk',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/lijiang-tower.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2024 By c10udlnk</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text"><u><a target="_blank" rel="noopener" href="https://tover.xyz">密码学是二进制人的自我修养 =v=</a></u></div><div class="busuanzi"><script src="/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script src="/js/DigitalRain.js"></script><script src="/live2d-widget/autoload.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">想要搜什么呢~</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search...?"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></div><!-- hexo injector body_end start -->
    <div class="myspine-spine-widget"></div>
    <script src="/js/third-party/myspine/spine-widget.js"></script>
    <script src="/js/third-party/myspine/spine-skeleton-binary.js"></script>
    <script src="/js/third-party/myspine/myspine.js"></script>
    <link type="text/css" href="/css/_third-party/myspine.css"></link>
    <script>
        new MySpine({
            spineDir: "/spine_models/",
            models: [{"name":"sd_21miku_normal_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_band_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_idol_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_night_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_street_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"},{"name":"sd_21miku_wonder_r/","skin":"default","atlas":"sekai_atlas.atlas","skeleton":"sekai_atlas.skel"}],
            styles: {"widget":{"width":"200px","height":"200px"},"voiceText":{"color":"#e6e6e6"}},
            behaviors: {"start":{"animation":"w_emu_run01_f","voice":"","text":"Ohhhhh好耶"},"idle":{"maxMinutes":1,"animations":[{"name":"m_cool_idle01_f","loop":false},{"name":"m_cool_joy01_f","loop":false},{"name":"m_happy_idle01_f","loop":false},{"name":"m_happy_joy01_f","loop":false},{"name":"m_normal_idle01_f","loop":false},{"name":"m_normal_joy01_f","loop":false},{"name":"m_staff_idle01_f","loop":false},{"name":"n_general_wait_01_f","loop":false},{"name":"pose_default","loop":false},{"name":"u_vbsmen_battledore00_f","loop":false},{"name":"u_vbswomen_battledore00_f","loop":false},{"name":"w_adult_idle01_f","loop":false},{"name":"w_adult_joy01_f","loop":false},{"name":"w_cool_idle01_f","loop":false},{"name":"w_cool_joy01_f","loop":false},{"name":"w_cute_idle01_f","loop":false},{"name":"w_cute_joy01_f","loop":false},{"name":"w_happy_idle01_f","loop":false},{"name":"w_happy_joy01_f","loop":false},{"name":"w_normal_idle01_f","loop":false},{"name":"w_normal_joy01_f","loop":false},{"name":"w_pure_idle01_f","loop":false},{"name":"w_pure_joy01_f","loop":false},{"name":"w_staff_idle01_f","loop":false}],"voices":[{"voice":"","text":"不买立省百分百"}]},"interact":{"maxPlaySec":3,"animations":[{"name":"w_normal_joy01_b","loop":false},{"name":"m_cool_angry01_f","loop":false},{"name":"m_cool_doubt01_f","loop":false},{"name":"m_cool_laugh01_f","loop":false},{"name":"m_cool_listen01_f","loop":false},{"name":"m_cool_sad01_f","loop":false},{"name":"m_cool_surprise01_f","loop":false},{"name":"m_cool_talk01_f","loop":false},{"name":"m_happy_angry01_f","loop":false},{"name":"m_happy_doubt01_f","loop":false},{"name":"m_happy_laugh01_f","loop":false},{"name":"m_happy_listen01_f","loop":false},{"name":"m_happy_sad01_f","loop":false},{"name":"m_happy_surprise01_f","loop":false},{"name":"m_happy_talk01_f","loop":false},{"name":"m_normal_angry01_f","loop":false},{"name":"m_normal_doubt01_f","loop":false},{"name":"m_normal_laugh01_f","loop":false},{"name":"m_normal_listen01_f","loop":false},{"name":"m_normal_surprise01_f","loop":false},{"name":"m_normal_talk01_f","loop":false},{"name":"m_normal_walk01_b","loop":false},{"name":"m_normal_walk01_f","loop":false},{"name":"m_tsukasa_run01_f","loop":false},{"name":"n_general_walk_01_b","loop":false},{"name":"n_general_walk_01_f","loop":false},{"name":"u_liondancerobot_run_01_f","loop":false},{"name":"u_liondancerobot_run_02_f","loop":false},{"name":"u_vbsmen_battledore01_f","loop":false},{"name":"u_vbsmen_battledore02_f","loop":false},{"name":"u_vbsmen_battledore03_f","loop":false},{"name":"u_vbsmen_battledore04_f","loop":false},{"name":"u_vbswomen_battledore01_f","loop":false},{"name":"u_vbswomen_battledore02_f","loop":false},{"name":"u_vbswomen_battledore03_f","loop":false},{"name":"u_vbswomen_battledore04_f","loop":false},{"name":"w_adult_angry01_f","loop":false},{"name":"w_adult_doubt01_f","loop":false},{"name":"w_adult_laugh01_f","loop":false},{"name":"w_adult_listen01_f","loop":false},{"name":"w_adult_sad01_f","loop":false},{"name":"w_adult_surprise01_f","loop":false},{"name":"w_adult_talk01_f","loop":false},{"name":"w_cool_angry01_f","loop":false},{"name":"w_cool_doubt01_f","loop":false},{"name":"w_cool_laugh01_f","loop":false},{"name":"w_cool_listen01_f","loop":false},{"name":"w_cool_sad01_f","loop":false},{"name":"w_cool_surprise01_f","loop":false},{"name":"w_cool_talk01_f","loop":false},{"name":"w_cute_angry01_f","loop":false},{"name":"w_cute_angry02_f","loop":false},{"name":"w_cute_doubt01_f","loop":false},{"name":"w_cute_laugh01_f","loop":false},{"name":"w_cute_listen01_f","loop":false},{"name":"w_cute_sad01_f","loop":false},{"name":"w_cute_surprise01_f","loop":false},{"name":"w_cute_talk01_f","loop":false},{"name":"w_emu_run02_f","loop":false},{"name":"w_happy_angry01_f","loop":false},{"name":"w_happy_angry02_f","loop":false},{"name":"w_happy_doubt01_f","loop":false},{"name":"w_happy_doubt02_f","loop":false},{"name":"w_happy_laugh01_f","loop":false},{"name":"w_happy_listen01_f","loop":false},{"name":"w_happy_sad01_f","loop":false},{"name":"w_happy_surprise01_f","loop":false},{"name":"w_happy_talk01_f","loop":false},{"name":"w_normal_laugh01_f","loop":false},{"name":"w_normal_listen01_f","loop":false},{"name":"w_normal_talk01_f","loop":false},{"name":"w_normal_walk01_b","loop":false},{"name":"w_normal_walk01_f","loop":false},{"name":"w_pure_angry01_f","loop":false},{"name":"w_pure_doubt01_f","loop":false},{"name":"w_pure_laugh01_f","loop":false},{"name":"w_pure_listen01_f","loop":false},{"name":"w_pure_sad01_f","loop":false},{"name":"w_pure_surprise01_f","loop":false},{"name":"w_pure_talk01_f","loop":false},{"name":"z_mesh_templete","loop":false},{"name":"z_test_F_negi01","loop":false}],"voices":[{"voice":"","text":"既见未来，为何不buy"}]}}
        });
    </script>
    <!-- hexo injector body_end end --></body></html>